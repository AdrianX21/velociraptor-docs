<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.85.0"><meta name=description content><link rel=icon href=/images/favicon.png type=image/png><title>Self-Signed SSL :: Velociraptor - Digging deeper!</title><link href=/css/nucleus.css?1626019973 rel=stylesheet><link href=/css/fontawesome-all.min.css?1626019973 rel=stylesheet><link href=/css/featherlight.min.css?1626019973 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1626019973 rel=stylesheet><link href=/css/auto-complete.css?1626019973 rel=stylesheet><link href=/css/theme.css?1626019973 rel=stylesheet><link href=/css/tabs.css?1626019973 rel=stylesheet><link href=/css/hugo-theme.css?1626019973 rel=stylesheet><link href=/css/theme-mine.css?1626019973 rel=stylesheet><link href=/css/atom-one-light.css?1626019973 rel=stylesheet><link href=/css/dark.css?1626019973 rel=stylesheet><link href=/css/syntax.css?1626019973 rel=stylesheet><link href=/css/light.css?1626019973 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1626019973 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1626019973></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style><script></script></head><body data-url=/docs/overview/deployment/self-signed/><nav id=sidebar><div id=header-wrapper><div id=header><script>function darkmode(){$("body").addClass("dark").removeClass("light"),document.cookie="theme=darkmode;path=/"}function lightmode(){$("body").removeClass("dark").addClass("light"),document.cookie="theme=lightmode;path=/"}const regex=new RegExp('theme=darkmode');regex.test(document.cookie)?darkmode():lightmode()</script><div class="btn btn-default ThemeSelector darkmode" onclick=darkmode()><i class="fas fa-moon"></i></div><div class="btn btn-default ThemeSelector lightmode" onclick=lightmode()><i class="fas fa-sun"></i></div><a href=https://docs.velociraptor.app/><img src=https://docs.velociraptor.app//images/logo.svg></a></div></div><div class=highlightable><ul class=topics><li data-nav-id=https://docs.velociraptor.app/docs/ class="dd-item parent haschildren"><div><i class="fa fa-angle-down fa-sm category-icon"></i>
<a href=/docs/><i class="fas fa-book-reader"></i>Documentation</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/ class="dd-item parent haschildren"><div><i class="fa fa-angle-down fa-sm category-icon"></i>
<a href=/docs/overview/>Velociraptor Overview</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/history/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/history/>History</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/overview/deployment/ class="dd-item parent haschildren"><div><i class="fa fa-angle-down fa-sm category-icon"></i>
<a href=/docs/overview/deployment/>Deployment</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/overview/deployment/self-signed/ class="dd-item parent active"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/deployment/self-signed/>Self-Signed SSL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/overview/deployment/cloud/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/deployment/cloud/>Cloud Deployment</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/overview/deployment/clients/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/deployment/clients/>Deploying Clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/overview/deployment/rbac/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/deployment/rbac/>Users and Roles</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/overview/deployment/resources/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/deployment/resources/>Performance</a></div></li></ul></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/gui/>The Admin GUI</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/gui/clients/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/clients/>Inspecting clients</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/vfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/vfs/>The VFS</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/artifacts/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/artifacts/>Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/gui/hunting/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/hunting/>Hunting</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/vql/>VQL Fundamentals</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/vql/notebooks/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/notebooks/>Notebooks</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/artifacts/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/artifacts/>Artifacts</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/vql/events/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/events/>Event Queries</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/>Forensic Analysis</a></div><ul><li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/>Searching Filenames</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/searching/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/searching/>Searching Content</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/ntfs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/ntfs/>NTFS Analysis</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/evidence_of_execution/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/evidence_of_execution/>Evidence Of Execution</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/event_logs/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/event_logs/>Event Logs</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/forensic/volatile/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/volatile/>Volatile machine state</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/offline_triage/>Triage and acquisition</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/extending_vql/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/extending_vql/>Extending VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/server_automation/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/>Server Automation</a></div></li><li data-nav-id=https://docs.velociraptor.app/docs/api/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/api/>The API</a></div></li></ul></li><hr><li data-nav-id=https://docs.velociraptor.app/vql_reference/ class="dd-item haschildren"><div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/vql_reference/><i class="fas fa-book"></i>VQL Reference</a></div><ul><li data-nav-id=https://docs.velociraptor.app/vql_reference/basic/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/basic/>Basic VQL</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/windows/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/windows/>Windows Specific</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/parsers/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/parsers/>Parsers</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/server/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/server/>Server Side</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/plugin/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/plugin/>Client Side</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/event/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/event/>Event Plugins</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/experimental/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/experimental/>Experimental</a></div></li><li data-nav-id=https://docs.velociraptor.app/vql_reference/misc/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/misc/>Misc</a></div></li></ul></li><li data-nav-id=https://docs.velociraptor.app/training/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/training/><i class="fas fa-graduation-cap"></i>Velociraptor Training</a></div></li><li data-nav-id=https://docs.velociraptor.app/blog/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/blog/><i class="fas fa-newspaper"></i>Velociraptor Blog</a></div></li><li data-nav-id=https://docs.velociraptor.app/exchange/ class="dd-item haschildren"><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/exchange/><i class="fas fa-code"></i>Artifact Exchange</a></div></li><li data-nav-id=https://docs.velociraptor.app/search/ class=dd-item><div><i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/search/><i class="fas fa-search"></i>Search</a></div></li></ul><hr><section id=shortcuts><h3></h3><ul><li><a class=padding href=https://github.com/Velocidex/velociraptor><i class="fab fa-github"></i>Github</a></li><li><a class=padding href=https://docs.velociraptor.app/discord/><i class="fab fa-discord"></i>Discord</a></li><li><a class=padding href=mailto:velociraptor-discuss@googlegroups.com><i class="fas fa-envelope"></i>Mailing List</a></li></ul></section><section id=footer><div class=footer-copyright>Brough to you by
<img src=/images/Rapid7_logo.svg class=rapid7><br><i class="fas fa-copyright"></i> 2021</div></section></div></nav><script>$("#sidebar i.fa-angle-right").each(function(){$(this).parent().parent().find("ul").hide()})</script><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=top-github-link><a class=github-link title="Edit this page" href=https://github.com/scudette/velociraptor-docs/edit/master/content/docs/overview/deployment/self-signed/_index.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>Self-Signed SSL</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#self-signed-certificates>Self-Signed Certificates</a></li><li><a href=#generate-the-configuration-file>Generate the configuration file</a><ul><li><a href=#option-a-use-the-configuration-wizard>Option A: Use the configuration wizard</a></li><li><a href=#option-b-automate-the-config-file-generation>Option B: Automate the config file generation</a></li></ul></li><li><a href=#create-the-server-package>Create the server package</a></li><li><a href=#install-a-new-server>Install a new server</a></li><li><a href=#install-the-package>Install the package</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Self-Signed SSL</h1><p>Velociraptor deployments are secured using a self-signed Certificate Authority (CA) that is generated during the initial configuration generation step. The client’s configuration contains the signed CA, which is used to verify all certificates needed during communications.</p><p>In <code>self-signed SSL</code> mode, Velociraptor issues its own server
certificate using its internal CA. This means the Admin GUI and front end
also use a self-signed server certificate.</p><p><strong>When to use this method</strong>
This type of deployment is most appropriate for on-premises scenarios
where internet access is not available or egress is blocked.</p><h2 id=self-signed-certificates>Self-Signed Certificates</h2><p>Self-signed SSL certificates trigger SSL warnings in all web
browsers. When accessing the Admin GUI you will receive a
certificate warning about the possibility of a MITM attack.</p><p>As a precaution, Velociraptor only exports the GUI port
on the loopback interface. You may change the <code>GUI.bind_address</code>
setting to &ldquo;0.0.0.0&rdquo; to receive external connections on this
port, but this is not recommended. Instead, you should use SSH
tunneling to connect to the local loopback interface.</p><p>Velociraptor doesn&rsquo;t support other self-signed SSL certificates, and we don&rsquo;t recommend attempting to create and upload your own internal self-signed certificate to Velociraptor.</p><div class="mynotices info"><div><p>By default, Velociraptor will not connect through an SSL intercepting proxy. While not recommended, it is possible to add allowlist rules that enable Velociraptor to connect through an SSL intercepting proxy. If you do so, you will see a certificate warning about the possibility of a MITM attack when accessing the Admin GUI.</p></div></div><h2 id=generate-the-configuration-file>Generate the configuration file</h2><p>You can generate the file using either a configuration wizard that guides you through the process, or automate this step using a script we provide.</p><h3 id=option-a-use-the-configuration-wizard>Option A: Use the configuration wizard</h3><p>Run the <code>config generate</code> command to invoke the configuration wizard.</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>velociraptor config generate -i
</code></pre></div><p>The configuration wizard appears.</p><p><img src="self-signed-generation.png?classes=shadow" alt="Generating Self Signed Deployment"></p><p>The configuration wizard includes a set of questions to guide you through the first step of the deployment process.</p><ul><li><strong>What OS will the server be deployed on?</strong> This choice will affect the
defaults for various options. Velociraptor is typically
deployed on a Linux machine (but the configuration can be generated on
Windows).</li><li><strong>Path to the datastore directory:</strong> Velociraptor uses flat files for
all storage. This path is where Velociraptor will write the
files. You should mount any network filesystems or storage devices
on this path.</li><li><strong>The public DNS name of the Frontend:</strong> The clients will connect to the
server using this DNS name so it should be publically accessible. If
you are using self-signed SSL you may specify an IP address here,
but this not recommended because it is less flexible. If the
server&rsquo;s IP address changes it will be impossible to contact the
clients.</li><li><strong>The frontend port to listen on:</strong> The front end receives client
connections. You should allow inbound access to this port from
anywhere.</li><li><strong>The port for the Admin GUI to listen on:</strong> The Admin GUI receives browser
connections. As discussed above, in self-signed mode the Admin GUI will
only bind to the local host.</li><li><strong>GUI Username or email address to authorize:</strong> The initial set of
administrator accounts can be stored in the configuration file. When
Velociraptor starts, it automatically adds these accounts as
administrators. When using self-signed SSL mode, the only
authentication method available is <code>Basic Authentication</code>.
Velociraptor stores the username and hashed passwords in the
datastore.</li></ul><h3 id=option-b-automate-the-config-file-generation>Option B: Automate the config file generation</h3><p>Velociraptor supports a JSON merge, which allows you to automate the generation of the configuration file.</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>velociraptor config generate --merge
    <span class=s1>&#39;{&#34;autocert_domain&#34;: &#34;domain.com&#34;, &#34;autocert_cert_cache&#34;: &#34;/foo/bar&#34;}&#39;</span>
</code></pre></div><p>The service adds a new Velociraptor user to run under.
You can now access the Velociraptor server using your browser.</p><p>The first time you navigate to the SSL URL the server will obtain a
certificate from Let&rsquo;s Encrypt. There will be a small pause as this
happens.</p><p>You will be redirected to Google for authentication - Velociraptor
does not handle any credentials in this configuration. Google will
determine if the user authenticated properly and display
the user’s email address and avatar.</p><h2 id=create-the-server-package>Create the server package</h2><p>You&rsquo;ll need to run a command that instructs Velociraptor to create a server Debian package using the linux binary specified. The
package will contain the Velociraptor executable, the server
configuration file and relevant startup scripts.</p><p>Use the following command:</p><div class=highlight><pre class=chroma><code class=language-sh data-lang=sh>velociraptor.exe --config server.config.yaml debian server --binary velociraptor-v0.6.0-linux-amd64
</code></pre></div><div class="mynotices warning"><div><p>The Debian package contains the server configuration file, which contains all required key materials. Make sure the debian file is well protected since a compromise of the file will leak private key material enabling a MITM attack against Velociraptor.</p></div></div><h2 id=install-a-new-server>Install a new server</h2><p>Push the debian package to the server using Secure Copy Protocol (SCP):
<code>scp velociraptor_server*.deb mike@123.45.67.89:/tmp/</code></p><h2 id=install-the-package>Install the package</h2><p>Run the following command to install the server package:
<code>sudo dpkg -i velociraptor_server*.deb</code></p><footer class=footline></footer></div></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1626019973></script><script src=/js/perfect-scrollbar.min.js?1626019973></script><script src=/js/perfect-scrollbar.jquery.min.js?1626019973></script><script src=/js/jquery.sticky.js?1626019973></script><script src=/js/featherlight.min.js?1626019973></script><script src=/js/highlight.pack.js?1626019973></script><script>hljs.initHighlightingOnLoad()</script><script src=/js/modernizr.custom-3.6.0.js?1626019973></script><script src=/js/learn.js?1626019973></script><script src=/js/hugo-learn.js?1626019973></script></body></html>