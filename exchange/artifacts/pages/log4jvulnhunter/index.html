<!doctype html><html lang=en class="js csstransforms3d">
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=generator content="Hugo 0.91.2">
<meta name=description content>
<link rel=icon href=/images/favicon.png type=image/png>
<title>Generic.Detection.Log4jVulnHunter :: Velociraptor - Digging deeper!</title>
<link href=/css/nucleus.css?1640931064 rel=stylesheet>
<link href=/css/fontawesome-all.min.css?1640931064 rel=stylesheet>
<link href=/css/featherlight.min.css?1640931064 rel=stylesheet>
<link href=/css/perfect-scrollbar.min.css?1640931064 rel=stylesheet>
<link href=/css/auto-complete.css?1640931064 rel=stylesheet>
<link href=/css/theme.css?1640931064 rel=stylesheet>
<link href=/css/tabs.css?1640931064 rel=stylesheet>
<link href=/css/hugo-theme.css?1640931064 rel=stylesheet>
<link href=/css/theme-mine.css?1640931064 rel=stylesheet>
<link href=/css/dark.css?1640931064 rel=stylesheet><link href=/css/syntax.css?1640931064 rel=stylesheet><link href=/css/light.css?1640931064 rel=stylesheet><link href=/css/hljs.css?1640931064 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1640931064 rel=stylesheet>
<script src=/js/jquery-3.3.1.min.js?1640931064></script>
<style>:root #header+#content>#left>#rlblock_left{display:none!important}</style>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QYH72LMYCS"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-QYH72LMYCS',{anonymize_ip:!1})}</script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','G-QYH72LMYCS','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
<script></script>
</head>
<body data-url=/exchange/artifacts/pages/log4jvulnhunter/>
<nav id=sidebar><div id=header-wrapper>
<div id=header>
<script>function darkmode(){$("body").addClass("dark").removeClass("light"),document.cookie="theme=darkmode;path=/"}function lightmode(){$("body").removeClass("dark").addClass("light"),document.cookie="theme=lightmode;path=/"}const regex=new RegExp('theme=darkmode');regex.test(document.cookie)?darkmode():lightmode()</script>
<div class="btn btn-default ThemeSelector darkmode" onclick=darkmode()>
<i class="fas fa-moon"></i>
</div>
<div class="btn btn-default ThemeSelector lightmode" onclick=lightmode()>
<i class="fas fa-sun"></i>
</div>
<a href=https://docs.velociraptor.app/>
<img src=https://docs.velociraptor.app//images/logo.svg>
</a>
</div>
</div>
<div class=highlightable>
<ul class=topics>
<li data-nav-id=https://docs.velociraptor.app/announcements/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/><i class="fas fa-bullhorn"></i>Announcements</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/announcements/2021-artifact-contest/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/2021-artifact-contest/>2021 Contest</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/><i class="fas fa-book-reader"></i>Documentation</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/overview/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/overview/>Velociraptor Overview</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/overview/history/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/history/>History</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/overview/support/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/support/>Support Policy</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/>Deployment</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/self-signed/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/self-signed/>Self-Signed SSL</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/>Cloud Deployment</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/clients/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/clients/>Deploying Clients</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/rbac/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/rbac/>Users and Roles</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/resources/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/resources/>Performance</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/troubleshooting/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/troubleshooting/>Troubleshooting</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/gui/>The Admin GUI</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/clients/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/clients/>Inspecting clients</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/vfs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/vfs/>The VFS</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/artifacts/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/artifacts/>Artifacts</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/hunting/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/hunting/>Hunting</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/vql/>VQL Fundamentals</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/notebooks/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/notebooks/>Notebooks</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/artifacts/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/artifacts/>Artifacts</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/events/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/events/>Event Queries</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/>Forensic Analysis</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/>Searching Filenames</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/searching/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/searching/>Searching Content</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/ntfs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/ntfs/>NTFS Analysis</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/evidence_of_execution/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/evidence_of_execution/>Evidence Of Execution</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/event_logs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/event_logs/>Event Logs</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/volatile/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/volatile/>Volatile State</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/offline_triage/>Triage and acquisition</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/client_monitoring/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/client_monitoring/>Client Monitoring</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/extending_vql/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/extending_vql/>Extending VQL</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/server_automation/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/server_automation/>Server Automation</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_api/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_api/>Server API</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_monitoring/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_monitoring/>Server Monitoring</a>
</div>
</li>
</ul>
</li>
</ul>
</li><hr>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/vql_reference/><i class="fas fa-book"></i>VQL Reference</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/basic/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/basic/>Basic VQL</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/linux/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/linux/>Linux Specific</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/windows/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/windows/>Windows Specific</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/parsers/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/parsers/>Parsers</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/server/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/server/>Server Side</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/plugin/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/plugin/>Client Side</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/event/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/event/>Event Plugins</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/experimental/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/experimental/>Experimental</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/misc/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/misc/>Misc</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/training/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/training/><i class="fas fa-graduation-cap"></i>Training</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/blog/ class="dd-item haschildren">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/blog/><i class="fas fa-newspaper"></i>Blog</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/presentations/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/presentations/><i class="fas fa-chalkboard-teacher"></i>Presentations</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/presentations/2021_dfrws_us/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2021_dfrws_us/>DFRWS US 2021 Workshop</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/exchange/ class="dd-item parent haschildren">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/exchange/><i class="fas fa-code"></i>Artifact Exchange</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/search/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/search/><i class="fas fa-search"></i>Search</a>
</div>
</li>
</ul>
<hr>
<section id=shortcuts>
<h3></h3>
<ul>
<li>
<a class=padding href=https://github.com/Velocidex/velociraptor><i class="fab fa-github"></i>Github</a>
</li>
<li>
<a class=padding href=https://docs.velociraptor.app/discord/><i class="fab fa-discord"></i>Discord</a>
</li>
<li>
<a class=padding href=mailto:velociraptor-discuss@googlegroups.com><i class="fas fa-envelope"></i>Mailing List</a>
</li>
</ul>
</section>
<section id=footer>
<div class=footer-copyright>Brought to you by
<img src=/images/Rapid7_logo.svg class=rapid7>
<br> <i class="fas fa-copyright"></i> 2021
</div>
</section>
</div>
</nav>
<script>$("#sidebar i.fa-angle-right").each(function(){$(this).parent().parent().find("ul").hide()})</script>
<section id=body>
<div id=overlay></div>
<div class="padding highlightable">
<div>
<div id=top-bar>
<div id=top-github-link>
<a class=github-link title="Edit this page" href=https://github.com/Velocidex/velociraptor-docs/edit/master/content/exchange/artifacts/Log4jVulnHunter.yaml target=blank>
<i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span>
</a>
</div>
<div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb>
<span id=sidebar-toggle-span>
<a href=# id=sidebar-toggle data-sidebar-toggle>
<i class="fas fa-bars"></i>
</a>
</span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>
Generic.Detection.Log4jVulnHunter
</span>
</div>
<div class=progress>
<div class=wrapper>
<nav id=TableOfContents></nav>
</div>
</div>
</div>
</div>
<div id=head-tags>
</div>
<div id=body-inner>
<h1>
Generic.Detection.Log4jVulnHunter
</h1>
<p>This artifact searches for Vulnerable log4j libraries.</p>
<p>The artifact:</p>
<ul>
<li>firstly searches for jar, war and ear files</li>
<li>then recursively checks content by name then hash for vulnerable versions.</li>
<li>reports hit details.</li>
</ul>
<p>The artifact is optimised to recursively search through embedded jar,war and
ear files by extracting any discovered jar containers to a tempfile on disk.<br>
Select UploadHits to upload Discovered file for further analysis.<br>
It is recommended to increase default artifact timeout for large servers or
target glob.</p>
<p>Some examples of path glob may include:</p>
<ul>
<li>Specific container: <code>/path/here/log4j-core-2.0-alpha2.jar</code></li>
<li>Wildcards: <code>/var/www/*.{jar,war,ear}</code></li>
<li>More wildcards: <code>/var/www/**/*.jar</code></li>
<li>Windows: <code>C:/**/*.jar</code></li>
</ul>
<p>NOTE: this artifact runs the glob plugin with the nosymlink switch turned on.
This will NOT follow any symlinks and may cause unexpected results if
unknowingly targeting a folder with symlinks.</p>
<pre><code class=language-yaml>name: Generic.Detection.Log4jVulnHunter
author: &quot;Matt Green - @mgreen27&quot;
description: |
    This artifact searches for Vulnerable log4j libraries.
    
    The artifact:  
    
    * firstly searches for jar, war and ear files
    * then recursively checks content by name then hash for vulnerable versions.
    * reports hit details.
    
    The artifact is optimised to recursively search through embedded jar,war and 
    ear files by extracting any discovered jar containers to a tempfile on disk.   
    Select UploadHits to upload Discovered file for further analysis.  
    It is recommended to increase default artifact timeout for large servers or 
    target glob.

    Some examples of path glob may include:
    
    * Specific container: `/path/here/log4j-core-2.0-alpha2.jar`
    * Wildcards: `/var/www/*.{jar,war,ear}`
    * More wildcards: `/var/www/**/*.jar`
    * Windows: `C:/**/*.jar`
    
    NOTE: this artifact runs the glob plugin with the nosymlink switch turned on. 
    This will NOT follow any symlinks and may cause unexpected results if 
    unknowingly targeting a folder with symlinks.
    
reference:
  - https://www.lunasec.io/docs/blog/log4j-zero-day/
  - https://github.com/lunasec-io/lunasec/blob/master/tools/log4shell/findings.json
  - https://github.com/mubix/CVE-2021-44228-Log4Shell-Hashes
  
parameters:
  - name: TargetGlob
    default: &quot;**/*.{jar,war,ear}&quot;
  - name: MaxRecursions
    description: Number of recursions to allow checking inside archives. Default is 10 layers.
    default: 10
    type: int
  - name: UploadHits
    description: Select to upload hits to server.
    type: bool
  - name: IocLookupTable
    type: csv
    default: |
        JarName,FilePath,SHA256,Version,Cve,Severity
        log4j-1.2.15.jar,org/apache/log4j/net/SocketNode.class,7b996623c05f1a25a57fb5b43c519c2ec02ec2e647c2b97b3407965af928c9a4,1.2.15,CVE-2019-17571,&quot; 9.8&quot;
        log4j-1.2.16.jar,org/apache/log4j/net/SocketNode.class,688a3dadfb1c0a08fb2a2885a356200eb74e7f0f26a197d358d74f2faf6e8f46,1.2.16,CVE-2019-17571,&quot; 9.8&quot;
        log4j-1.2.17.jar,org/apache/log4j/net/SocketNode.class,8ef0ebdfbf28ec14b2267e6004a8eea947b4411d3c30d228a7b48fae36431d74,1.2.17,CVE-2019-17571,&quot; 9.8&quot;
        log4j-core-2.0-beta9.jar,org/apache/logging/log4j/core/lookup/JndiLookup.class,39a495034d37c7934b64a9aa686ea06b61df21aa222044cc50a47d6903ba1ca8,&quot;2.0.0-beta9, 2.0.0-rc1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-osgi-reduced-2.0-beta9.jar,org/apache/logging/log4j/core/lookup/JndiLookup.class,39a495034d37c7934b64a9aa686ea06b61df21aa222044cc50a47d6903ba1ca8,&quot;2.0.0-beta9, 2.0.0-rc1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.0.jar,org/apache/logging/log4j/core/lookup/JndiLookup.class,fd6c63c11f7a6b52eff04be1de3477c9ddbbc925022f7216320e6db93f1b7d29,2.0.0,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.0-rc1.jar,org/apache/logging/log4j/core/lookup/JndiLookup.class,39a495034d37c7934b64a9aa686ea06b61df21aa222044cc50a47d6903ba1ca8,&quot;2.0.0-beta9, 2.0.0-rc1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-osgi-reduced-2.0-rc1.jar,org/apache/logging/log4j/core/lookup/JndiLookup.class,39a495034d37c7934b64a9aa686ea06b61df21aa222044cc50a47d6903ba1ca8,&quot;2.0.0-beta9, 2.0.0-rc1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.0-rc2.jar,org/apache/logging/log4j/core/lookup/JndiLookup.class,a03e538ed25eff6c4fe48aabc5514e5ee687542f29f2206256840e74ed59bcd2,2.0.0-rc2,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.0.1.jar,org/apache/logging/log4j/core/lookup/JndiLookup.class,964fa0bf8c045097247fa0c973e0c167df08720409fd9e44546e0ceda3925f3e,2.0.1,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.0.2.jar,org/apache/logging/log4j/core/lookup/JndiLookup.class,9626798cce6abd0f2ffef89f1a3d0092a60d34a837a02bbe571dbe00236a2c8c,2.0.2,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.1.jar,org/apache/logging/log4j/core/net/JndiManager.class,ae950f9435c0ef3373d4030e7eff175ee11044e584b7f205b7a9804bbe795f9c,&quot;2.1.0, 2.2.0, 2.3.0&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.10.0.jar,org/apache/logging/log4j/core/net/JndiManager.class,293d7e83d4197f0496855f40a7745cfcdd10026dc057dfc1816de57295be88a6,&quot;2.10.0, 2.11.0, 2.11.1, 2.11.2, 2.9.0, 2.9.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.11.0.jar,org/apache/logging/log4j/core/net/JndiManager.class,293d7e83d4197f0496855f40a7745cfcdd10026dc057dfc1816de57295be88a6,&quot;2.10.0, 2.11.0, 2.11.1, 2.11.2, 2.9.0, 2.9.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.11.1.jar,org/apache/logging/log4j/core/net/JndiManager.class,293d7e83d4197f0496855f40a7745cfcdd10026dc057dfc1816de57295be88a6,&quot;2.10.0, 2.11.0, 2.11.1, 2.11.2, 2.9.0, 2.9.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.11.2.jar,org/apache/logging/log4j/core/net/JndiManager.class,293d7e83d4197f0496855f40a7745cfcdd10026dc057dfc1816de57295be88a6,&quot;2.10.0, 2.11.0, 2.11.1, 2.11.2, 2.9.0, 2.9.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.12.0.jar,org/apache/logging/log4j/core/net/JndiManager.class,1fa92c00fa0b305b6bbe6e2ee4b012b588a906a20a05e135cbe64c9d77d676de,&quot;2.12.0, 2.12.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.12.1.jar,org/apache/logging/log4j/core/net/JndiManager.class,1fa92c00fa0b305b6bbe6e2ee4b012b588a906a20a05e135cbe64c9d77d676de,&quot;2.12.0, 2.12.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.12.2.jar,org/apache/logging/log4j/core/net/JndiManager.class,b1960d63a3946f9e16e1920624f37c152b58b98932ed04df99ed5d9486732afb,2.12.2,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.13.0.jar,org/apache/logging/log4j/core/net/JndiManager.class,c3e95da6542945c1a096b308bf65bbd7fcb96e3d201e5a2257d85d4dedc6a078,&quot;2.13.0, 2.13.1, 2.13.2, 2.13.3&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.13.1.jar,org/apache/logging/log4j/core/net/JndiManager.class,c3e95da6542945c1a096b308bf65bbd7fcb96e3d201e5a2257d85d4dedc6a078,&quot;2.13.0, 2.13.1, 2.13.2, 2.13.3&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.13.2.jar,org/apache/logging/log4j/core/net/JndiManager.class,c3e95da6542945c1a096b308bf65bbd7fcb96e3d201e5a2257d85d4dedc6a078,&quot;2.13.0, 2.13.1, 2.13.2, 2.13.3&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.13.3.jar,org/apache/logging/log4j/core/net/JndiManager.class,c3e95da6542945c1a096b308bf65bbd7fcb96e3d201e5a2257d85d4dedc6a078,&quot;2.13.0, 2.13.1, 2.13.2, 2.13.3&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.14.0.jar,org/apache/logging/log4j/core/net/JndiManager.class,77323460255818f4cbfe180141d6001bfb575b429e00a07cbceabd59adf334d6,&quot;2.14.0, 2.14.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.14.1.jar,org/apache/logging/log4j/core/net/JndiManager.class,77323460255818f4cbfe180141d6001bfb575b429e00a07cbceabd59adf334d6,&quot;2.14.0, 2.14.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.15.0.jar,org/apache/logging/log4j/core/net/JndiManager.class,db07ef1ea174e000b379732681bd835cfede648a7971bf4e9a0d31981582d69e,2.15.0,CVE-2021-45046,&quot; 3.7&quot;
        log4j-core-2.2.jar,org/apache/logging/log4j/core/net/JndiManager.class,ae950f9435c0ef3373d4030e7eff175ee11044e584b7f205b7a9804bbe795f9c,&quot;2.1.0, 2.2.0, 2.3.0&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.3.jar,org/apache/logging/log4j/core/net/JndiManager.class,ae950f9435c0ef3373d4030e7eff175ee11044e584b7f205b7a9804bbe795f9c,&quot;2.1.0, 2.2.0, 2.3.0&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.4.jar,org/apache/logging/log4j/core/net/JndiManager.class,3bff6b3011112c0b5139a5c3aa5e698ab1531a2f130e86f9e4262dd6018916d7,&quot;2.4.0, 2.4.1, 2.5.0&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.4.1.jar,org/apache/logging/log4j/core/net/JndiManager.class,3bff6b3011112c0b5139a5c3aa5e698ab1531a2f130e86f9e4262dd6018916d7,&quot;2.4.0, 2.4.1, 2.5.0&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.5.jar,org/apache/logging/log4j/core/net/JndiManager.class,3bff6b3011112c0b5139a5c3aa5e698ab1531a2f130e86f9e4262dd6018916d7,&quot;2.4.0, 2.4.1, 2.5.0&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.6.jar,org/apache/logging/log4j/core/net/JndiManager.class,6540d5695ddac8b0a343c2e91d58316cfdbfdc5b99c6f3f91bc381bc6f748246,&quot;2.6.0, 2.6.1, 2.6.2&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.6.1.jar,org/apache/logging/log4j/core/net/JndiManager.class,6540d5695ddac8b0a343c2e91d58316cfdbfdc5b99c6f3f91bc381bc6f748246,&quot;2.6.0, 2.6.1, 2.6.2&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.6.2.jar,org/apache/logging/log4j/core/net/JndiManager.class,6540d5695ddac8b0a343c2e91d58316cfdbfdc5b99c6f3f91bc381bc6f748246,&quot;2.6.0, 2.6.1, 2.6.2&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.7.jar,org/apache/logging/log4j/core/net/JndiManager.class,1584b839cfceb33a372bb9e6f704dcea9701fa810a9ba1ad3961615a5b998c32,&quot;2.7.0, 2.8.0, 2.8.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.8.jar,org/apache/logging/log4j/core/net/JndiManager.class,1584b839cfceb33a372bb9e6f704dcea9701fa810a9ba1ad3961615a5b998c32,&quot;2.7.0, 2.8.0, 2.8.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.8.1.jar,org/apache/logging/log4j/core/net/JndiManager.class,1584b839cfceb33a372bb9e6f704dcea9701fa810a9ba1ad3961615a5b998c32,&quot;2.7.0, 2.8.0, 2.8.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.8.2.jar,org/apache/logging/log4j/core/net/JndiManager.class,764b06686dbe06e3d5f6d15891250ab04073a0d1c357d114b7365c70fa8a7407,2.8.2,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.9.0.jar,org/apache/logging/log4j/core/net/JndiManager.class,293d7e83d4197f0496855f40a7745cfcdd10026dc057dfc1816de57295be88a6,&quot;2.10.0, 2.11.0, 2.11.1, 2.11.2, 2.9.0, 2.9.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.9.1.jar,org/apache/logging/log4j/core/net/JndiManager.class,293d7e83d4197f0496855f40a7745cfcdd10026dc057dfc1816de57295be88a6,&quot;2.10.0, 2.11.0, 2.11.1, 2.11.2, 2.9.0, 2.9.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-1.2.1.jar,org/apache/log4j/net/SocketNode.class,6adb3617902180bdf9cbcfc08b5a11f3fac2b44ef1828131296ac41397435e3d,&quot;1.2.1, 1.2.2, 1.2.3, 1.2.4&quot;,CVE-2019-17571,&quot; 9.8&quot;
        log4j-1.2.2.jar,org/apache/log4j/net/SocketNode.class,6adb3617902180bdf9cbcfc08b5a11f3fac2b44ef1828131296ac41397435e3d,&quot;1.2.1, 1.2.2, 1.2.3, 1.2.4&quot;,CVE-2019-17571,&quot; 9.8&quot;
        log4j-1.2.3.jar,org/apache/log4j/net/SocketNode.class,6adb3617902180bdf9cbcfc08b5a11f3fac2b44ef1828131296ac41397435e3d,&quot;1.2.1, 1.2.2, 1.2.3, 1.2.4&quot;,CVE-2019-17571,&quot; 9.8&quot;
        log4j-1.2.4.jar,org/apache/log4j/net/SocketNode.class,6adb3617902180bdf9cbcfc08b5a11f3fac2b44ef1828131296ac41397435e3d,&quot;1.2.1, 1.2.2, 1.2.3, 1.2.4&quot;,CVE-2019-17571,&quot; 9.8&quot;
        log4j-1.2.5.jar,org/apache/log4j/net/SocketNode.class,ed5d53deb29f737808521dd6284c2d7a873a59140e702295a80bd0f26988f53a,1.2.5,CVE-2019-17571,&quot; 9.8&quot;
        log4j-1.2.6.jar,org/apache/log4j/net/SocketNode.class,3ef93e9cb937295175b75182e42ba9a0aa94f9f8e295236c9eef914348efeef0,&quot;1.2.6, 1.2.7, 1.2.9&quot;,CVE-2019-17571,&quot; 9.8&quot;
        log4j-1.2.7.jar,org/apache/log4j/net/SocketNode.class,3ef93e9cb937295175b75182e42ba9a0aa94f9f8e295236c9eef914348efeef0,&quot;1.2.6, 1.2.7, 1.2.9&quot;,CVE-2019-17571,&quot; 9.8&quot;
        log4j-1.2.8.jar,org/apache/log4j/net/SocketNode.class,bee4a5a70843a981e47207b476f1e705c21fc90cb70e95c3b40d04a2191f33e9,1.2.8,CVE-2019-17571,&quot; 9.8&quot;
        log4j-1.2.11.jar,org/apache/log4j/net/SocketNode.class,d778227b779f8f3a2850987e3cfe6020ca26c299037fdfa7e0ac8f81385963e6,1.2.11,CVE-2019-17571,&quot; 9.8&quot;
        log4j-1.2.12.jar,org/apache/log4j/net/SocketNode.class,f3b815a2b3c74851ff1b94e414c36f576fbcdf52b82b805b2e18322b3f5fc27c,1.2.12,CVE-2019-17571,&quot; 9.8&quot;
        log4j-1.2.13.jar,org/apache/log4j/net/SocketNode.class,fbda3cfc5853ab4744b853398f2b3580505f5a7d67bfb200716ef6ae5be3c8b7,&quot;1.2.13, 1.2.14&quot;,CVE-2019-17571,&quot; 9.8&quot;
        log4j-1.2.14.jar,org/apache/log4j/net/SocketNode.class,fbda3cfc5853ab4744b853398f2b3580505f5a7d67bfb200716ef6ae5be3c8b7,&quot;1.2.13, 1.2.14&quot;,CVE-2019-17571,&quot; 9.8&quot;
        log4j-1.2.9.jar,org/apache/log4j/net/SocketNode.class,3ef93e9cb937295175b75182e42ba9a0aa94f9f8e295236c9eef914348efeef0,&quot;1.2.6, 1.2.7, 1.2.9&quot;,CVE-2019-17571,&quot; 9.8&quot;
        log4j-core-2.0.1.jar,org/apache/logging/log4j/core/lookup/JndiLookup.class,964fa0bf8c045097247fa0c973e0c167df08720409fd9e44546e0ceda3925f3e,2.0.1,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.0-rc1.jar,org/apache/logging/log4j/core/lookup/JndiLookup.class,39a495034d37c7934b64a9aa686ea06b61df21aa222044cc50a47d6903ba1ca8,&quot;2.0.0-beta9, 2.0.0-rc1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.0-rc2.jar,org/apache/logging/log4j/core/lookup/JndiLookup.class,a03e538ed25eff6c4fe48aabc5514e5ee687542f29f2206256840e74ed59bcd2,2.0.0-rc2,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.0.1.jar,org/apache/logging/log4j/core/lookup/JndiLookup.class,964fa0bf8c045097247fa0c973e0c167df08720409fd9e44546e0ceda3925f3e,2.0.1,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.0.2.jar,org/apache/logging/log4j/core/lookup/JndiLookup.class,9626798cce6abd0f2ffef89f1a3d0092a60d34a837a02bbe571dbe00236a2c8c,2.0.2,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.0.jar,org/apache/logging/log4j/core/lookup/JndiLookup.class,fd6c63c11f7a6b52eff04be1de3477c9ddbbc925022f7216320e6db93f1b7d29,2.0.0,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.1.jar,org/apache/logging/log4j/core/net/JndiManager.class,ae950f9435c0ef3373d4030e7eff175ee11044e584b7f205b7a9804bbe795f9c,&quot;2.1.0, 2.2.0, 2.3.0&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.10.0.jar,org/apache/logging/log4j/core/net/JndiManager.class,293d7e83d4197f0496855f40a7745cfcdd10026dc057dfc1816de57295be88a6,&quot;2.10.0, 2.11.0, 2.11.1, 2.11.2, 2.9.0, 2.9.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.11.0.jar,org/apache/logging/log4j/core/net/JndiManager.class,293d7e83d4197f0496855f40a7745cfcdd10026dc057dfc1816de57295be88a6,&quot;2.10.0, 2.11.0, 2.11.1, 2.11.2, 2.9.0, 2.9.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.11.1.jar,org/apache/logging/log4j/core/net/JndiManager.class,293d7e83d4197f0496855f40a7745cfcdd10026dc057dfc1816de57295be88a6,&quot;2.10.0, 2.11.0, 2.11.1, 2.11.2, 2.9.0, 2.9.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.11.2.jar,org/apache/logging/log4j/core/net/JndiManager.class,293d7e83d4197f0496855f40a7745cfcdd10026dc057dfc1816de57295be88a6,&quot;2.10.0, 2.11.0, 2.11.1, 2.11.2, 2.9.0, 2.9.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.12.0.jar,org/apache/logging/log4j/core/net/JndiManager.class,1fa92c00fa0b305b6bbe6e2ee4b012b588a906a20a05e135cbe64c9d77d676de,&quot;2.12.0, 2.12.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.12.1.jar,org/apache/logging/log4j/core/net/JndiManager.class,1fa92c00fa0b305b6bbe6e2ee4b012b588a906a20a05e135cbe64c9d77d676de,&quot;2.12.0, 2.12.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.12.2.jar,org/apache/logging/log4j/core/net/JndiManager.class,b1960d63a3946f9e16e1920624f37c152b58b98932ed04df99ed5d9486732afb,2.12.2,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.13.0.jar,org/apache/logging/log4j/core/net/JndiManager.class,c3e95da6542945c1a096b308bf65bbd7fcb96e3d201e5a2257d85d4dedc6a078,&quot;2.13.0, 2.13.1, 2.13.2, 2.13.3&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.13.1.jar,org/apache/logging/log4j/core/net/JndiManager.class,c3e95da6542945c1a096b308bf65bbd7fcb96e3d201e5a2257d85d4dedc6a078,&quot;2.13.0, 2.13.1, 2.13.2, 2.13.3&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.13.2.jar,org/apache/logging/log4j/core/net/JndiManager.class,c3e95da6542945c1a096b308bf65bbd7fcb96e3d201e5a2257d85d4dedc6a078,&quot;2.13.0, 2.13.1, 2.13.2, 2.13.3&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.13.3.jar,org/apache/logging/log4j/core/net/JndiManager.class,c3e95da6542945c1a096b308bf65bbd7fcb96e3d201e5a2257d85d4dedc6a078,&quot;2.13.0, 2.13.1, 2.13.2, 2.13.3&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.14.0.jar,org/apache/logging/log4j/core/net/JndiManager.class,77323460255818f4cbfe180141d6001bfb575b429e00a07cbceabd59adf334d6,&quot;2.14.0, 2.14.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.14.1.jar,org/apache/logging/log4j/core/net/JndiManager.class,77323460255818f4cbfe180141d6001bfb575b429e00a07cbceabd59adf334d6,&quot;2.14.0, 2.14.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.15.0.jar,org/apache/logging/log4j/core/net/JndiManager.class,db07ef1ea174e000b379732681bd835cfede648a7971bf4e9a0d31981582d69e,2.15.0,CVE-2021-45046,&quot; 3.7&quot;
        log4j-core-2.2.jar,org/apache/logging/log4j/core/net/JndiManager.class,ae950f9435c0ef3373d4030e7eff175ee11044e584b7f205b7a9804bbe795f9c,&quot;2.1.0, 2.2.0, 2.3.0&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.3.jar,org/apache/logging/log4j/core/net/JndiManager.class,ae950f9435c0ef3373d4030e7eff175ee11044e584b7f205b7a9804bbe795f9c,&quot;2.1.0, 2.2.0, 2.3.0&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.4.1.jar,org/apache/logging/log4j/core/net/JndiManager.class,3bff6b3011112c0b5139a5c3aa5e698ab1531a2f130e86f9e4262dd6018916d7,&quot;2.4.0, 2.4.1, 2.5.0&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.4.jar,org/apache/logging/log4j/core/net/JndiManager.class,3bff6b3011112c0b5139a5c3aa5e698ab1531a2f130e86f9e4262dd6018916d7,&quot;2.4.0, 2.4.1, 2.5.0&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.5.jar,org/apache/logging/log4j/core/net/JndiManager.class,3bff6b3011112c0b5139a5c3aa5e698ab1531a2f130e86f9e4262dd6018916d7,&quot;2.4.0, 2.4.1, 2.5.0&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.6.1.jar,org/apache/logging/log4j/core/net/JndiManager.class,6540d5695ddac8b0a343c2e91d58316cfdbfdc5b99c6f3f91bc381bc6f748246,&quot;2.6.0, 2.6.1, 2.6.2&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.6.2.jar,org/apache/logging/log4j/core/net/JndiManager.class,6540d5695ddac8b0a343c2e91d58316cfdbfdc5b99c6f3f91bc381bc6f748246,&quot;2.6.0, 2.6.1, 2.6.2&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.6.jar,org/apache/logging/log4j/core/net/JndiManager.class,6540d5695ddac8b0a343c2e91d58316cfdbfdc5b99c6f3f91bc381bc6f748246,&quot;2.6.0, 2.6.1, 2.6.2&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.7.jar,org/apache/logging/log4j/core/net/JndiManager.class,1584b839cfceb33a372bb9e6f704dcea9701fa810a9ba1ad3961615a5b998c32,&quot;2.7.0, 2.8.0, 2.8.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.8.1.jar,org/apache/logging/log4j/core/net/JndiManager.class,1584b839cfceb33a372bb9e6f704dcea9701fa810a9ba1ad3961615a5b998c32,&quot;2.7.0, 2.8.0, 2.8.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.8.2.jar,org/apache/logging/log4j/core/net/JndiManager.class,764b06686dbe06e3d5f6d15891250ab04073a0d1c357d114b7365c70fa8a7407,2.8.2,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.8.jar,org/apache/logging/log4j/core/net/JndiManager.class,1584b839cfceb33a372bb9e6f704dcea9701fa810a9ba1ad3961615a5b998c32,&quot;2.7.0, 2.8.0, 2.8.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.9.0.jar,org/apache/logging/log4j/core/net/JndiManager.class,293d7e83d4197f0496855f40a7745cfcdd10026dc057dfc1816de57295be88a6,&quot;2.10.0, 2.11.0, 2.11.1, 2.11.2, 2.9.0, 2.9.1&quot;,CVE-2021-44228,&quot; 10.0&quot;
        log4j-core-2.9.1.jar,org/apache/logging/log4j/core/net/JndiManager.class,293d7e83d4197f0496855f40a7745cfcdd10026dc057dfc1816de57295be88a6,&quot;2.10.0, 2.11.0, 2.11.1, 2.11.2, 2.9.0, 2.9.1&quot;,CVE-2021-44228,&quot; 10.0&quot;

sources:
  - query: |
      -- this section searches by filename and hashes hits
      LET target_files = SELECT * FROM glob(globs=TargetGlob,nosymlink=True)
      
      -- recursive search function
      LET Recurse(File, OriginalFile, Container, RecursionRounds) = SELECT * FROM foreach(
                row={
                    SELECT * 
                    FROM glob(accessor=&quot;zip&quot;, root=url(path=File, scheme=&quot;file&quot;), globs=&quot;/**&quot;)
                    WHERE NOT IsDir AND Size &gt; 0
                }, 
                query={
                    SELECT *
                      FROM if(condition=Name =~ &quot;.(jar|war|ear)$&quot;,
                            then={
                                SELECT * FROM Recurse(
                                    OriginalFile=OriginalFile + &quot;/&quot; + url(parse=FullPath).Fragment,
                                    File=copy(dest=tempfile(extension=&quot;.zip&quot;, remove_last=TRUE), 
                                        accessor=&quot;zip&quot;, filename=FullPath),
                                    Container=Container, RecursionRounds = RecursionRounds + 1)
                                WHERE RecursionRounds &lt; MaxRecursions
                                
                            },
                            else={
                              SELECT * FROM switch(
                                path={
                                    SELECT Container,
                                        'Path detection' as Description,
                                        Name, url(parse=FullPath).Fragment AS ZipPath, OriginalFile,
                                        hash(path=FullPath,accessor='zip').SHA256 as SHA256h
                                    FROM scope() 
                                    WHERE ZipPath in IocLookupTable.FilePath 
                                        OR basename(path=ZipPath) in IocLookupTable.JarName 
                                        OR basename(path=Container) in IocLookupTable.JarName
                                },
                                hash={
                                    SELECT Container,
                                        'Hash detection' as Description,
                                        Name, url(parse=FullPath).Fragment AS ZipPath, OriginalFile, Size,
                                        hash(path=FullPath,accessor='zip').SHA256 as SHA256h
                                    FROM scope() 
                                    WHERE SHA256h in IocLookupTable.SHA256 
                                })
                            })
                    })

      -- CVE lookup
      LET find_cve(hash,originalfile) = if(condition= hash in IocLookupTable.SHA256,
                then= { 
                    SELECT Version,Cve,Severity 
                    FROM IocLookupTable 
                    WHERE SHA256 = hash
                    GROUP BY Version,Cve,Severity 
                },
            else= if(condition= basename(path=originalfile) in IocLookupTable.JarName,
                then= { 
                    SELECT Version,Cve,Severity 
                    FROM IocLookupTable 
                    WHERE basename(path=originalfile) = JarName
                    GROUP BY Version,Cve,Severity 
                }))[0]
      
      -- find hits
      LET hits &lt;= SELECT 
                Container as FullPath,
                if(condition= Container=OriginalFile,
                    then= Null,
                    else= OriginalFile ) as Embedded,
                if(condition= Description=~ 'Hash', 
                    then= format(format='%s: %s',args=[Description, SHA256h]),
                else= if(condition= basename(path=Container) in IocLookupTable.JarName,
                    then = format(format='%s: %s',args=[Description, Container]),
                else= if(condition= basename(path=OriginalFile) in IocLookupTable.JarName,
                    then = format(format='%s: %s',args=[Description, OriginalFile]),
                else= format(format='%s: %s',args=[Description, ZipPath])
                    ))) as Description,
                CVEDetails.Version as Log4jVersion,
                CVEDetails.Cve as CVE,
                CVEDetails.Severity as Severity
        FROM foreach(row=target_files,
            query={
                SELECT *,
                    find_cve(hash=SHA256h,originalfile=OriginalFile) as CVEDetails
                FROM Recurse(File=FullPath, OriginalFile=FullPath,Container=FullPath,RecursionRounds=0)
                WHERE CVEDetails
                LIMIT 1
            })
        
      -- upload files that have hits
      LET upload_hits=SELECT *,
            upload(file=FullPath) AS Upload
        FROM hits

      -- return rows
      SELECT * FROM if(condition=UploadHits,
        then=upload_hits,
        else=hits)

</code></pre>
<footer class=footline>
</footer>
</div>
</div>
<div id=navigation>
</div>
</section>
<div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px>
<div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div>
</div>
<script src=/js/clipboard.min.js?1640931064></script>
<script src=/js/perfect-scrollbar.min.js?1640931064></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1640931064></script>
<script src=/js/jquery.sticky.js?1640931064></script>
<script src=/js/featherlight.min.js?1640931064></script>
<script src=/js/highlight.min.js?1640931064></script>
<script>hljs.highlightAll()</script>
<script src=/js/modernizr.custom-3.6.0.js?1640931064></script>
<script src=/js/learn.js?1640931064></script>
<script src=/js/hugo-learn.js?1640931064></script>
</body>
</html>