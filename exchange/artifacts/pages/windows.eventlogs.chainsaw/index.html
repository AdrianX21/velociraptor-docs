<!doctype html><html lang=en class="js csstransforms3d">
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=generator content="Hugo 0.88.0">
<meta name=description content>
<link rel=icon href=/images/favicon.png type=image/png>
<title>Windows.EventLogs.Chainsaw :: Velociraptor - Digging deeper!</title>
<link href=/css/nucleus.css?1630684326 rel=stylesheet>
<link href=/css/fontawesome-all.min.css?1630684326 rel=stylesheet>
<link href=/css/featherlight.min.css?1630684326 rel=stylesheet>
<link href=/css/perfect-scrollbar.min.css?1630684326 rel=stylesheet>
<link href=/css/auto-complete.css?1630684326 rel=stylesheet>
<link href=/css/theme.css?1630684326 rel=stylesheet>
<link href=/css/tabs.css?1630684326 rel=stylesheet>
<link href=/css/hugo-theme.css?1630684326 rel=stylesheet>
<link href=/css/theme-mine.css?1630684326 rel=stylesheet>
<link href=/css/dark.css?1630684326 rel=stylesheet><link href=/css/syntax.css?1630684326 rel=stylesheet><link href=/css/light.css?1630684326 rel=stylesheet><link href=/css/hljs.css?1630684326 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1630684326 rel=stylesheet>
<script src=/js/jquery-3.3.1.min.js?1630684326></script>
<style>:root #header+#content>#left>#rlblock_left{display:none!important}</style>
<script></script>
</head>
<body data-url=/exchange/artifacts/pages/windows.eventlogs.chainsaw/>
<nav id=sidebar><div id=header-wrapper>
<div id=header>
<script>function darkmode(){$("body").addClass("dark").removeClass("light"),document.cookie="theme=darkmode;path=/"}function lightmode(){$("body").removeClass("dark").addClass("light"),document.cookie="theme=lightmode;path=/"}const regex=new RegExp('theme=darkmode');regex.test(document.cookie)?darkmode():lightmode()</script>
<div class="btn btn-default ThemeSelector darkmode" onclick=darkmode()>
<i class="fas fa-moon"></i>
</div>
<div class="btn btn-default ThemeSelector lightmode" onclick=lightmode()>
<i class="fas fa-sun"></i>
</div>
<a href=https://docs.velociraptor.app/>
<img src=https://docs.velociraptor.app//images/logo.svg>
</a>
</div>
</div>
<div class=highlightable>
<ul class=topics>
<li data-nav-id=https://docs.velociraptor.app/announcements/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/><i class="fas fa-bullhorn"></i>Announcements</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/announcements/2021-artifact-contest/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/2021-artifact-contest/>2021 Contest</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/><i class="fas fa-book-reader"></i>Documentation</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/overview/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/overview/>Velociraptor Overview</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/overview/history/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/history/>History</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/>Deployment</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/self-signed/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/self-signed/>Self-Signed SSL</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/>Cloud Deployment</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/clients/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/clients/>Deploying Clients</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/rbac/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/rbac/>Users and Roles</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/resources/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/resources/>Performance</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/troubleshooting/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/troubleshooting/>Troubleshooting</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/gui/>The Admin GUI</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/clients/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/clients/>Inspecting clients</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/vfs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/vfs/>The VFS</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/artifacts/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/artifacts/>Artifacts</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/hunting/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/hunting/>Hunting</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/vql/>VQL Fundamentals</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/notebooks/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/notebooks/>Notebooks</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/artifacts/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/artifacts/>Artifacts</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/events/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/events/>Event Queries</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/>Forensic Analysis</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/>Searching Filenames</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/searching/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/searching/>Searching Content</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/ntfs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/ntfs/>NTFS Analysis</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/evidence_of_execution/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/evidence_of_execution/>Evidence Of Execution</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/event_logs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/event_logs/>Event Logs</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/volatile/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/volatile/>Volatile State</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/offline_triage/>Triage and acquisition</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/extending_vql/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/extending_vql/>Extending VQL</a>
</div>
</li>
</ul>
</li><hr>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/vql_reference/><i class="fas fa-book"></i>VQL Reference</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/basic/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/basic/>Basic VQL</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/windows/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/windows/>Windows Specific</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/parsers/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/parsers/>Parsers</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/server/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/server/>Server Side</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/plugin/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/plugin/>Client Side</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/event/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/event/>Event Plugins</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/experimental/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/experimental/>Experimental</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/misc/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/misc/>Misc</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/training/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/training/><i class="fas fa-graduation-cap"></i>Training</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/blog/ class="dd-item haschildren">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/blog/><i class="fas fa-newspaper"></i>Blog</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/presentations/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/presentations/><i class="fas fa-chalkboard-teacher"></i>Presentations</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/presentations/2021_dfrws_us/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2021_dfrws_us/>DFRWS US 2021 Workshop</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/exchange/ class="dd-item parent haschildren">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/exchange/><i class="fas fa-code"></i>Artifact Exchange</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/search/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/search/><i class="fas fa-search"></i>Search</a>
</div>
</li>
</ul>
<hr>
<section id=shortcuts>
<h3></h3>
<ul>
<li>
<a class=padding href=https://github.com/Velocidex/velociraptor><i class="fab fa-github"></i>Github</a>
</li>
<li>
<a class=padding href=https://docs.velociraptor.app/discord/><i class="fab fa-discord"></i>Discord</a>
</li>
<li>
<a class=padding href=mailto:velociraptor-discuss@googlegroups.com><i class="fas fa-envelope"></i>Mailing List</a>
</li>
</ul>
</section>
<section id=footer>
<div class=footer-copyright>Brough to you by
<img src=/images/Rapid7_logo.svg class=rapid7>
<br> <i class="fas fa-copyright"></i> 2021
</div>
</section>
</div>
</nav>
<script>$("#sidebar i.fa-angle-right").each(function(){$(this).parent().parent().find("ul").hide()})</script>
<section id=body>
<div id=overlay></div>
<div class="padding highlightable">
<div>
<div id=top-bar>
<div id=top-github-link>
<a class=github-link title="Edit this page" href=https://github.com/Velocidex/velociraptor-docs/edit/master/content/exchange/artifacts/Windows.EventLogs.Chainsaw.yaml target=blank>
<i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span>
</a>
</div>
<div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb>
<span id=sidebar-toggle-span>
<a href=# id=sidebar-toggle data-sidebar-toggle>
<i class="fas fa-bars"></i>
</a>
</span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>
Windows.EventLogs.Chainsaw
</span>
</div>
<div class=progress>
<div class=wrapper>
<nav id=TableOfContents></nav>
</div>
</div>
</div>
</div>
<div id=head-tags>
</div>
<div id=body-inner>
<h1>
Windows.EventLogs.Chainsaw
</h1>
<div class="author pull-right">
<span class=date></span>
</div>
<p>This artifact leverages Chainsaw to enable usage of Sigma rules to faciliate detection within Windows Event Logs.</p>
<p>From the project&rsquo;s description:</p>
<p>&ldquo;Chainsaw provides a powerful ‘first-response’ capability to quickly identify threats within Windows event logs.
It offers a generic and fast method of searching through event logs for keywords, and by identifying threats using built-in detection logic and via support for Sigma detection rules.&rdquo;</p>
<p><a href=https://github.com/countercept/chainsaw>https://github.com/countercept/chainsaw</a></p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Windows.EventLogs.Chainsaw</span><span class=w>
</span><span class=w></span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span><span class=sd>    
</span><span class=sd>    This artifact leverages Chainsaw to enable usage of Sigma rules to faciliate detection within Windows Event Logs.
</span><span class=sd>    
</span><span class=sd>    From the project&#39;s description:
</span><span class=sd>    
</span><span class=sd>    &#34;Chainsaw provides a powerful ‘first-response’ capability to quickly identify threats within Windows event logs. 
</span><span class=sd>    It offers a generic and fast method of searching through event logs for keywords, and by identifying threats using built-in detection logic and via support for Sigma detection rules.&#34;
</span><span class=sd>    
</span><span class=sd>    https://github.com/countercept/chainsaw
</span><span class=sd>    
</span><span class=sd>    </span><span class=w>    
</span><span class=w></span><span class=nt>author</span><span class=p>:</span><span class=w> </span><span class=l>Wes Lambert - @therealwlambert</span><span class=w>
</span><span class=w>
</span><span class=w></span><span class=nt>tools</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Chainsaw</span><span class=w>
</span><span class=w>    </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=l>https://github.com/countercept/chainsaw/releases/download/v1.0.0/chainsaw_x86_64-pc-windows-msvc.zip</span><span class=w>
</span><span class=w></span><span class=nt>parameters</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>EVTXPath</span><span class=w>
</span><span class=w>    </span><span class=nt>default</span><span class=p>:</span><span class=w> </span><span class=l>C:\Windows\System32\winevt\Logs\*.evtx</span><span class=w>
</span><span class=w></span><span class=nt>sources</span><span class=p>:</span><span class=w>
</span><span class=w>  </span>- <span class=nt>query</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span><span class=sd>        // Download Chainsaw
</span><span class=sd>        LET Toolzip = SELECT * FROM Artifact.Generic.Utils.FetchBinary(
</span><span class=sd>            ToolName=&#34;Chainsaw&#34;, IsExecutable=FALSE)
</span><span class=sd>        //Create temp directory
</span><span class=sd>        LET TmpDir &lt;= tempdir()
</span><span class=sd>        //Create tempfile for JSON results
</span><span class=sd>        LET TmpResults &lt;= tempfile()
</span><span class=sd>        //Read in results file when ready
</span><span class=sd>        LET Results = SELECT * FROM read_file(filenames=TmpResults)
</span><span class=sd>        //Unzip into temp dir
</span><span class=sd>        LET UnzipIt &lt;= SELECT * FROM  unzip(filename=url(path=Toolzip[0].FullPath).String, output_directory=TmpDir)
</span><span class=sd>        //Sigma rules
</span><span class=sd>        Let SigmaRules &lt;= TmpDir + &#39;/chainsaw/sigma_rules&#39; 
</span><span class=sd>        //Mapping file(s) for Sigma
</span><span class=sd>        Let SigmaMapping &lt;= TmpDir + &#39;/chainsaw/mapping_files/sigma-mapping.yml&#39;
</span><span class=sd>        //Chainsaw hunt -- Example: ./chainsaw hunt evtx_attack_samples/ --json results.json --rules sigma_rules/ --mapping mapping_files/sigma-mapping.yml
</span><span class=sd>        LET ExecCS = TmpDir + &#39;/chainsaw/chainsaw hunt &#39; + EVTXPath + &#39; --json &#39; + TmpResults + &#39; --rules &#39; + SigmaRules + &#39; --mapping &#39; + SigmaMapping
</span><span class=sd>        //Execute Chainsaw and cleanup for JSON
</span><span class=sd>        LET ExecCmd &lt;= ExecCS + &#39;; [IO.Directory]::SetCurrentDirectory((Convert-Path (Get-Location -PSProvider FileSystem)));$filetxt = [IO.File]::ReadAllText(&#34;&#39; + TmpResults + &#39;&#34;); $filetxt = ($filetxt -replace &#34;(?ms)^}\n{&#34;, &#34;},`r`n{&#34;);Set-Content -Path &#34;&#39; + TmpResults + &#39;&#34; -Value $filetxt; &#34;[&#34; + (Get-Content &#39; + TmpResults + &#39; -Raw) | Set-Content &#39; + TmpResults + &#39;; (Get-Content &#39; + TmpResults + &#39; -Raw) + &#34;]&#34; | Set-Content &#39; + TmpResults + &#39;;&#39;
</span><span class=sd>        LET ExecIt &lt;= SELECT * from Artifact.Windows.System.PowerShell(Command=ExecCmd)
</span><span class=sd>        LET Data = SELECT * FROM foreach(row=Results, query={SELECT parse_json_array(data=Data) AS Content FROM scope()})
</span><span class=sd>        LET Matches = SELECT * FROM foreach(row=Data, query={ 
</span><span class=sd>            SELECT
</span><span class=sd>                get(member=&#34;event.Event.System.TimeCreated.#attributes.SystemTime&#34;) AS EventTime,
</span><span class=sd>                get(member=&#34;detection&#34;) AS Detection, 
</span><span class=sd>                get(member=&#34;event.Event.System.EventID&#34;) AS _EventID, 
</span><span class=sd>                get(member=&#34;event.Event.System.Computer&#34;) AS _Computer, 
</span><span class=sd>                get(member=&#34;event.Event.EventData.User&#34;) AS _User,
</span><span class=sd>                get(member=&#34;event.Event.System.Channel&#34;) AS _Channel,
</span><span class=sd>                get(member=&#34;event.Event.EventData&#34;) AS SystemData,  
</span><span class=sd>                get(member=&#34;event.Event.System&#34;) AS EventData
</span><span class=sd>            FROM Content
</span><span class=sd>        })
</span><span class=sd>        SELECT * FROM Matches</span><span class=w>        
</span><span class=w>
</span></code></pre></div>
<footer class=footline>
</footer>
</div>
</div>
<div id=navigation>
</div>
</section>
<div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px>
<div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div>
</div>
<script src=/js/clipboard.min.js?1630684326></script>
<script src=/js/perfect-scrollbar.min.js?1630684326></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1630684326></script>
<script src=/js/jquery.sticky.js?1630684326></script>
<script src=/js/featherlight.min.js?1630684326></script>
<script src=/js/highlight.min.js?1630684326></script>
<script></script>
<script src=/js/modernizr.custom-3.6.0.js?1630684326></script>
<script src=/js/learn.js?1630684326></script>
<script src=/js/hugo-learn.js?1630684326></script>
</body>
</html>