<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Artifact Exchange on Velociraptor - Digging deeper!</title><link>https://docs.velociraptor.app/exchange/</link><description>Recent content in Artifact Exchange on Velociraptor - Digging deeper!</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sat, 12 Jun 2021 14:03:59 +0000</lastBuildDate><atom:link href="https://docs.velociraptor.app/exchange/index.xml" rel="self" type="application/rss+xml"/><item><title>Custom.Label.User</title><link>https://docs.velociraptor.app/exchange/artifacts/pages/custom.label.user/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.velociraptor.app/exchange/artifacts/pages/custom.label.user/</guid><description>This artifact watches for new client enrolments and automatically label the client with the required label if the user exists.
This artifact can be the starting point for automatically labeling a machine based on any other property - just change the artifact to watch and the result filter.
#server #event #labels
name:Custom.Label.Userdescription:|This artifact watches for new client enrolments and automatically label the client with the required label if the user exists.</description></item><item><title>HashRunKeys</title><link>https://docs.velociraptor.app/exchange/artifacts/pages/hash_run_keys/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.velociraptor.app/exchange/artifacts/pages/hash_run_keys/</guid><description>Iterate over all the run keys and locate their binary then hash it.
#windows #registry #detection
name:HashRunKeysdescription:|Iterate over all the run keys and locate their binary then hash it. #windows #registry #detectionparameters:- name:runKeysdefault:|HKEY_USERS\*\Software\Microsoft\Windows\CurrentVersion\Run\*- name:pathRegextype:hidden# Pick the first part - either quoted or not.default:&amp;gt;-(^&amp;#34;(?P&amp;lt;quoted_path&amp;gt;[^&amp;#34;]+)&amp;#34;|(?P&amp;lt;unquoted_path&amp;gt;^[^ ]+))sources:- precondition:SELECT OS From info() where OS = &amp;#39;windows&amp;#39;queries:- LET paths = SELECT FullPath,Name, Data.value AS Value,parse_string_with_regex(string=Data.value,regex=pathRegex) as regDataFROM glob(globs=split(string=runKeys, sep=&amp;#34;[, \\n]+&amp;#34;),accessor=&amp;#34;reg&amp;#34;)WHERE Data.value# Handle some variations we see in the value:# system32\drivers\XXX.</description></item><item><title>Linux.Memory.Acquisition</title><link>https://docs.velociraptor.app/exchange/artifacts/pages/linuxmemoryacquisition/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.velociraptor.app/exchange/artifacts/pages/linuxmemoryacquisition/</guid><description>Acquires a full memory image. We download LiME and use it to acquire a full memory image.
NOTE: This artifact usually transfers a lot of data. You should increase the default timeout to allow it to complete. ( Example : 2Gb of memory time takes about 50s )
name:Linux.Memory.Acquisitionauthor:URCA (Corentin Garcia / Emmanuel Mesnard)description:|Acquires a full memory image. We download LiME and use it to acquire a full memory image. NOTE: This artifact usually transfers a lot of data.</description></item><item><title>Linux.Volatility.Create.Profile</title><link>https://docs.velociraptor.app/exchange/artifacts/pages/volatility_profile/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.velociraptor.app/exchange/artifacts/pages/volatility_profile/</guid><description>This artifact is used to create the profile to the environnements Debian / Ubuntu.
name:Linux.Volatility.Create.Profileauthor:URCA (Corentin Garcia / Emmanuel Mesnard)description:|This artifact is used to create the profile to the environnements Debian / Ubuntu.required_permissions:- EXECVEtools:- name:Volatilityurl:https://github.com/volatilityfoundation/volatility/archive/master.zipparameters:- name:Zipnametype:stringdefault:Ubuntuprecondition:SELECT OS From info() where OS = &amp;#39;linux&amp;#39;sources:- queries:- LET dirtmp = tempdir(remove_last=true)LET vola = SELECT * FROM execve(argv=[&amp;#39;bash&amp;#39;, &amp;#39;-c&amp;#39;, &amp;#39;mv /tmp/master.zip /tmp/volatility-master.zip ; cd /tmp/ ; apt install -y dwarfdump zip unzip ; unzip -o /tmp/volatility-master.</description></item><item><title>Windows.Applications.FTKImager</title><link>https://docs.velociraptor.app/exchange/artifacts/pages/ftkimager/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.velociraptor.app/exchange/artifacts/pages/ftkimager/</guid><description>Create an E01 Image of the C drive using FTK Imager (Command Line Version)
SourceDriveToImage usually will be 0 (as in \.\PHYSICALDRIVE0) for the C: drive, on a Windows system.
If you intend to image the secondary drive, use, for example, SourceDriveToImage = 1, for \.\PHYSICALDRIVE1
name:Windows.Applications.FTKImagerdescription:|Create an E01 Image of the C drive using FTK Imager (Command Line Version) SourceDriveToImage usually will be 0 (as in \\.\PHYSICALDRIVE0) for the C: drive, on a Windows system.</description></item><item><title>Windows.Detection.PrintNightmare</title><link>https://docs.velociraptor.app/exchange/artifacts/pages/printnightmare/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.velociraptor.app/exchange/artifacts/pages/printnightmare/</guid><description>This artifact returns any binaries in the Windows/spool/drivers/** folders with an untrusted Authenticode entry.
It can be used to hunt for dll files droped during exploitation of CVE-2021-1675 - PrintNightmare.
To query all attached ntfs drives: check the AllDrives switch.
I have added several filters to uplift search capabilities from the original MFT artifact. Due to the multi-drive features, the MFTPath will output the MFT path of the entry.
Available filters include:</description></item><item><title>Windows.ETW.AMSI</title><link>https://docs.velociraptor.app/exchange/artifacts/pages/amsi/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.velociraptor.app/exchange/artifacts/pages/amsi/</guid><description>This artifact uses the ETW provider: (Microsoft-Antimalware-Scan-Interface - {2A576B87-09A7-520E-C21A-4942F0271D67}
name:Windows.ETW.AMSIdescription:|This artifact uses the ETW provider: (Microsoft-Antimalware-Scan-Interface - {2A576B87-09A7-520E-C21A-4942F0271D67}type:CLIENT_EVENTparameters:- name:IocRegexdescription:&amp;#34;Regex of strings to filter for&amp;#34;default:.- name:WhitelistRegexdescription:&amp;#34;Regex of strings to witelist&amp;#34;- name:AppNameRegexdescription:&amp;#34;Application name Regex to enable filtering on source.&amp;#34;default:.sources:- query:|-- collect a small cache of process information for enrichment LET proc = cache(key=&amp;#39;Pid&amp;#39;, period=600, query={ SELECT Pid, Name, Exe,CommandLine, Username,TokenIsElevated FROM pslist() })-- watch ETW provider and first round data manipulationLET hits = SELECT *,timestamp(epoch=timestamp(string=System.</description></item><item><title>Windows.Remediation.PrintSpooler</title><link>https://docs.velociraptor.app/exchange/artifacts/pages/printspoolerremediation/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.velociraptor.app/exchange/artifacts/pages/printspoolerremediation/</guid><description>This artifact will enable mitigation of PrintSpooler exploitation used by PrintNightmare - CVE-2021-34527 and CVE-2021-1675.
There are two selectable mitigations:
disabling the print spooler service.
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Spooler\Start = 4 (service disabled).
disable remote registration of the spool service. HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers\RegisterSpoolerRemoteRpcEndPoint = 2 (RegisterSpoolerRemoteRpcEndPoint disables).
NOTE: ChangeServiceStartup will set to disable, not stop the printspool service. Its always reccomended to use group policy to deploy these settings.</description></item></channel></rss>