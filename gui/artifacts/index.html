<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.83.1"><meta name=description content><link rel=icon href=/images/favicon.png type=image/png><title>Artifacts :: Velociraptor - Digging deeper!</title><link href=/css/nucleus.css?1623693523 rel=stylesheet><link href=/css/fontawesome-all.min.css?1623693523 rel=stylesheet><link href=/css/hybrid.css?1623693523 rel=stylesheet><link href=/css/featherlight.min.css?1623693523 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1623693523 rel=stylesheet><link href=/css/auto-complete.css?1623693523 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1623693523 rel=stylesheet><link href=/css/theme.css?1623693523 rel=stylesheet><link href=/css/tabs.css?1623693523 rel=stylesheet><link href=/css/hugo-theme.css?1623693523 rel=stylesheet><link href=/css/theme-mine.css?1623693523 rel=stylesheet><link href=/css/atom-one-light.css?1623693523 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1623693523 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1623693523></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/gui/artifacts/><nav id=sidebar><div id=header-wrapper><div id=header><script>function darkmode(){alert("Switch to dark mode")}</script><div class="btn btn-default ThemeSelector" onclick=darkmode()><i class="fas fa-moon"></i></div><a href=https://docs.velociraptor.app/><img src=https://docs.velociraptor.app//images/logo.svg></a></div></div><div class=highlightable><ul class=topics><li data-nav-id=/overview/ title="Velociraptor Overview" class=dd-item><a href=/overview/>Velociraptor Overview</a><ul><li data-nav-id=/overview/history/ title=History class=dd-item><a href=/overview/history/>History</a></li><li data-nav-id=/overview/deployment/ title="Deployment Overview" class=dd-item><a href=/overview/deployment/>Deployment Overview</a><ul><li data-nav-id=/overview/deployment/self-signed/ title="Self Signed SSL" class=dd-item><a href=/overview/deployment/self-signed/>Self Signed SSL</a></li><li data-nav-id=/overview/deployment/cloud/ title="Cloud Deployment" class=dd-item><a href=/overview/deployment/cloud/>Cloud Deployment</a></li><li data-nav-id=/overview/deployment/clients/ title="Deploying Clients" class=dd-item><a href=/overview/deployment/clients/>Deploying Clients</a></li><li data-nav-id=/overview/deployment/rbac/ title="Users and Roles" class=dd-item><a href=/overview/deployment/rbac/>Users and Roles</a></li><li data-nav-id=/overview/deployment/resources/ title=Performance class=dd-item><a href=/overview/deployment/resources/>Performance</a></li></ul></li></ul></li><li data-nav-id=/gui/ title="The Admin GUI" class="dd-item
parent"><a href=/gui/>The Admin GUI</a><ul><li data-nav-id=/gui/clients/ title="Inspecting clients" class=dd-item><a href=/gui/clients/>Inspecting clients</a></li><li data-nav-id=/gui/vfs/ title="The VFS" class=dd-item><a href=/gui/vfs/>The VFS</a></li><li data-nav-id=/gui/artifacts/ title=Artifacts class="dd-item
parent
active"><a href=/gui/artifacts/>Artifacts</a></li><li data-nav-id=/gui/hunting/ title=Hunting class=dd-item><a href=/gui/hunting/>Hunting</a></li></ul></li><li data-nav-id=/vql/ title="VQL Fundamentals" class=dd-item><a href=/vql/>VQL Fundamentals</a><ul><li data-nav-id=/vql/notebooks/ title=Notebooks class=dd-item><a href=/vql/notebooks/>Notebooks</a></li><li data-nav-id=/vql/artifacts/ title=Artifacts class=dd-item><a href=/vql/artifacts/>Artifacts</a></li></ul></li><li data-nav-id=/vql_reference/ title="VQL Reference" class=dd-item><a href=/vql_reference/>VQL Reference</a><ul><li data-nav-id=/vql_reference/basic/ title="Basic VQL functions and plugins" class=dd-item><a href=/vql_reference/basic/>Basic VQL</a></li><li data-nav-id=/vql_reference/windows/ title="Windows Specific Functionality" class=dd-item><a href=/vql_reference/windows/>Windows</a></li><li data-nav-id=/vql_reference/parsers/ title="Parsers and data extractors" class=dd-item><a href=/vql_reference/parsers/>Parsers</a></li><li data-nav-id=/vql_reference/server/ title="Server Side Functionality" class=dd-item><a href=/vql_reference/server/>Server</a></li><li data-nav-id=/vql_reference/plugin/ title="Client Side Functionality" class=dd-item><a href=/vql_reference/plugin/>Client</a></li><li data-nav-id=/vql_reference/event/ title="Event Plugins" class=dd-item><a href=/vql_reference/event/>Event Plugins</a></li><li data-nav-id=/vql_reference/experimental/ title="Experimental Functionality" class=dd-item><a href=/vql_reference/experimental/>Experimental</a></li></ul></li><li data-nav-id=/blog/ title="Velociraptor Blog" class=dd-item><a href=/blog/>Velociraptor Blog</a><ul><li data-nav-id=/blog/2021/ title=2021 class=dd-item><a href=/blog/2021/>2021</a><ul><li data-nav-id=/blog/2021/2021-01-22-concurrent-vql-6d381fdb0b1f/ title="Concurrent VQL" class=dd-item><a href=/blog/2021/2021-01-22-concurrent-vql-6d381fdb0b1f/>Concurrent VQL</a></li><li data-nav-id=/blog/2021/2021-01-19-parsing-binary-files-d31114a41f14/ title="Parsing binary files" class=dd-item><a href=/blog/2021/2021-01-19-parsing-binary-files-d31114a41f14/>Parsing binary files</a></li></ul></li><li data-nav-id=/blog/2020/ title=2020 class=dd-item><a href=/blog/2020/>2020</a><ul><li data-nav-id=/blog/2020/2020-12-26-slack-and-velociraptor-b63803ba4b16/ title="Slack and Velociraptor" class=dd-item><a href=/blog/2020/2020-12-26-slack-and-velociraptor-b63803ba4b16/>Slack and Velociraptor</a></li><li data-nav-id=/blog/2020/2020-12-13-velociraptor-and-osquery-2a4306dd23c/ title="Velociraptor and OSQuery" class=dd-item><a href=/blog/2020/2020-12-13-velociraptor-and-osquery-2a4306dd23c/>Velociraptor and OSQuery</a></li><li data-nav-id=/blog/2020/2020-11-13-the-windows-usn-journal-f0c55c9010e/ title="The Windows USN Journal" class=dd-item><a href=/blog/2020/2020-11-13-the-windows-usn-journal-f0c55c9010e/>The Windows USN Journal</a></li><li data-nav-id=/blog/2020/2020-09-28-velociraptor-network-communications-30568624043a/ title="Velociraptor Communications" class=dd-item><a href=/blog/2020/2020-09-28-velociraptor-network-communications-30568624043a/>Velociraptor Communications</a></li><li data-nav-id=/blog/2020/2020-08-17-velociraptor-sso-authentication-6dd68d46dccf/ title="Velociraptor SSO Authentication" class=dd-item><a href=/blog/2020/2020-08-17-velociraptor-sso-authentication-6dd68d46dccf/>Velociraptor SSO Authentication</a></li><li data-nav-id=/blog/2020/2020-08-16-profiling-the-beast-58913437fd16/ title="Profiling the beast" class=dd-item><a href=/blog/2020/2020-08-16-profiling-the-beast-58913437fd16/>Profiling the beast</a></li><li data-nav-id=/blog/2020/2020-07-14-triage-with-velociraptor-pt-4-cf0e60810d1e/ title="Triage with Velociraptor — Pt 4" class=dd-item><a href=/blog/2020/2020-07-14-triage-with-velociraptor-pt-4-cf0e60810d1e/>Triage with Velociraptor — Pt 4</a></li><li data-nav-id=/blog/2020/2020-07-13-velociraptor-in-the-tool-age-d896dfe71b9/ title="Velociraptor in the tool age" class=dd-item><a href=/blog/2020/2020-07-13-velociraptor-in-the-tool-age-d896dfe71b9/>Velociraptor in the tool age</a></li><li data-nav-id=/blog/2020/2020-06-19-the-velociraptor-query-language-pt-2-fe92bb7aa150/ title="The Velociraptor Query Language Pt 2" class=dd-item><a href=/blog/2020/2020-06-19-the-velociraptor-query-language-pt-2-fe92bb7aa150/>The Velociraptor Query Language Pt 2</a></li><li data-nav-id=/blog/2020/2020-06-14-the-velociraptor-query-language-pt-1-d721bff100bf/ title="The Velociraptor Query Language Pt 1" class=dd-item><a href=/blog/2020/2020-06-14-the-velociraptor-query-language-pt-1-d721bff100bf/>The Velociraptor Query Language Pt 1</a></li><li data-nav-id=/blog/2020/2020-04-16-velociraptor-e48a47e0317d/ title=Velociraptor class=dd-item><a href=/blog/2020/2020-04-16-velociraptor-e48a47e0317d/>Velociraptor</a></li><li data-nav-id=/blog/2020/2020-03-29-velociraptors-acl-model-7f497575daee/ title="Velociraptor’s ACL model" class=dd-item><a href=/blog/2020/2020-03-29-velociraptors-acl-model-7f497575daee/>Velociraptor’s ACL model</a></li><li data-nav-id=/blog/2020/2020-03-28-velociraptor-notebooks-d02e0bd11230/ title="Velociraptor notebooks" class=dd-item><a href=/blog/2020/2020-03-28-velociraptor-notebooks-d02e0bd11230/>Velociraptor notebooks</a></li><li data-nav-id=/blog/2020/2020-03-07-extending-vql-plugins-7fb004cb6ec4/ title="Extending VQL plugins" class=dd-item><a href=/blog/2020/2020-03-07-extending-vql-plugins-7fb004cb6ec4/>Extending VQL plugins</a></li><li data-nav-id=/blog/2020/2020-03-06-velociraptor-post-processing-with-jupyter-notebook-and-pandas-8a344d05ee8c/ title="Velociraptor Post-processing with Jupyter Notebook and Pandas" class=dd-item><a href=/blog/2020/2020-03-06-velociraptor-post-processing-with-jupyter-notebook-and-pandas-8a344d05ee8c/>Velociraptor Post-processing with Jupyter Notebook and Pandas</a></li><li data-nav-id=/blog/2020/2020-01-12_hunting-malware-using-mutants-ea08e86dfc19/ title="Hunting Malware using Mutants" class=dd-item><a href=/blog/2020/2020-01-12_hunting-malware-using-mutants-ea08e86dfc19/>Hunting Malware using Mutants</a></li></ul></li><li data-nav-id=/blog/2019/ title=2019 class=dd-item><a href=/blog/2019/>2019</a><ul><li data-nav-id=/blog/2019/2019-12-31_digging-into-the-system-resource-usage-monitor-srum-afbadb1a375/ title="Digging into the System Resource Usage Monitor (SRUM)" class=dd-item><a href=/blog/2019/2019-12-31_digging-into-the-system-resource-usage-monitor-srum-afbadb1a375/>Digging into the System Resource Usage Monitor (SRUM)</a></li><li data-nav-id=/blog/2019/2019-12-08-velociraptor-to-elasticsearch-3a9fc02c6568/ title="Velociraptor to Elasticsearch" class=dd-item><a href=/blog/2019/2019-12-08-velociraptor-to-elasticsearch-3a9fc02c6568/>Velociraptor to Elasticsearch</a></li><li data-nav-id=/blog/2019/2019-11-15_recovering-deleted-ntfs-files-with-velociraptor-1fcf09855311/ title="Recovering deleted NTFS Files with Velociraptor" class=dd-item><a href=/blog/2019/2019-11-15_recovering-deleted-ntfs-files-with-velociraptor-1fcf09855311/>Recovering deleted NTFS Files with Velociraptor</a></li><li data-nav-id=/blog/2019/2019-11-12_windows-event-logs-d8d8e615c9ca/ title="Windows Event Logs" class=dd-item><a href=/blog/2019/2019-11-12_windows-event-logs-d8d8e615c9ca/>Windows Event Logs</a></li><li data-nav-id=/blog/2019/2019-10-08_triage-with-velociraptor-pt-3-d6f63215f579/ title="Triage with Velociraptor — Pt 3" class=dd-item><a href=/blog/2019/2019-10-08_triage-with-velociraptor-pt-3-d6f63215f579/>Triage with Velociraptor — Pt 3</a></li><li data-nav-id=/blog/2019/2019-10-04_triage-with-velociraptor-pt-2-d0f79066ca0e/ title="Triage with Velociraptor — Pt 2" class=dd-item><a href=/blog/2019/2019-10-04_triage-with-velociraptor-pt-2-d0f79066ca0e/>Triage with Velociraptor — Pt 2</a></li><li data-nav-id=/blog/2019/2019-10-02_triage-with-velociraptor-pt-1-253f57ce96c0/ title="Triage with Velociraptor — Pt 1" class=dd-item><a href=/blog/2019/2019-10-02_triage-with-velociraptor-pt-1-253f57ce96c0/>Triage with Velociraptor — Pt 1</a></li><li data-nav-id=/blog/2019/2019-09-11_velociraptor-s-client-side-buffer-3ce03697a4e6/ title="Velociraptor’s client side buffer" class=dd-item><a href=/blog/2019/2019-09-11_velociraptor-s-client-side-buffer-3ce03697a4e6/>Velociraptor’s client side buffer</a></li><li data-nav-id=/blog/2019/2019-03-02/ title="Agentless hunting with Velociraptor" class=dd-item><a href=/blog/2019/2019-03-02/>Agentless hunting with Velociraptor</a></li></ul></li></ul></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://docs.velociraptor.app/search><i class="fas fa-search"></i> Search</a></li><li><a class=padding href=https://github.com/Velocidex/velociraptor><i class="fab fa-github"></i> Github repo</a></li></ul></section><section id=footer><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a> from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>Artifacts</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#what-are-artifacts>What are Artifacts?</a><ul><li><a href=#example---collect-scheduled-tasks-from-endpoint>Example - collect Scheduled Tasks from endpoint.</a></li></ul></li><li><a href=#inspecting-and-modifying-artifacts>Inspecting and modifying artifacts</a></li><li><a href=#learn-more>Learn more</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Artifacts</h1><p>We have previously mentioned that Velociraptor&rsquo;s superpower is a
powerful query language termed <code>VQL</code>. How do we use VQL to query the
endpoints?</p><p>You might be surprised to learn that you have already been using VQL
all this time. When clicking in the VFS interface to sync a directory
listing or download files, the GUI was collecting artifacts behind the
scenes.</p><p>Click on the <code>Collected Artifacts</code> sidebar screen to view the
artifacts that have been collected so far.</p><p><img src=image71.png alt="Collected Artifacts"></p><p>This screen consists of two panes - the top pane shows a list of all
the <code>Artifacts</code> collected so far from this endpoint, while the bottom
pane shows information about the selected artifact.</p><p>We can immediately recognize that artifacts have a <strong>Name</strong> - in this
case we have been collecting <code>System.VFS.DownloadFile</code> and
<code>System.VFS.ListDirectory</code> in order to populate the VFS screen.</p><p>Each collection of these artifacts has a unique <code>Flow ID</code> which is how
Velociraptor refers to this collection. The collection is created at a
certain time and starts some time later (if the client is not
presently connected then the client will start the collection when it
comes back online).</p><p>Collections also take parameters - you can recognize in the above
example that the <code>System.VFS.ListDirectory</code> artifact was used to list
the directory &ldquo;C:\Users\test&rdquo;.</p><p>Finally you can see that a collection can return rows or upload
files. This is because an artifact is simply a VQL query - and all
queries simply return a sequence of rows.</p><h2 id=what-are-artifacts>What are Artifacts?</h2><p>Ultimately Velociraptor is simply a VQL engine - i.e. it processes a
VQL query producing a series of rows and then sending those rows to
the server.</p><p>An <code>Artifact</code> is a way for us to package one or more VQL queries in a
human readable YAML file, provide it with a name and allow users to
collect it. An Artifact file simply embodies the query required to
collect or answer a specific question about the endpoint.</p><div class="mynotices note"><div><p>The whole point of Artifacts is to encapsulate a VQL query inside a
YAML file, so that end users so not need to understand the query to be
able to use it. This makes artifacts easier to use and facilitates
knowledge sharing with more experienced users.</p></div></div><h3 id=example---collect-scheduled-tasks-from-endpoint>Example - collect Scheduled Tasks from endpoint.</h3><p>To illustrate how artifacts can be used, let&rsquo;s collect a common
forensic artifact from our Windows endpoint. Windows allows commands
to be scheduled in the future. These tasks are typically stored in the
<code>C:\\Windows\\System32\\Tasks</code> directory as XML files.</p><p>While it is nice to know the details behind where the scheduled tasks
are stored and how to parse them - this is completely unnecessary with
Velociraptor, since we have a built-in artifact ready to collect these
tasks!</p><p>Start a new collection by clicking the <code>New Collection</code> button <i class="fas fa-plus"></i>. This will open the new collection wizard as show below.</p><p><img src=image73.png alt="New Collection Wizard"></p><p>The Wizard contains a number of steps but you can skip them if they are not needed.</p><p>In the first step, we search for an artifact to collect the type of
information we are after. In this case we start searching for task and
see our <code>Windows.System.TaskScheduler</code> artifact.</p><p>The next step allows us to tweak any of the artifact parameters.</p><p><img src=image74.png alt="Artifact Parameters"></p><p>Artifacts can take parameters and each parameter has a default value.</p><p>In this case we will choose to also upload the raw XML files. We just
click <code>Launch</code> to start the collection. After a short time, the
collection will complete.</p><p><img src=image75.png alt="Collection Complete"></p><p>We can see that this collection uploaded 195 files and added 195
rows. The VQL query parses each XML file in turn and uploads it.</p><p>We can see more information about this collection in the tabs in the
bottom pane:</p><ol><li>Logs - As the VQL query is executing on the endpoint, the query may
produce log messages. This is called the <code>Query Log</code> and it is
forwarded to the server. We are able to see how the query is
progressing based on the query log.</li></ol><p><img src=image76.png alt="Query Log"></p><ol start=2><li>Uploaded Files - This tab shows all the files uploaded by this
query. You can download any of these files from the server by
simply clicking the link.</li></ol><p><img src=image77.png alt="Uploaded Files"></p><ol start=3><li>The Result Tab - shows each result set in a table. A single
collection may collect several artifacts. In this case you can
choose which artifact to view by clicking the pull down menu.</li></ol><p><img src=image78.png alt="Result Tab"></p><h2 id=inspecting-and-modifying-artifacts>Inspecting and modifying artifacts</h2><p>The <code>View Artifacts</code> screen allows you to search and find all
artifacts loaded into Velociraptor. Search for an artifact in the
search screen and select an artifact to view.</p><p>The left pane shows the name of the artifact, a description and any
parameters the artifact may take. Finally we can inspect the VQL
source of the artifact.</p><p><img src=image72.png alt="View Artifact"></p><p>You can edit any artifact by clicking the &ldquo;Edit an Artifact&rdquo; button <i class="fas fa-pencil-alt"></i></p><p><img src=image85.png alt="Edit Artifact"></p><p>User artifacts must have the prefix “Custom.” in order to ensure that
user artifacts do not override built in artifacts. When editing an
existing artifact, Velociraptor will automatically add the Custom
prefix to the artifact name and will produce a new artifact. Therefore
both the custom and built in artifact exist in Velociraptor at the
same time. This allows you to collect either the original or the
customized version as you please.</p><h2 id=learn-more>Learn more</h2><p>To learn more about how to write your own artifacts click TODO</p><footer class=footline></footer></div></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1623693523></script><script src=/js/perfect-scrollbar.min.js?1623693523></script><script src=/js/perfect-scrollbar.jquery.min.js?1623693523></script><script src=/js/jquery.sticky.js?1623693523></script><script src=/js/featherlight.min.js?1623693523></script><script src=/js/highlight.pack.js?1623693523></script><script>hljs.initHighlightingOnLoad()</script><script src=/js/modernizr.custom-3.6.0.js?1623693523></script><script src=/js/learn.js?1623693523></script><script src=/js/hugo-learn.js?1623693523></script></body></html>