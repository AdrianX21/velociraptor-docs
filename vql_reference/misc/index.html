<!doctype html><html lang=en class="js csstransforms3d">
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=generator content="Hugo 0.88.1">
<meta name=description content>
<link rel=icon href=/images/favicon.png type=image/png>
<title>Misc :: Velociraptor - Digging deeper!</title>
<link href=/css/nucleus.css?1631260176 rel=stylesheet>
<link href=/css/fontawesome-all.min.css?1631260176 rel=stylesheet>
<link href=/css/featherlight.min.css?1631260176 rel=stylesheet>
<link href=/css/perfect-scrollbar.min.css?1631260176 rel=stylesheet>
<link href=/css/auto-complete.css?1631260176 rel=stylesheet>
<link href=/css/theme.css?1631260176 rel=stylesheet>
<link href=/css/tabs.css?1631260176 rel=stylesheet>
<link href=/css/hugo-theme.css?1631260176 rel=stylesheet>
<link href=/css/theme-mine.css?1631260176 rel=stylesheet>
<link href=/css/dark.css?1631260176 rel=stylesheet><link href=/css/syntax.css?1631260176 rel=stylesheet><link href=/css/light.css?1631260176 rel=stylesheet><link href=/css/hljs.css?1631260176 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1631260176 rel=stylesheet>
<script src=/js/jquery-3.3.1.min.js?1631260176></script>
<style>:root #header+#content>#left>#rlblock_left{display:none!important}</style>
<script></script>
</head>
<body data-url=/vql_reference/misc/>
<nav id=sidebar><div id=header-wrapper>
<div id=header>
<script>function darkmode(){$("body").addClass("dark").removeClass("light"),document.cookie="theme=darkmode;path=/"}function lightmode(){$("body").removeClass("dark").addClass("light"),document.cookie="theme=lightmode;path=/"}const regex=new RegExp('theme=darkmode');regex.test(document.cookie)?darkmode():lightmode()</script>
<div class="btn btn-default ThemeSelector darkmode" onclick=darkmode()>
<i class="fas fa-moon"></i>
</div>
<div class="btn btn-default ThemeSelector lightmode" onclick=lightmode()>
<i class="fas fa-sun"></i>
</div>
<a href=https://docs.velociraptor.app/>
<img src=https://docs.velociraptor.app//images/logo.svg>
</a>
</div>
</div>
<div class=highlightable>
<ul class=topics>
<li data-nav-id=https://docs.velociraptor.app/announcements/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/><i class="fas fa-bullhorn"></i>Announcements</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/announcements/2021-artifact-contest/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/2021-artifact-contest/>2021 Contest</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/><i class="fas fa-book-reader"></i>Documentation</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/overview/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/overview/>Velociraptor Overview</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/overview/history/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/history/>History</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/>Deployment</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/self-signed/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/self-signed/>Self-Signed SSL</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/>Cloud Deployment</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/clients/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/clients/>Deploying Clients</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/rbac/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/rbac/>Users and Roles</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/resources/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/resources/>Performance</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/troubleshooting/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/troubleshooting/>Troubleshooting</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/gui/>The Admin GUI</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/clients/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/clients/>Inspecting clients</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/vfs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/vfs/>The VFS</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/artifacts/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/artifacts/>Artifacts</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/hunting/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/hunting/>Hunting</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/vql/>VQL Fundamentals</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/notebooks/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/notebooks/>Notebooks</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/artifacts/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/artifacts/>Artifacts</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/events/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/events/>Event Queries</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/>Forensic Analysis</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/>Searching Filenames</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/searching/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/searching/>Searching Content</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/ntfs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/ntfs/>NTFS Analysis</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/evidence_of_execution/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/evidence_of_execution/>Evidence Of Execution</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/event_logs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/event_logs/>Event Logs</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/volatile/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/volatile/>Volatile State</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/offline_triage/>Triage and acquisition</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/extending_vql/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/extending_vql/>Extending VQL</a>
</div>
</li>
</ul>
</li><hr>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/ class="dd-item parent haschildren">
<div>
<i class="fa fa-angle-down fa-sm category-icon"></i>
<a href=/vql_reference/><i class="fas fa-book"></i>VQL Reference</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/basic/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/basic/>Basic VQL</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/windows/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/windows/>Windows Specific</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/parsers/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/parsers/>Parsers</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/server/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/server/>Server Side</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/plugin/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/plugin/>Client Side</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/event/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/event/>Event Plugins</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/experimental/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/experimental/>Experimental</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/misc/ class="dd-item parent active">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/misc/>Misc</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/training/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/training/><i class="fas fa-graduation-cap"></i>Training</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/blog/ class="dd-item haschildren">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/blog/><i class="fas fa-newspaper"></i>Blog</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/presentations/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/presentations/><i class="fas fa-chalkboard-teacher"></i>Presentations</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/presentations/2021_dfrws_us/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2021_dfrws_us/>DFRWS US 2021 Workshop</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/exchange/ class="dd-item haschildren">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/exchange/><i class="fas fa-code"></i>Artifact Exchange</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/search/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/search/><i class="fas fa-search"></i>Search</a>
</div>
</li>
</ul>
<hr>
<section id=shortcuts>
<h3></h3>
<ul>
<li>
<a class=padding href=https://github.com/Velocidex/velociraptor><i class="fab fa-github"></i>Github</a>
</li>
<li>
<a class=padding href=https://docs.velociraptor.app/discord/><i class="fab fa-discord"></i>Discord</a>
</li>
<li>
<a class=padding href=mailto:velociraptor-discuss@googlegroups.com><i class="fas fa-envelope"></i>Mailing List</a>
</li>
</ul>
</section>
<section id=footer>
<div class=footer-copyright>Brough to you by
<img src=/images/Rapid7_logo.svg class=rapid7>
<br> <i class="fas fa-copyright"></i> 2021
</div>
</section>
</div>
</nav>
<script>$("#sidebar i.fa-angle-right").each(function(){$(this).parent().parent().find("ul").hide()})</script>
<section id=body>
<div id=overlay></div>
<div class="padding highlightable">
<div>
<div id=top-bar>
<div id=top-github-link>
<a class=github-link title="Edit this page" href=https://github.com/scudette/velociraptor-docs/edit/master/content/vql_reference/misc/_index.md target=blank>
<i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span>
</a>
</div>
<div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb>
<span id=sidebar-toggle-span>
<a href=# id=sidebar-toggle data-sidebar-toggle>
<i class="fas fa-bars"></i>
</a>
</span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>
Misc
</span>
</div>
<div class=progress>
<div class=wrapper>
<nav id=TableOfContents>
<ul>
<li><a href=#amsi>amsi</a></li>
<li><a href=#atexit>atexit</a></li>
<li><a href=#column_filter>column_filter</a></li>
<li><a href=#gcs_pubsub_publish>gcs_pubsub_publish</a></li>
<li><a href=#geoip>geoip</a></li>
<li><a href=#import_collection>import_collection</a></li>
<li><a href=#parse_pkcs7>parse_pkcs7</a></li>
<li><a href=#parse_x509>parse_x509</a></li>
<li><a href=#parse_yaml>parse_yaml</a></li>
<li><a href=#query>query</a></li>
<li><a href=#range>range</a></li>
<li><a href=#reg_rm_key>reg_rm_key</a></li>
<li><a href=#reg_rm_value>reg_rm_value</a></li>
<li><a href=#reg_set_value>reg_set_value</a></li>
<li><a href=#relpath>relpath</a></li>
<li><a href=#rm>rm</a></li>
<li><a href=#send_event>send_event</a></li>
<li><a href=#slice>slice</a></li>
<li><a href=#sql>sql</a></li>
<li><a href=#starl>starl</a></li>
<li><a href=#substr>substr</a></li>
<li><a href=#sum>sum</a></li>
<li><a href=#timeline>timeline</a></li>
<li><a href=#timeline_add>timeline_add</a></li>
<li><a href=#unhex>unhex</a></li>
<li><a href=#unzip>unzip</a></li>
<li><a href=#upload_directory>upload_directory</a></li>
<li><a href=#user_create>user_create</a></li>
<li><a href=#user_delete>user_delete</a></li>
<li><a href=#whoami>whoami</a></li>
<li><a href=#xor>xor</a></li>
</ul>
</nav>
</div>
</div>
</div>
</div>
<div id=head-tags>
</div>
<div id=body-inner>
<h1>
Misc
</h1>
<div class="author pull-right">
<span class=date></span>
</div>
<p>Miscelanueous plugins not yet categorized.</p>
<div class=vql_item></div>
<h2 id=amsi>amsi</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>AMSI is an interface on windows to scan a string for malware. This
function submits the string to the AMSI system and receives a
determination if it is malware.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>A string to scan</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=atexit>atexit</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Install a query to run when the query is unwound. This is used to
clean up when the query ends.</p>
<p>For example:</p>
<pre><code class=language-vql>LET _ &lt;= atexit(query={
  SELECT rm(filename=&quot;Foobar.txt&quot;) FROM scope()
})
</code></pre>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>A VQL Query to parse and execute.</td>
<td>Any (required)</td>
</tr>
<tr>
<td>env</td>
<td>A dict of args to insert into the scope.</td>
<td>ordereddict.Dict</td>
</tr>
<tr>
<td>timeout</td>
<td>How long to wait for destructors to run (default 60 seconds).</td>
<td>uint64</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=column_filter>column_filter</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Select columns from another query using regex.</p>
<p>Sometimes a query produces a large number of columns or
unpredictable column names (eg. the <code>read_reg_key()</code> plugin
produces a column per value name).</p>
<p>You can use the column_filter() plugin to select a subset of the
columns to include or exclude from an underlying query. For example:</p>
<pre><code class=language-vql>SELECT * FROM column_filter(
query={
   SELECT 1 AS A, 2 AS B, 3 AS AB, 4 AS AA
   FROM scope()
}, include=&quot;A&quot;, exclude=&quot;B&quot;)
</code></pre>
<p>will include columns with the letter A in their name and remove
columns with the letter B (so it will have A and AA above).</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>This query will be run to produce the columns.</td>
<td>StoredQuery (required)</td>
</tr>
<tr>
<td>exclude</td>
<td>One of more regular expressions that will exclude columns.</td>
<td>list of string</td>
</tr>
<tr>
<td>include</td>
<td>One of more regular expressions that will include columns.</td>
<td>list of string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=gcs_pubsub_publish>gcs_pubsub_publish</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Publish a message to Google PubSub.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>topic</td>
<td>The topic to publish to</td>
<td>string (required)</td>
</tr>
<tr>
<td>project_id</td>
<td>The project id to publish to</td>
<td>string (required)</td>
</tr>
<tr>
<td>msg</td>
<td>Message to publish to Pubsub</td>
<td>Any (required)</td>
</tr>
<tr>
<td>credentials</td>
<td>The credentials to use</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=geoip>geoip</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Lookup an IP Address using the MaxMind GeoIP database. You can get
a copy of the database from <a href=https://www.maxmind.com/>https://www.maxmind.com/</a>. The database
must be locally accessible so this probably only makes sense on
the server.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>ip</td>
<td>IP Address to lookup.</td>
<td>string (required)</td>
</tr>
<tr>
<td>db</td>
<td>Path to the MaxMind GeoIP Database.</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=import_collection>import_collection</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Imports an offline collection zip file (experimental).</p>
<p>Offline collectors are preconfigure Velociraptor binaries that
collect specific artifacts into a zip file.</p>
<p>This function allows such a collection to be imported into the GUI
as if it was collected by the server. The collection will be
loaded into a client&rsquo;s filestore directory.</p>
<p>Since there is no actual client id associated with the offline
collection (there is no Velociraptor client running on the
endpoint) we generate a random client ID for a new client.</p>
<p>If you specify an existing client id, the collection will be
uploaded into that client.</p>
<p>NOTE: Combine this function with the hunt_add() function to add a
manual offline collection to an ongoing hunt.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>client_id</td>
<td>The client id to import to. Use &lsquo;auto&rsquo; to generate a new client id.</td>
<td>string (required)</td>
</tr>
<tr>
<td>hostname</td>
<td>When creating a new client, set this as the hostname.</td>
<td>string</td>
</tr>
<tr>
<td>filename</td>
<td>Path on server to the collector zip.</td>
<td>string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_pkcs7>parse_pkcs7</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Parse a DER encoded pkcs7 string into an object.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>PKCS7 DER encoded string.</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_x509>parse_x509</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Parse a DER encoded x509 string into an object.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>X509 DER encoded string.</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_yaml>parse_yaml</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Parse yaml into an object.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>Yaml Filename</td>
<td>string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>File accessor</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=query>query</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Evaluate a VQL query.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>A VQL Query to parse and execute.</td>
<td>string (required)</td>
</tr>
<tr>
<td>env</td>
<td>A dict of args to insert into the scope.</td>
<td>ordereddict.Dict</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=range>range</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Iterate over range.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>start</td>
<td>Start index (0 based)</td>
<td>int64 (required)</td>
</tr>
<tr>
<td>end</td>
<td>End index (0 based)</td>
<td>int64 (required)</td>
</tr>
<tr>
<td>step</td>
<td>End index (0 based)</td>
<td>int64 (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=reg_rm_key>reg_rm_key</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Removes a key and all its values from the registry.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>Registry key path.</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=reg_rm_value>reg_rm_value</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Removes a value in the registry.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>Registry value path.</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=reg_set_value>reg_set_value</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Set a value in the registry.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>Registry value path.</td>
<td>string (required)</td>
</tr>
<tr>
<td>value</td>
<td>Value to set</td>
<td>LazyExpr (required)</td>
</tr>
<tr>
<td>type</td>
<td>Type to set (SZ, DWORD, QWORD)</td>
<td>string (required)</td>
</tr>
<tr>
<td>create</td>
<td>Set to create missing intermediate keys</td>
<td>bool</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=relpath>relpath</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Return the relative path of .</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>Extract directory name of path</td>
<td>string (required)</td>
</tr>
<tr>
<td>base</td>
<td>The base of the path</td>
<td>string (required)</td>
</tr>
<tr>
<td>sep</td>
<td>Separator to use (default native)</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=rm>rm</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Remove a file from the filesystem using the API.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>Filename to remove.</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=send_event>send_event</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Sends an event to a server event monitoring queue.</p>
<p>This is used to send an event to a waiting server event monitoring
artifact (either as a VQL query running on the server or perhaps
an external program waiting for this event via the API.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>artifact</td>
<td>The artifact name to send the event to.</td>
<td>string (required)</td>
</tr>
<tr>
<td>row</td>
<td>The row to send to the artifact</td>
<td>ordereddict.Dict (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=slice>slice</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Slice an array.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>list</td>
<td>A list of items to slice</td>
<td>Any (required)</td>
</tr>
<tr>
<td>start</td>
<td>Start index (0 based)</td>
<td>uint64 (required)</td>
</tr>
<tr>
<td>end</td>
<td>End index (0 based)</td>
<td>uint64 (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=sql>sql</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Run queries against sqlite, mysql, and postgres databases</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>driver</td>
<td>sqlite, mysql,or postgres</td>
<td>string (required)</td>
</tr>
<tr>
<td>connstring</td>
<td>SQL Connection String</td>
<td>string</td>
</tr>
<tr>
<td>file</td>
<td>Required if using sqlite driver</td>
<td>string</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use if using sqlite</td>
<td>string</td>
</tr>
<tr>
<td>query</td>
<td></td>
<td>string (required)</td>
</tr>
<tr>
<td>args</td>
<td></td>
<td>Any</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=starl>starl</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Compile a starlark code block - returns a module usable in VQL</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>The body of the starlark code.</td>
<td>string (required)</td>
</tr>
<tr>
<td>key</td>
<td>If set use this key to cache the Starlark code block.</td>
<td>string</td>
</tr>
<tr>
<td>globals</td>
<td>Dictionary of values to feed into Starlark environment</td>
<td>Any</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=substr>substr</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Create a substring from a string</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>str</td>
<td>The string to shorten</td>
<td>string (required)</td>
</tr>
<tr>
<td>start</td>
<td>Beginning index of substring</td>
<td>int</td>
</tr>
<tr>
<td>end</td>
<td>End index of substring</td>
<td>int</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=sum>sum</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Sums the items.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>item</td>
<td></td>
<td>int64 (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=timeline>timeline</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Read a timeline. You can create a timeline with the timeline_add() function</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>timeline</td>
<td>Name of the timeline to read</td>
<td>string (required)</td>
</tr>
<tr>
<td>skip</td>
<td>List of child components to skip</td>
<td>list of string</td>
</tr>
<tr>
<td>start</td>
<td>First timestamp to fetch</td>
<td>Any</td>
</tr>
<tr>
<td>notebook_id</td>
<td>The notebook ID the timeline is stored in.</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=timeline_add>timeline_add</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Add a new query to a timeline.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>timeline</td>
<td>Supertimeline to add to</td>
<td>string (required)</td>
</tr>
<tr>
<td>name</td>
<td>Name of child timeline</td>
<td>string (required)</td>
</tr>
<tr>
<td>query</td>
<td>Run this query to generate the timeline.</td>
<td>StoredQuery (required)</td>
</tr>
<tr>
<td>key</td>
<td>The column representing the time.</td>
<td>string (required)</td>
</tr>
<tr>
<td>notebook_id</td>
<td>The notebook ID the timeline is stored in.</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=unhex>unhex</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Apply hex decoding to the string.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>Hex string to decode</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=unzip>unzip</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Unzips a file into a directory</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>File to unzip.</td>
<td>string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use</td>
<td>string</td>
</tr>
<tr>
<td>filename_filter</td>
<td>Only extract members matching this filter.</td>
<td>string</td>
</tr>
<tr>
<td>output_directory</td>
<td>Where to unzip to</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=upload_directory>upload_directory</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Upload a file to an upload directory. The final filename will be the output directory path followed by the filename path.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td>The file to upload</td>
<td>string (required)</td>
</tr>
<tr>
<td>name</td>
<td>Filename to be stored within the output directory</td>
<td>string</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use</td>
<td>string</td>
</tr>
<tr>
<td>output</td>
<td>An output directory to store files in.</td>
<td>string (required)</td>
</tr>
<tr>
<td>mtime</td>
<td>Modified time to set the output file.</td>
<td>Any</td>
</tr>
<tr>
<td>atime</td>
<td>Access time to set the output file.</td>
<td>Any</td>
</tr>
<tr>
<td>ctime</td>
<td>Change time to set the output file.</td>
<td>Any</td>
</tr>
<tr>
<td>btime</td>
<td>Birth time to set the output file.</td>
<td>Any</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=user_create>user_create</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Creates a new user from the server, or updates their permissions or reset their password.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>user</td>
<td></td>
<td>string (required)</td>
</tr>
<tr>
<td>roles</td>
<td></td>
<td>list of string (required)</td>
</tr>
<tr>
<td>password</td>
<td></td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=user_delete>user_delete</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Deletes a user from the server.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>user</td>
<td></td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=whoami>whoami</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Returns the username that is running the query.</p>
<div class=vql_item></div>
<h2 id=xor>xor</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Apply xor to the string and key.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>String to apply Xor</td>
<td>string (required)</td>
</tr>
<tr>
<td>key</td>
<td>Xor key.</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<footer class=footline>
</footer>
</div>
</div>
<div id=navigation>
</div>
</section>
<div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px>
<div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div>
</div>
<script src=/js/clipboard.min.js?1631260176></script>
<script src=/js/perfect-scrollbar.min.js?1631260176></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1631260176></script>
<script src=/js/jquery.sticky.js?1631260176></script>
<script src=/js/featherlight.min.js?1631260176></script>
<script src=/js/highlight.min.js?1631260176></script>
<script>hljs.highlightAll()</script>
<script src=/js/modernizr.custom-3.6.0.js?1631260176></script>
<script src=/js/learn.js?1631260176></script>
<script src=/js/hugo-learn.js?1631260176></script>
</body>
</html>