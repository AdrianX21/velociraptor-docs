<!doctype html><html lang=en class="js csstransforms3d">
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=generator content="Hugo 0.92.0">
<meta name=description content>
<link rel=icon href=/images/favicon.png type=image/png>
<title>Parsers :: Velociraptor - Digging deeper!</title>
<link href=/css/nucleus.css?1642472234 rel=stylesheet>
<link href=/css/fontawesome-all.min.css?1642472234 rel=stylesheet>
<link href=/css/featherlight.min.css?1642472234 rel=stylesheet>
<link href=/css/perfect-scrollbar.min.css?1642472234 rel=stylesheet>
<link href=/css/auto-complete.css?1642472234 rel=stylesheet>
<link href=/css/theme.css?1642472234 rel=stylesheet>
<link href=/css/tabs.css?1642472234 rel=stylesheet>
<link href=/css/hugo-theme.css?1642472234 rel=stylesheet>
<link href=/css/theme-mine.css?1642472234 rel=stylesheet>
<link href=/css/dark.css?1642472234 rel=stylesheet><link href=/css/syntax.css?1642472234 rel=stylesheet><link href=/css/light.css?1642472234 rel=stylesheet><link href=/css/hljs.css?1642472234 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1642472234 rel=stylesheet>
<script src=/js/jquery-3.3.1.min.js?1642472234></script>
<style>:root #header+#content>#left>#rlblock_left{display:none!important}</style>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QYH72LMYCS"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-QYH72LMYCS',{anonymize_ip:!1})}</script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','G-QYH72LMYCS','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
<script></script>
</head>
<body data-url=/vql_reference/parsers/>
<nav id=sidebar><div id=header-wrapper>
<div id=header>
<script>function darkmode(){$("body").addClass("dark").removeClass("light"),document.cookie="theme=darkmode;path=/"}function lightmode(){$("body").removeClass("dark").addClass("light"),document.cookie="theme=lightmode;path=/"}const regex=new RegExp('theme=darkmode');regex.test(document.cookie)?darkmode():lightmode()</script>
<div class="btn btn-default ThemeSelector darkmode" onclick=darkmode()>
<i class="fas fa-moon"></i>
</div>
<div class="btn btn-default ThemeSelector lightmode" onclick=lightmode()>
<i class="fas fa-sun"></i>
</div>
<a href=https://docs.velociraptor.app/>
<img src=https://docs.velociraptor.app//images/logo.svg>
</a>
</div>
</div>
<div class=highlightable>
<ul class=topics>
<li data-nav-id=https://docs.velociraptor.app/announcements/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/><i class="fas fa-bullhorn"></i>Announcements</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/announcements/2021-artifact-contest/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/2021-artifact-contest/>2021 Contest</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/><i class="fas fa-book-reader"></i>Documentation</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/overview/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/overview/>Velociraptor Overview</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/overview/history/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/history/>History</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/overview/support/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/support/>Support Policy</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/>Deployment</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/self-signed/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/self-signed/>Self-Signed SSL</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/>Cloud Deployment</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/multifrontend/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/multifrontend/>Multi-Frontend</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/clients/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/clients/>Deploying Clients</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/rbac/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/rbac/>Users and Roles</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/resources/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/resources/>Performance</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/troubleshooting/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/troubleshooting/>Troubleshooting</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/gui/>The Admin GUI</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/clients/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/clients/>Inspecting clients</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/vfs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/vfs/>The VFS</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/artifacts/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/artifacts/>Artifacts</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/hunting/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/hunting/>Hunting</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/vql/>VQL Fundamentals</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/notebooks/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/notebooks/>Notebooks</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/artifacts/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/artifacts/>Artifacts</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/events/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/events/>Event Queries</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/>Forensic Analysis</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/>Searching Filenames</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/searching/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/searching/>Searching Content</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/ntfs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/ntfs/>NTFS Analysis</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/binary/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/binary/>Binary parsing</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/evidence_of_execution/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/evidence_of_execution/>Evidence Of Execution</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/event_logs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/event_logs/>Event Logs</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/volatile/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/volatile/>Volatile State</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/offline_triage/>Triage and acquisition</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/client_monitoring/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/client_monitoring/>Client Monitoring</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/extending_vql/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/extending_vql/>Extending VQL</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/server_automation/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/server_automation/>Server Automation</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_api/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_api/>Server API</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_monitoring/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_monitoring/>Server Monitoring</a>
</div>
</li>
</ul>
</li>
</ul>
</li><hr>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/ class="dd-item parent haschildren">
<div>
<i class="fa fa-angle-down fa-sm category-icon"></i>
<a href=/vql_reference/><i class="fas fa-book"></i>VQL Reference</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/basic/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/basic/>Basic VQL</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/linux/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/linux/>Linux Specific</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/windows/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/windows/>Windows Specific</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/parsers/ class="dd-item parent active">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/parsers/>Parsers</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/server/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/server/>Server Side</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/plugin/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/plugin/>Client Side</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/event/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/event/>Event Plugins</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/experimental/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/experimental/>Experimental</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/misc/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/misc/>Misc</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/training/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/training/><i class="fas fa-graduation-cap"></i>Training</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/blog/ class="dd-item haschildren">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/blog/><i class="fas fa-newspaper"></i>Blog</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/presentations/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/presentations/><i class="fas fa-chalkboard-teacher"></i>Presentations</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/presentations/2021_auscert/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2021_auscert/>Auscert 2021</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/presentations/2021_dfrws_us/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2021_dfrws_us/>DFRWS US 2021 Workshop</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/presentations/2021_osdfc/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2021_osdfc/>OSDFC 2021</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/presentations/2021_blueteam_village/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2021_blueteam_village/>BTV 2021</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/presentations/2022_linuxconf_au/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_linuxconf_au/>Linux Conf Au 2022</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/exchange/ class="dd-item haschildren">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/exchange/><i class="fas fa-code"></i>Artifact Exchange</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/search/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/search/><i class="fas fa-search"></i>Search</a>
</div>
</li>
</ul>
<hr>
<section id=shortcuts>
<h3></h3>
<ul>
<li>
<a class=padding href=https://github.com/Velocidex/velociraptor><i class="fab fa-github"></i>Github</a>
</li>
<li>
<a class=padding href=https://docs.velociraptor.app/discord/><i class="fab fa-discord"></i>Discord</a>
</li>
<li>
<a class=padding href=mailto:velociraptor-discuss@googlegroups.com><i class="fas fa-envelope"></i>Mailing List</a>
</li>
</ul>
</section>
<section id=footer>
<div class=footer-copyright>Brought to you by
<img src=/images/Rapid7_logo.svg class=rapid7>
<br> <i class="fas fa-copyright"></i> 2021
</div>
</section>
</div>
</nav>
<script>$("#sidebar i.fa-angle-right").each(function(){$(this).parent().parent().find("ul").hide()})</script>
<section id=body>
<div id=overlay></div>
<div class="padding highlightable">
<div>
<div id=top-bar>
<div id=top-github-link>
<a class=github-link title="Edit this page" href=https://github.com/scudette/velociraptor-docs/edit/master/content/vql_reference/parsers/_index.md target=blank>
<i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span>
</a>
</div>
<div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb>
<span id=sidebar-toggle-span>
<a href=# id=sidebar-toggle data-sidebar-toggle>
<i class="fas fa-bars"></i>
</a>
</span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>
Parsers
</span>
</div>
<div class=progress>
<div class=wrapper>
<nav id=TableOfContents>
<ul>
<li><a href=#grok>grok</a></li>
<li><a href=#olevba>olevba</a></li>
<li><a href=#parse_auditd>parse_auditd</a></li>
<li><a href=#parse_binary>parse_binary</a></li>
<li><a href=#parse_csv>parse_csv</a>
<ul>
<li><a href=#example>Example</a></li>
</ul>
</li>
<li><a href=#parse_ese>parse_ese</a></li>
<li><a href=#parse_ese_catalog>parse_ese_catalog</a></li>
<li><a href=#parse_evtx>parse_evtx</a>
<ul>
<li><a href=#example-1>Example</a></li>
</ul>
</li>
<li><a href=#parse_float>parse_float</a></li>
<li><a href=#parse_json>parse_json</a></li>
<li><a href=#parse_json_array>parse_json_array</a></li>
<li><a href=#parse_json_array-1>parse_json_array</a></li>
<li><a href=#parse_jsonl>parse_jsonl</a></li>
<li><a href=#parse_lines>parse_lines</a></li>
<li><a href=#parse_mft>parse_mft</a></li>
<li><a href=#parse_ntfs>parse_ntfs</a></li>
<li><a href=#parse_ntfs_i30>parse_ntfs_i30</a></li>
<li><a href=#parse_ntfs_ranges>parse_ntfs_ranges</a></li>
<li><a href=#parse_pe>parse_pe</a></li>
<li><a href=#parse_pkcs7>parse_pkcs7</a></li>
<li><a href=#parse_records_with_regex>parse_records_with_regex</a>
<ul>
<li><a href=#example-2>Example</a></li>
</ul>
</li>
<li><a href=#parse_recyclebin>parse_recyclebin</a></li>
<li><a href=#parse_string_with_regex>parse_string_with_regex</a></li>
<li><a href=#parse_usn>parse_usn</a></li>
<li><a href=#parse_x509>parse_x509</a></li>
<li><a href=#parse_xml>parse_xml</a></li>
<li><a href=#parse_yaml>parse_yaml</a></li>
<li><a href=#plist>plist</a></li>
<li><a href=#plist-1>plist</a></li>
<li><a href=#prefetch>prefetch</a></li>
<li><a href=#regex_replace>regex_replace</a></li>
<li><a href=#rot13>rot13</a></li>
<li><a href=#split_records>split_records</a></li>
<li><a href=#sqlite>sqlite</a></li>
<li><a href=#starl>starl</a></li>
<li><a href=#example-3>Example</a></li>
<li><a href=#xor>xor</a></li>
</ul>
</nav>
</div>
</div>
</div>
</div>
<div id=head-tags>
</div>
<div id=body-inner>
<h1>
Parsers
</h1>
<p>Many Velociraptor artifacts rely on specialized parsing of file
formats. This page outlines all the plugins and functions designed
to allow the client to parse information for various files.</p>
<p>Simple file formats may be parsed using regular expressions and
other generic rules. However some specialized file formats have
dedicated parsers. These dedicated parsers are exported into VQL
plugins so their results may be used in further queries.</p>
<div class=vql_item></div>
<h2 id=grok>grok</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Parse a string using a Grok expression.</p>
<p>This is most useful for parsing syslog style logs (e.g. IIS, Apache logs).</p>
<p>You can read more about GROK expressions here
<a href=https://www.elastic.co/blog/do-you-grok-grok>https://www.elastic.co/blog/do-you-grok-grok</a></p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>grok</td>
<td>Grok pattern.</td>
<td>string (required)</td>
</tr>
<tr>
<td>data</td>
<td>String to parse.</td>
<td>string (required)</td>
</tr>
<tr>
<td>patterns</td>
<td>Additional patterns.</td>
<td>Any</td>
</tr>
<tr>
<td>all_captures</td>
<td>Extract all captures.</td>
<td>bool</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=olevba>olevba</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Extracts VBA Macros from Office documents.</p>
<p>This plugin parses the provided files as OLE documents in order to
recover VB macro code. A single document can have multiple code
objects, and each such code object is emitted as a row.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td>A list of filenames to open as OLE files.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use.</td>
<td>string</td>
</tr>
<tr>
<td>max_size</td>
<td>Maximum size of file we load into memory.</td>
<td>int64</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_auditd>parse_auditd</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Parse log files generated by auditd.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>A list of log files to parse.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use.</td>
<td>string</td>
</tr>
<tr>
<td>buffer_size</td>
<td>Maximum size of line buffer.</td>
<td>int</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_binary>parse_binary</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Parse a binary file into a data structure using a profile.</p>
<p>This plugin extract binary data from strings. It works by applying
a profile to the binary string and generating an object from
that. Profiles are a json structure describing the binary format. For
example a profile might be:</p>
<pre><code class=language-json>[
  [&quot;StructName&quot;, 10, [
     [&quot;field1&quot;, 2, &quot;unsigned int&quot;],
     [&quot;field2&quot;, 6, &quot;unsigned long long&quot;],
   ]]]
]
</code></pre>
<p>The profile is compiled and overlayed on top of the offset specified,
then the object is emitted with its required fields.</p>
<p>You can read more about profiles here <a href=https://github.com/Velocidex/vtypes>https://github.com/Velocidex/vtypes</a></p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>Binary file to open.</td>
<td>string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use</td>
<td>string</td>
</tr>
<tr>
<td>profile</td>
<td>Profile to use (see <a href=https://github.com/Velocidex/vtypes)>https://github.com/Velocidex/vtypes)</a>.</td>
<td>string</td>
</tr>
<tr>
<td>struct</td>
<td>Name of the struct in the profile to instantiate.</td>
<td>string (required)</td>
</tr>
<tr>
<td>offset</td>
<td>Start parsing from this offset</td>
<td>int64</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_csv>parse_csv</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Parses events from a CSV file.</p>
<p>Parses records from a CSV file. We expect the first row of the CSV
file to contain column names. This parser specifically supports
Velociraptor&rsquo;s own CSV dialect and so it is perfect for post
processing already existing CSV files.</p>
<p>The types of each value in each column is deduced based on
Velociraptor&rsquo;s standard encoding scheme. Therefore types are properly
preserved when read from the CSV file.</p>
<p>For example, downloading the results of a hunt in the GUI will produce
a CSV file containing artifact rows collected from all clients. We
can then use the <code>parse_csv()</code> plugin to further filter the CSV file,
or to stack using group by.</p>
<h3 id=example>Example</h3>
<p>The following stacks the result from a
<code>Windows.Applications.Chrome.Extensions</code> artifact:</p>
<pre><code class=language-sql>SELECT count(items=User) As TotalUsers, Name
FROM parse_csv(filename=&quot;All Windows.Applications.Chrome.Extensions.csv&quot;)
Order By TotalUsers
Group By Name
</code></pre>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>CSV files to open</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use</td>
<td>string</td>
</tr>
<tr>
<td>auto_headers</td>
<td>If unset the first row is headers</td>
<td>bool</td>
</tr>
<tr>
<td>separator</td>
<td>Comma separator (default &lsquo;,')</td>
<td>string</td>
</tr>
<tr>
<td>comment</td>
<td>The single character that should be considered a comment</td>
<td>string</td>
</tr>
<tr>
<td>columns</td>
<td>The columns to use</td>
<td>list of string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_ese>parse_ese</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Opens an ESE file and dump a table.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td></td>
<td>string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use.</td>
<td>string</td>
</tr>
<tr>
<td>table</td>
<td>A table name to dump</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_ese_catalog>parse_ese_catalog</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Opens an ESE file and dump the schema.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td></td>
<td>string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use.</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_evtx>parse_evtx</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Parses events from an EVTX file.</p>
<p>This plugin parses windows events from the Windows Event log files (EVTX).</p>
<p>A windows event typically contains two columns. The <code>EventData</code>
contains event specific structured data while the <code>System</code> column
contains common data for all events - including the Event ID.</p>
<p>You should probably almost always filter by one or more event ids
(using the <code>System.EventID.Value</code> field).</p>
<h3 id=example-1>Example</h3>
<pre><code class=language-sql>SELECT System.TimeCreated.SystemTime as Timestamp,
       System.EventID.Value as EventID,
       EventData.ImagePath as ImagePath,
       EventData.ServiceName as ServiceName,
       EventData.ServiceType as Type,
       System.Security.UserID as UserSID,
       EventData as _EventData,
       System as _System
FROM watch_evtx(filename=systemLogFile) WHERE EventID = 7045
</code></pre>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>A list of event log files to parse.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use.</td>
<td>string</td>
</tr>
<tr>
<td>messagedb</td>
<td>A Message database from <a href=https://github.com/Velocidex/evtx-data>https://github.com/Velocidex/evtx-data</a>.</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_float>parse_float</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Convert a string to a float.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>A string to convert to int</td>
<td>Any (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_json>parse_json</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Parse a JSON string into an object.</p>
<p>Note that when VQL dereferences fields in a dict it returns a Null for
those fields that do not exist. Thus there is no error in actually
accessing missing fields, the column will just return nil.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Json encoded string.</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_json_array>parse_json_array</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Parse a JSON string into an array.</p>
<p>This function is similar to <code>parse_json()</code> but works for a JSON list
instead of an object.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Json encoded string.</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_json_array-1>parse_json_array</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Parses events from a line oriented json file.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Json encoded string.</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_jsonl>parse_jsonl</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Parses a line oriented json file.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>JSON file to open</td>
<td>string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_lines>parse_lines</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Parse a file separated into lines.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>A list of log files to parse.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use.</td>
<td>string</td>
</tr>
<tr>
<td>buffer_size</td>
<td>Maximum size of line buffer.</td>
<td>int</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_mft>parse_mft</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Scan the $MFT from an NTFS volume.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>A list of event log files to parse.</td>
<td>string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use.</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_ntfs>parse_ntfs</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Parse an NTFS image file.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>device</td>
<td>The device file to open. This may be a full path - we will figure out the device automatically.</td>
<td>string (required)</td>
</tr>
<tr>
<td>inode</td>
<td>The MFT entry to parse in inode notation (5-144-1).</td>
<td>string</td>
</tr>
<tr>
<td>mft</td>
<td>The MFT entry to parse.</td>
<td>int64</td>
</tr>
<tr>
<td>mft_offset</td>
<td>The offset to the MFT entry to parse.</td>
<td>int64</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_ntfs_i30>parse_ntfs_i30</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Scan the $I30 stream from an NTFS MFT entry.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>device</td>
<td>The device file to open. This may be a full path - we will figure out the device automatically.</td>
<td>string (required)</td>
</tr>
<tr>
<td>inode</td>
<td>The MFT entry to parse in inode notation (5-144-1).</td>
<td>string</td>
</tr>
<tr>
<td>mft</td>
<td>The MFT entry to parse.</td>
<td>int64</td>
</tr>
<tr>
<td>mft_offset</td>
<td>The offset to the MFT entry to parse.</td>
<td>int64</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_ntfs_ranges>parse_ntfs_ranges</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Show the run ranges for an NTFS stream.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>device</td>
<td>The device file to open. This may be a full path - we will figure out the device automatically.</td>
<td>string (required)</td>
</tr>
<tr>
<td>inode</td>
<td>The MFT entry to parse in inode notation (5-144-1).</td>
<td>string</td>
</tr>
<tr>
<td>mft</td>
<td>The MFT entry to parse.</td>
<td>int64</td>
</tr>
<tr>
<td>mft_offset</td>
<td>The offset to the MFT entry to parse.</td>
<td>int64</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_pe>parse_pe</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Parse a PE file.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td>The PE file to open.</td>
<td>string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use.</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_pkcs7>parse_pkcs7</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Parse a DER encoded pkcs7 string into an object.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>PKCS7 DER encoded string.</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_records_with_regex>parse_records_with_regex</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Parses a file with a set of regexp and yields matches as records. The
file is read into a large buffer. Then each regular expression is
applied to the buffer, and all matches are emitted as rows.</p>
<p>The regular expressions are specified in the <a href=https://golang.org/pkg/regexp/syntax/>Go
syntax</a>. They are expected to
contain capture variables to name the matches extracted.</p>
<p>For example, consider a HTML file with simple links. The regular
expression might be:</p>
<pre><code>regex='&lt;a.+?href=&quot;(?P&lt;Link&gt;[^&quot;]+?)&quot;'
</code></pre>
<p>To produce rows with a column Link.</p>
<p>The aim of this plugin is to split the file into records which can be
further parsed. For example, if the file consists of multiple records,
this plugin can be used to extract each record, while
parse_string_with_regex() can be used to further split each record
into elements. This works better than trying to write a more complex
regex which tries to capture a lot of details in one pass.</p>
<h3 id=example-2>Example</h3>
<p>Here is an example of parsing the /var/lib/dpkg/status files. These
files consist of records separated by empty lines:</p>
<pre><code>Package: ubuntu-advantage-tools
Status: install ok installed
Priority: important
Section: misc
Installed-Size: 74
Maintainer: Ubuntu Developers &lt;ubuntu-devel-discuss@lists.ubuntu.com&gt;
Architecture: all
Version: 17
Conffiles:
 /etc/cron.daily/ubuntu-advantage-tools 36de53e7c2d968f951b11c64be101b91
 /etc/update-motd.d/80-esm 6ffbbf00021b4ea4255cff378c99c898
 /etc/update-motd.d/80-livepatch 1a3172ffaa815d12b58648f117ffb67e
Description: management tools for Ubuntu Advantage
 Ubuntu Advantage is the professional package of tooling, technology
 and expertise from Canonical, helping organizations around the world
 manage their Ubuntu deployments.
 .
 Subscribers to Ubuntu Advantage will find helpful tools for accessing
 services in this package.
Homepage: https://buy.ubuntu.com
</code></pre>
<p>The following query extracts the fields in two passes. The first pass
uses parse_records_with_regex() to extract records in blocks, while
using parse_string_with_regex() to further break the block into
fields.</p>
<pre><code class=language-sql>SELECT parse_string_with_regex(
   string=Record,
   regex=['Package:\\s(?P&lt;Package&gt;.+)',
     'Installed-Size:\\s(?P&lt;InstalledSize&gt;.+)',
     'Version:\\s(?P&lt;Version&gt;.+)',
     'Source:\\s(?P&lt;Source&gt;.+)',
     'Architecture:\\s(?P&lt;Architecture&gt;.+)']) as Record
   FROM parse_records_with_regex(
     file=linuxDpkgStatus,
     regex='(?sm)^(?P&lt;Record&gt;Package:.+?)\\n\\n')
</code></pre>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td>A list of files to parse.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>regex</td>
<td>A list of regex to apply to the file data.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use.</td>
<td>string</td>
</tr>
<tr>
<td>buffer_size</td>
<td>Maximum size of line buffer (default 64kb).</td>
<td>int</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_recyclebin>parse_recyclebin</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Parses a $I file found in the $Recycle.Bin</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>Files to be parsed.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use.</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_string_with_regex>parse_string_with_regex</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Parse a string with a set of regex and extract fields. Returns a dict with fields populated from all regex capture variables.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>A string to parse.</td>
<td>string (required)</td>
</tr>
<tr>
<td>regex</td>
<td>The regex to apply.</td>
<td>list of string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_usn>parse_usn</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Parse the USN journal from a device.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>device</td>
<td>The device file to open.</td>
<td>string (required)</td>
</tr>
<tr>
<td>start_offset</td>
<td>The starting offset of the first USN record to parse.</td>
<td>int64</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_x509>parse_x509</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Parse a DER encoded x509 string into an object.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>X509 DER encoded string.</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_xml>parse_xml</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Parse an XML document into a dict like object.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td>XML file to open.</td>
<td>string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=parse_yaml>parse_yaml</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Parse yaml into an object.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>Yaml Filename</td>
<td>string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>File accessor</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=plist>plist</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Parse plist file</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td>A list of files to parse.</td>
<td>string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use.</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=plist-1>plist</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Parses a plist file.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td>A list of files to parse.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use.</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=prefetch>prefetch</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Parses a prefetch file.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>A list of event log files to parse.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use.</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=regex_replace>regex_replace</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Search and replace a string with a regexp. Note you can use $1 to replace the capture string.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>source</td>
<td>The source string to replace.</td>
<td>string (required)</td>
</tr>
<tr>
<td>replace</td>
<td>The substitute string.</td>
<td>string (required)</td>
</tr>
<tr>
<td>re</td>
<td>A regex to apply</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=rot13>rot13</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Apply rot13 deobfuscation to the string.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td></td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=split_records>split_records</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Parses files by splitting lines into records.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filenames</td>
<td>Files to parse.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use</td>
<td>string</td>
</tr>
<tr>
<td>regex</td>
<td>The split regular expression (e.g. a comma)</td>
<td>string (required)</td>
</tr>
<tr>
<td>columns</td>
<td>If the first row is not the headers, this arg must provide a list of column names for each value.</td>
<td>list of string</td>
</tr>
<tr>
<td>first_row_is_headers</td>
<td>A bool indicating if we should get column names from the first row.</td>
<td>bool</td>
</tr>
<tr>
<td>count</td>
<td>Only split into this many columns if possible.</td>
<td>int</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=sqlite>sqlite</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Opens an SQLite file and run a query against it.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td></td>
<td>string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use.</td>
<td>string</td>
</tr>
<tr>
<td>query</td>
<td></td>
<td>string (required)</td>
</tr>
<tr>
<td>args</td>
<td></td>
<td>Any</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=starl>starl</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Compile a starlark code block - returns a module usable in VQL</p>
<p>Starl allows python like code to be used with VQL. This helps when
we need some small functions with more complex needs. We can use a
more powerful language to create small functions to transform
certain fields etc.</p>
<h2 id=example-3>Example</h2>
<p>In the following example we define a Starl code block and compile
it into a module. VQL code can then reference any functions
defined within it directly.</p>
<pre><code class=language-vql>LET MyCode &lt;= starl(code='''
load(&quot;math.star&quot;, &quot;math&quot;)

def Foo(X):
  return math.sin(X)

''')

SELECT MyCode.Foo(X=32)
FROM scope()
</code></pre>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>The body of the starlark code.</td>
<td>string (required)</td>
</tr>
<tr>
<td>key</td>
<td>If set use this key to cache the Starlark code block.</td>
<td>string</td>
</tr>
<tr>
<td>globals</td>
<td>Dictionary of values to feed into Starlark environment</td>
<td>Any</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=xor>xor</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Apply xor to the string and key.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>String to apply Xor</td>
<td>string (required)</td>
</tr>
<tr>
<td>key</td>
<td>Xor key.</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<footer class=footline>
</footer>
</div>
</div>
<div id=navigation>
</div>
</section>
<div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px>
<div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div>
</div>
<script src=/js/clipboard.min.js?1642472234></script>
<script src=/js/perfect-scrollbar.min.js?1642472234></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1642472234></script>
<script src=/js/jquery.sticky.js?1642472234></script>
<script src=/js/featherlight.min.js?1642472234></script>
<script src=/js/highlight.min.js?1642472234></script>
<script>hljs.highlightAll()</script>
<script src=/js/modernizr.custom-3.6.0.js?1642472234></script>
<script src=/js/learn.js?1642472234></script>
<script src=/js/hugo-learn.js?1642472234></script>
</body>
</html>