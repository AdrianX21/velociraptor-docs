<!doctype html><html lang=en class="js csstransforms3d">
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=generator content="Hugo 0.88.1">
<meta name=description content>
<link rel=icon href=/images/favicon.png type=image/png>
<title>Client Side :: Velociraptor - Digging deeper!</title>
<link href=/css/nucleus.css?1632189728 rel=stylesheet>
<link href=/css/fontawesome-all.min.css?1632189728 rel=stylesheet>
<link href=/css/featherlight.min.css?1632189728 rel=stylesheet>
<link href=/css/perfect-scrollbar.min.css?1632189728 rel=stylesheet>
<link href=/css/auto-complete.css?1632189728 rel=stylesheet>
<link href=/css/theme.css?1632189728 rel=stylesheet>
<link href=/css/tabs.css?1632189728 rel=stylesheet>
<link href=/css/hugo-theme.css?1632189728 rel=stylesheet>
<link href=/css/theme-mine.css?1632189728 rel=stylesheet>
<link href=/css/dark.css?1632189728 rel=stylesheet><link href=/css/syntax.css?1632189728 rel=stylesheet><link href=/css/light.css?1632189728 rel=stylesheet><link href=/css/hljs.css?1632189728 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1632189728 rel=stylesheet>
<script src=/js/jquery-3.3.1.min.js?1632189728></script>
<style>:root #header+#content>#left>#rlblock_left{display:none!important}</style>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QYH72LMYCS"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-QYH72LMYCS',{anonymize_ip:!1})}</script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','G-QYH72LMYCS','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
<script></script>
</head>
<body data-url=/vql_reference/plugin/>
<nav id=sidebar><div id=header-wrapper>
<div id=header>
<script>function darkmode(){$("body").addClass("dark").removeClass("light"),document.cookie="theme=darkmode;path=/"}function lightmode(){$("body").removeClass("dark").addClass("light"),document.cookie="theme=lightmode;path=/"}const regex=new RegExp('theme=darkmode');regex.test(document.cookie)?darkmode():lightmode()</script>
<div class="btn btn-default ThemeSelector darkmode" onclick=darkmode()>
<i class="fas fa-moon"></i>
</div>
<div class="btn btn-default ThemeSelector lightmode" onclick=lightmode()>
<i class="fas fa-sun"></i>
</div>
<a href=https://docs.velociraptor.app/>
<img src=https://docs.velociraptor.app//images/logo.svg>
</a>
</div>
</div>
<div class=highlightable>
<ul class=topics>
<li data-nav-id=https://docs.velociraptor.app/announcements/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/><i class="fas fa-bullhorn"></i>Announcements</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/announcements/2021-artifact-contest/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/2021-artifact-contest/>2021 Contest</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/><i class="fas fa-book-reader"></i>Documentation</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/overview/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/overview/>Velociraptor Overview</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/overview/history/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/history/>History</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/>Deployment</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/self-signed/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/self-signed/>Self-Signed SSL</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/>Cloud Deployment</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/clients/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/clients/>Deploying Clients</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/rbac/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/rbac/>Users and Roles</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/resources/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/resources/>Performance</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/troubleshooting/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/troubleshooting/>Troubleshooting</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/gui/>The Admin GUI</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/clients/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/clients/>Inspecting clients</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/vfs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/vfs/>The VFS</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/artifacts/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/artifacts/>Artifacts</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/hunting/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/hunting/>Hunting</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/vql/>VQL Fundamentals</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/notebooks/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/notebooks/>Notebooks</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/artifacts/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/artifacts/>Artifacts</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/events/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/events/>Event Queries</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/>Forensic Analysis</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/>Searching Filenames</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/searching/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/searching/>Searching Content</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/ntfs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/ntfs/>NTFS Analysis</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/evidence_of_execution/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/evidence_of_execution/>Evidence Of Execution</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/event_logs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/event_logs/>Event Logs</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/volatile/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/volatile/>Volatile State</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/offline_triage/>Triage and acquisition</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/extending_vql/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/extending_vql/>Extending VQL</a>
</div>
</li>
</ul>
</li><hr>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/ class="dd-item parent haschildren">
<div>
<i class="fa fa-angle-down fa-sm category-icon"></i>
<a href=/vql_reference/><i class="fas fa-book"></i>VQL Reference</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/basic/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/basic/>Basic VQL</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/windows/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/windows/>Windows Specific</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/parsers/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/parsers/>Parsers</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/server/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/server/>Server Side</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/plugin/ class="dd-item parent active">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/plugin/>Client Side</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/event/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/event/>Event Plugins</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/experimental/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/experimental/>Experimental</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/misc/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/misc/>Misc</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/training/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/training/><i class="fas fa-graduation-cap"></i>Training</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/blog/ class="dd-item haschildren">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/blog/><i class="fas fa-newspaper"></i>Blog</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/presentations/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/presentations/><i class="fas fa-chalkboard-teacher"></i>Presentations</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/presentations/2021_dfrws_us/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2021_dfrws_us/>DFRWS US 2021 Workshop</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/exchange/ class="dd-item haschildren">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/exchange/><i class="fas fa-code"></i>Artifact Exchange</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/search/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/search/><i class="fas fa-search"></i>Search</a>
</div>
</li>
</ul>
<hr>
<section id=shortcuts>
<h3></h3>
<ul>
<li>
<a class=padding href=https://github.com/Velocidex/velociraptor><i class="fab fa-github"></i>Github</a>
</li>
<li>
<a class=padding href=https://docs.velociraptor.app/discord/><i class="fab fa-discord"></i>Discord</a>
</li>
<li>
<a class=padding href=mailto:velociraptor-discuss@googlegroups.com><i class="fas fa-envelope"></i>Mailing List</a>
</li>
</ul>
</section>
<section id=footer>
<div class=footer-copyright>Brough to you by
<img src=/images/Rapid7_logo.svg class=rapid7>
<br> <i class="fas fa-copyright"></i> 2021
</div>
</section>
</div>
</nav>
<script>$("#sidebar i.fa-angle-right").each(function(){$(this).parent().parent().find("ul").hide()})</script>
<section id=body>
<div id=overlay></div>
<div class="padding highlightable">
<div>
<div id=top-bar>
<div id=top-github-link>
<a class=github-link title="Edit this page" href=https://github.com/scudette/velociraptor-docs/edit/master/content/vql_reference/plugin/_index.md target=blank>
<i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span>
</a>
</div>
<div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb>
<span id=sidebar-toggle-span>
<a href=# id=sidebar-toggle data-sidebar-toggle>
<i class="fas fa-bars"></i>
</a>
</span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>
Client Side
</span>
</div>
<div class=progress>
<div class=wrapper>
<nav id=TableOfContents>
<ul>
<li><a href=#chain>chain</a>
<ul>
<li><a href=#example>Example</a></li>
</ul>
</li>
<li><a href=#collect>collect</a></li>
<li><a href=#environ>environ</a></li>
<li><a href=#execve>execve</a></li>
<li><a href=#filesystems>filesystems</a></li>
<li><a href=#flatten>flatten</a></li>
<li><a href=#for>for</a></li>
<li><a href=#foreach>foreach</a></li>
<li><a href=#glob>glob</a>
<ul>
<li><a href=#example-1>Example</a></li>
<li><a href=#the-root-parameter>The root parameter</a></li>
</ul>
</li>
<li><a href=#grep>grep</a></li>
<li><a href=#hash>hash</a></li>
<li><a href=#http_client>http_client</a>
<ul>
<li><a href=#example-2>Example</a></li>
</ul>
</li>
<li><a href=#if>if</a></li>
<li><a href=#info>info</a></li>
<li><a href=#int>int</a></li>
<li><a href=#ip>ip</a></li>
<li><a href=#js_get>js_get</a></li>
<li><a href=#js_set>js_set</a></li>
<li><a href=#pslist>pslist</a></li>
<li><a href=#read_file>read_file</a></li>
<li><a href=#scope>scope</a>
<ul>
<li><a href=#example-3>Example</a></li>
</ul>
</li>
<li><a href=#stat>stat</a></li>
<li><a href=#switch>switch</a></li>
<li><a href=#tempfile>tempfile</a></li>
<li><a href=#upload>upload</a></li>
<li><a href=#upload-1>upload</a></li>
<li><a href=#upload_gcs>upload_gcs</a></li>
<li><a href=#upload_s3>upload_s3</a></li>
<li><a href=#write_csv>write_csv</a></li>
<li><a href=#yara>yara</a>
<ul>
<li><a href=#shorthand-rules>Shorthand rules</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
</div>
<div id=head-tags>
</div>
<div id=body-inner>
<h1>
Client Side
</h1>
<div class="author pull-right">
<span class=date></span>
</div>
<p>This page lists the plugins used to collect information from
clients.</p>
<p>VQL plugins are the data sources of VQL queries. While SQL queries
refer to static tables of data, VQL queries refer to plugins, which
generate data rows to be filtered by the query.</p>
<p>Unlike SQL, VQL plugins also receive keyword arguments. When the
plugin is evaluated it simply generates a sequence of rows which are
further filtered by the query.</p>
<p>This allows VQL statements to be chained naturally since plugin args
may also be other queries.</p>
<div class="mynotices note">
<div heading=note><p>VQL plugins are not the same as VQL functions. A plugin is the subject
of the VQL query - i.e. plugins always follow the <code>FROM</code> keyword,
while functions (which return a single value instead of a sequence of
rows) are only present in column specification (e.g. after <code>SELECT</code>)
or in condition clauses (i.e. after the <code>WHERE</code> keyword).</p>
</div>
</div>
<div class=vql_item></div>
<h2 id=chain>chain</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Chain the output of several queries into the same table.</p>
<p>This plugin takes a number of queries and joins their output into
the same table.</p>
<p>You can provide the <code>async=TRUE</code> parameter to run the queries in
parallel. This is needed when queries are event queries that never
terminate. You can use this property to collect the output from
multiple event plugins into the same artifact output.</p>
<h3 id=example>Example</h3>
<p>The following returns the rows from the first query then the rows from
the second query.</p>
<pre><code class=language-sql>SELECT * FROM chain(
  a={ SELECT ...},
  b={ SELECT ...},
  async=TRUE)
</code></pre>
<div class=vql_item></div>
<h2 id=collect>collect</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Collect artifacts into a local file.</p>
<p>This plugin is essentially the same as the <code>velociraptor artifacts collect --output file.zip</code> command. It will collect the artifacts
into a zip file.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>artifacts</td>
<td>A list of artifacts to collect.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>output</td>
<td>A path to write the output file on.</td>
<td>string</td>
</tr>
<tr>
<td>report</td>
<td>A path to write the report on.</td>
<td>string</td>
</tr>
<tr>
<td>args</td>
<td>Optional parameters.</td>
<td>Any</td>
</tr>
<tr>
<td>password</td>
<td>An optional password to encrypt the collection zip.</td>
<td>string</td>
</tr>
<tr>
<td>format</td>
<td>Output format (csv, jsonl).</td>
<td>string</td>
</tr>
<tr>
<td>artifact_definitions</td>
<td>Optional additional custom artifacts.</td>
<td>Any</td>
</tr>
<tr>
<td>template</td>
<td>The name of a template artifact (i.e. one which has report of type HTML).</td>
<td>string</td>
</tr>
<tr>
<td>level</td>
<td>Compression level between 0 (no compression) and 9.</td>
<td>int64</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=environ>environ</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>The row returned will have all environment variables as
columns. If the var parameter is provided, only those variables
will be provided.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>vars</td>
<td>Extract these variables from the environment and return them one per row</td>
<td>list of string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=execve>execve</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>This plugin launches an external command and captures its STDERR,
STDOUT and return code. The command&rsquo;s stdout is split using the <code>sep</code>
parameter as required.</p>
<p>This plugin is mostly useful for running arbitrary code on the
client. If you do not want to allow arbitrary code to run, you can
disable this by setting the <code>prevent_execve</code> flag in the client&rsquo;s
config file. Be aware than many artifacts require running external
commands to collect their output though.</p>
<p>We do not actually transfer the external program to the system
automatically. If you need to run programs which are not usually
installed (e.g. Sysinternal&rsquo;s autoruns.exe) you will need to use
Velociraptor&rsquo;s external tools feature to deliver and manage the
tools on the client.</p>
<p><a href=https://docs.velociraptor.app/docs/extending_vql/#using-external-tools>https://docs.velociraptor.app/docs/extending_vql/#using-external-tools</a></p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>argv</td>
<td>Argv to run the command with.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>sep</td>
<td>The serparator that will be used to split the stdout into rows.</td>
<td>string</td>
</tr>
<tr>
<td>length</td>
<td>Size of buffer to capture output per row.</td>
<td>int64</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=filesystems>filesystems</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Enumerates mounted filesystems.</p>
<div class=vql_item></div>
<h2 id=flatten>flatten</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Flatten the columns in query. If any column repeats then we repeat the entire row once for each item.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td></td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=for>for</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Iterate over a list.</p>
<p>DEPRECATED - use foreach() instead.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>var</td>
<td>The variable to assign.</td>
<td>string (required)</td>
</tr>
<tr>
<td>foreach</td>
<td>The variable to iterate over.</td>
<td>StoredQuery (required)</td>
</tr>
<tr>
<td>query</td>
<td>Run this query over the item.</td>
<td>StoredQuery</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=foreach>foreach</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Executes &lsquo;query&rsquo; once for each row in the &lsquo;row&rsquo; query.</p>
<p>The columns in row will be stored in the scope that is used to
evaluate the query therefore the query may refer to the results
from the <code>row</code> query.</p>
<p>Foreach in VQL is essentially the same as an SQL JOIN operator but
much simpler to use.</p>
<p>If the <code>workers</code> parameter is specified, the plugin will spawn
this many workers and evaluate the <code>query</code> query in each worker
concurrently if possible. It is safe to use a large number here
(say 100) to utilize all available cores.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>row</td>
<td>A query or slice which generates rows.</td>
<td>LazyExpr (required)</td>
</tr>
<tr>
<td>query</td>
<td>Run this query for each row.</td>
<td>StoredQuery</td>
</tr>
<tr>
<td>async</td>
<td>If set we run all queries asyncronously (implies workers=1000).</td>
<td>bool</td>
</tr>
<tr>
<td>workers</td>
<td>Total number of asyncronous workers.</td>
<td>int64</td>
</tr>
<tr>
<td>column</td>
<td>If set we only extract the column from row.</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=glob>glob</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Retrieve files based on a list of glob expressions</p>
<p>The <code>glob()</code> plugin is one of the most used plugins. It applies a glob
expression in order to search for files by file name. The glob
expression allows for wildcards, alternatives and character
classes. Globs support both forward and backslashes as path
separators. They also support quoting to delimit components.</p>
<p>A glob expression consists of a sequence of components separated by
path separators. If a separator is included within a component it is
possible to quote the component to keep it together. For example, the
windows registry contains keys with forward slash in their
names. Therefore we may use these to prevent the glob from getting
confused:</p>
<pre><code>HKEY_LOCAL_MACHINE\Microsoft\Windows\&quot;Some Key With http://www.microsoft.com/&quot;\Some Value
</code></pre>
<p>Glob expressions are case insensitive and may contain the following wild cards:</p>
<ul>
<li>The <code>*</code> matches one or more characters.</li>
<li>The <code>?</code> matches a single character.</li>
<li>Alternatives are denoted by braces and comma delimited: <code>{a,b}</code></li>
<li>Recursive search is denoted by a <code>**</code>. By default this searches 3 directories deep. If you need to increase it you can add a depth number (e.g. <code>**10</code>)</li>
</ul>
<p>By default globs do not expand environment variables. If you need to
expand environment variables use the <code>expand()</code> function explicitly:</p>
<pre><code class=language-sql>glob(globs=expand(string=&quot;%SystemRoot%\System32\Winevt\Logs\*&quot;))
</code></pre>
<h3 id=example-1>Example</h3>
<p>The following searches the raw NTFS disk for event logs.</p>
<pre><code class=language-sql>SELECT FullPath FROM glob(
globs=&quot;C:\Windows\System32\Winevt\Logs\*.evtx&quot;,
accessor=&quot;ntfs&quot;)
</code></pre>
<h3 id=the-root-parameter>The root parameter</h3>
<p>If the root parameter is specified, we start globbing from this
directory - i.e. the glob pattern is appended to the root
parameter. The <code>root</code> parameter is useful if the directory name
itself may contain glob characters.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>globs</td>
<td>One or more glob patterns to apply to the filesystem.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>root</td>
<td>The root directory to glob from (default &lsquo;').</td>
<td>string</td>
</tr>
<tr>
<td>accessor</td>
<td>An accessor to use.</td>
<td>string</td>
</tr>
<tr>
<td>nosymlink</td>
<td>If set we do not follow symlinks.</td>
<td>bool</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=grep>grep</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Search a file for keywords.</p>
<p>DEPRECATED: Use <code>yara()</code> instead.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>path to open.</td>
<td>string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>An accessor to use.</td>
<td>string</td>
</tr>
<tr>
<td>keywords</td>
<td>Keywords to search for.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>context</td>
<td>Extract this many bytes as context around hits.</td>
<td>int</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=hash>hash</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Calculate the hash of a file.</p>
<p>This function calculates the MD5, SHA1 and SHA256 hashes of the file.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>Path to open and hash.</td>
<td>string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=http_client>http_client</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Make a http request.</p>
<p>This plugin makes a HTTP connection using the specified method. The
headers and parameters may be specified. The plugin reads the
specified number of bytes per returned row.</p>
<p>If <code>disable_ssl_security</code> is specified we do not enforce SSL
integrity. This is required to connect to self signed ssl web
sites. For example many API handlers are exposed over such
connections.</p>
<div class="mynotices note">
<div heading=note><p>When connecting to the Velociraptor frontend itself, even in self
signed mode, we will ensure certs are properly verified. You can
therefore safely export files from the Frontend&rsquo;s public directory
over self signed SSL. When connecting to a self signed Velociraptor
frontend, we ensure the self signed certificate was issued by the
Velociraptor internal CA - i.e. we pin the Frontend&rsquo;s certificate in
the binary.</p>
</div>
</div>
<p>The <code>http_client()</code> plugin allows use to interact with any web
services. If the web service returns a json blob, we can parse it with
the <code>parse_json()</code> function (or <code>parse_xml()</code> for SOAP
endpoints). Using the parameters with a POST method we may actually
invoke actions from within VQL (e.g. send an SMS via an SMS gateway
when a VQL event is received).So this is a very powerful plugin.</p>
<p>When the <code>tempfile_extension</code> parameter is provided, the HTTP
request body will be written to a tempfile with that
extension. The name of this tempfile will be emitted as the
Content column.</p>
<p>This plugin will emit rows with the following columns:</p>
<ul>
<li>Url string: The url we fetched.</li>
<li>Content string: The body content for this chunk</li>
<li>Response int: The HTTP response code (200=success)</li>
</ul>
<h3 id=example-2>Example</h3>
<p>The following VQL returns the client&rsquo;s external IP as seen by the
externalip service.</p>
<pre><code class=language-sql>SELECT Content as IP from http_client(url='http://www.myexternalip.com/raw')
</code></pre>
<p>You can use this plugin to download file contents by passing the
<code>tempfile_extension</code> parameter. In this case this plugin will
create a new temp file with the speicfied extension, write the
content of the HTTP request into it and then emit a row with
<code>Content</code> being the name of the file. The file will be
automatically removed when the query ends.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>url</td>
<td>The URL to fetch</td>
<td>string (required)</td>
</tr>
<tr>
<td>params</td>
<td>Parameters to encode as POST or GET query strings</td>
<td>Any</td>
</tr>
<tr>
<td>headers</td>
<td>A dict of headers to send.</td>
<td>Any</td>
</tr>
<tr>
<td>method</td>
<td>HTTP method to use (GET, POST)</td>
<td>string</td>
</tr>
<tr>
<td>data</td>
<td>If specified we write this raw data into a POST request instead of encoding the params above.</td>
<td>string</td>
</tr>
<tr>
<td>chunk_size</td>
<td>Read input with this chunk size and send each chunk as a row</td>
<td>int</td>
</tr>
<tr>
<td>disable_ssl_security</td>
<td>Disable ssl certificate verifications.</td>
<td>bool</td>
</tr>
<tr>
<td>tempfile_extension</td>
<td>If specified we write to a tempfile. The content field will contain the full path to the tempfile.</td>
<td>string</td>
</tr>
<tr>
<td>remove_last</td>
<td>If set we delay removal as much as possible.</td>
<td>bool</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=if>if</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Conditional execution of query</p>
<p>This function evaluates a condition. Note that the values used in the
<code>then</code> or <code>else</code> clause are evaluated lazily. They may be expressions
that involve stored queries (i.e. queries stored using the <code>LET</code>
keyword). These queries will not be evaluated if they are not needed.</p>
<p>This allows a query to cheaply branch. For example, if a parameter is
given, then perform hash or upload to the server. See the
<code>Windows.Search.FileFinder</code> for an example of how <code>if()</code> is used.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>condition</td>
<td></td>
<td>Any (required)</td>
</tr>
<tr>
<td>then</td>
<td></td>
<td>StoredQuery (required)</td>
</tr>
<tr>
<td>else</td>
<td></td>
<td>StoredQuery</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=info>info</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Get information about the running host.</p>
<p>This plugin returns a single row with information about the current
system. The information includes the Hostname, Uptime, OS, Platform
etc.</p>
<p>This plugin is very useful in preconditions as it restricts a query to
certain OS or versions.</p>
<div class=vql_item></div>
<h2 id=int>int</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Truncate to an integer.</p>
<p>If provided a string, the function will try to parse it into an integer.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>int</td>
<td>The integer to round</td>
<td>Any</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=ip>ip</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Format an IP address.</p>
<p>Converts an ip address encoded in various ways. If the IP address is
encoded as 32 bit integer we can use netaddr4_le or netaddr4_be to
print it in a human readable way.</p>
<p>This currently does not support IPv6 addresses. Those are usually
encoded as an array of 8 bytes which makes it easy to format using the
<code>format()</code> function:</p>
<pre><code>  format(format=&quot;%x:%x:%x:%x:%x:%x:%x:%x&quot;, value)
</code></pre>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>netaddr4_le</td>
<td>A network order IPv4 address (as little endian).</td>
<td>int64</td>
</tr>
<tr>
<td>netaddr4_be</td>
<td>A network order IPv4 address (as big endian).</td>
<td>int64</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=js_get>js_get</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Get a variable&rsquo;s value from the JS VM.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>var</td>
<td>The variable to get from the JS VM.</td>
<td>string (required)</td>
</tr>
<tr>
<td>key</td>
<td>If set use this key to cache the JS VM.</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=js_set>js_set</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Set a variables value in the JS VM.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>var</td>
<td>The variable to set inside the JS VM.</td>
<td>string (required)</td>
</tr>
<tr>
<td>value</td>
<td>The value to set inside the VM.</td>
<td>Any (required)</td>
</tr>
<tr>
<td>key</td>
<td>If set use this key to cache the JS VM.</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=pslist>pslist</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Enumerate running processes.</p>
<p>When specifying the pid this operation is much faster so if you are
interested in specific processes, the pid should be
specified. Otherwise, the plugin returns all processes one on each
row.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>pid</td>
<td>A pid to list. If this is provided we are able to operate much faster by only opening a single process.</td>
<td>int64</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=read_file>read_file</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Read files in chunks.</p>
<p>This plugin reads a file in chunks and returns each chunks as a separate row.</p>
<p>It is useful when we want to report file contents for small files like
configuration files etc.</p>
<p>The returned row contains the following columns: data, offset, filename</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>chunk</td>
<td>length of each chunk to read from the file.</td>
<td>int</td>
</tr>
<tr>
<td>max_length</td>
<td>Max length of the file to read.</td>
<td>int</td>
</tr>
<tr>
<td>filenames</td>
<td>One or more files to open.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>An accessor to use.</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=scope>scope</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>The scope plugin returns the current scope as a single row.</p>
<p>The main use for this plugin is as a NOOP plugin in those cases we
dont want to actually run anything.</p>
<h3 id=example-3>Example</h3>
<pre><code class=language-vql>SELECT 1+1 As Two FROM scope()
</code></pre>
<div class=vql_item></div>
<h2 id=stat>stat</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Get file information. Unlike glob() this does not support wildcards.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>One or more files to open.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>An accessor to use.</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=switch>switch</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Executes each query. The first query to return any rows will be emitted.</p>
<div class=vql_item></div>
<h2 id=tempfile>tempfile</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Create a temporary file and write some data into it.</p>
<p>The file will be automatically removed when the query completes.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>Data to write in the tempfile.</td>
<td>list of string</td>
</tr>
<tr>
<td>extension</td>
<td>An extension to place in the tempfile.</td>
<td>string</td>
</tr>
<tr>
<td>permissions</td>
<td>Required permissions (e.g. &lsquo;x&rsquo;).</td>
<td>string</td>
</tr>
<tr>
<td>remove_last</td>
<td>If set we delay removal as much as possible.</td>
<td>bool</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=upload>upload</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Upload a file to the upload service. For a Velociraptor client this
will upload the file into the flow and store it in the server&rsquo;s file store.</p>
<p>If Velociraptor is run locally the file will be copied to the
<code>--dump_dir</code> path or added to the triage evidence container.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td>The file to upload</td>
<td>string (required)</td>
</tr>
<tr>
<td>name</td>
<td>The name of the file that should be stored on the server</td>
<td>string</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use</td>
<td>string</td>
</tr>
<tr>
<td>mtime</td>
<td>Modified time to record</td>
<td>Any</td>
</tr>
<tr>
<td>atime</td>
<td>Access time to record</td>
<td>Any</td>
</tr>
<tr>
<td>ctime</td>
<td>Change time to record</td>
<td>Any</td>
</tr>
<tr>
<td>btime</td>
<td>Birth time to record</td>
<td>Any</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=upload-1>upload</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Upload files to the server.</p>
<p>This plugin uploads the specified file to the server. If Velociraptor
is run locally the file will be copied to the <code>--dump_dir</code> path or
added to the triage evidence container.</p>
<p>This functionality is also available using the upload() function which
might be somewhat easier to use.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>files</td>
<td>A list of files to upload</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use</td>
<td>string</td>
</tr>
<tr>
<td>mtime</td>
<td>Modified time to record</td>
<td>Any</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=upload_gcs>upload_gcs</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Upload files to GCS.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td>The file to upload</td>
<td>string (required)</td>
</tr>
<tr>
<td>name</td>
<td>The name of the file that should be stored on the server</td>
<td>string</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use</td>
<td>string</td>
</tr>
<tr>
<td>bucket</td>
<td>The bucket to upload to</td>
<td>string (required)</td>
</tr>
<tr>
<td>project</td>
<td>The project to upload to</td>
<td>string (required)</td>
</tr>
<tr>
<td>credentials</td>
<td>The credentials to use</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=upload_s3>upload_s3</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Upload files to S3.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td>The file to upload</td>
<td>string (required)</td>
</tr>
<tr>
<td>name</td>
<td>The name of the file that should be stored on the server</td>
<td>string</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use</td>
<td>string</td>
</tr>
<tr>
<td>bucket</td>
<td>The bucket to upload to</td>
<td>string (required)</td>
</tr>
<tr>
<td>region</td>
<td>The region the bucket is in</td>
<td>string (required)</td>
</tr>
<tr>
<td>credentialskey</td>
<td>The AWS key credentials to use</td>
<td>string (required)</td>
</tr>
<tr>
<td>credentialssecret</td>
<td>The AWS secret credentials to use</td>
<td>string (required)</td>
</tr>
<tr>
<td>endpoint</td>
<td>The Endpoint to use</td>
<td>string</td>
</tr>
<tr>
<td>serversideencryption</td>
<td>The server side encryption method to use</td>
<td>string</td>
</tr>
<tr>
<td>noverifycert</td>
<td>Skip TLS Verification</td>
<td>bool</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=write_csv>write_csv</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Write a query into a CSV file.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>CSV files to open</td>
<td>string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use</td>
<td>string</td>
</tr>
<tr>
<td>query</td>
<td>query to write into the file.</td>
<td>StoredQuery (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=yara>yara</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Scan files using yara rules.</p>
<p>The <code>yara()</code> plugin applies a signature consisting of multiple rules
across files. You can read more about <a href=https://yara.readthedocs.io/en/v3.4.0/writingrules.html>yara rules</a>. The
accessor is used to open the various files which allows this plugin to
work across raw ntfs, zip members or indeed process memory.</p>
<p>Scanning proceeds by reading a block from the file, then applying the
yara rule on the block. This will fail if the signature is split
across block boundary. You can choose the block size to be
appropriate.</p>
<p>If the accessor is <strong>not</strong> specified we use the yara library to
directly open the file itself without Velociraptor&rsquo;s accessor
API. This allows Yara to mmap the file which has a number of
benefits including:</p>
<ol>
<li>
<p>The ability to scan without reading in blocks - so a
signature matching the file header as well as a string deep
within the file works.</p>
</li>
<li>
<p>Various Yara extensions like the <code>pe</code> extension work allowing
rules that use such extensions to work properly.</p>
</li>
</ol>
<p>If we are not able to open the file (for example due to sharing
violations), Velociraptor will automatically fall back to the ntfs
accessor (on Windows) and will automatically switch to block by
block scanning.</p>
<p>Typically the yara rule does not change for the life of the query,
so Velociraptor caches it to avoid having to recompile it each
time. The <code>key</code> variable can be used to uniquely identify the
cache key for the rule. If the <code>key</code> variable is not specified, we
use the rule text itself to generate the cache key. It is
recommended that the <code>key</code> parameter be specified because it makes
it more efficient since we do not need to hash the rules each time.</p>
<h3 id=shorthand-rules>Shorthand rules</h3>
<p>This plugin accepts yara rules in the <code>rules</code> parameter. But typically
we only search for keywords so writing a full yara syntax rule is
tedious. Therefore we provide a shorthand way to specify the
keywords. For example:</p>
<pre><code>wide nocase:foo,bar,baz
</code></pre>
<p>When the rule is provided in the above form, the plugin will
automatically generate a yara rule which matches any of the specified
keywords. The specification before the <code>:</code> means the same thing as the
yara DSL and the following combinations are supported <code>wide</code>, <code>wide ascii</code>, <code>wide nocase</code>, <code>wide nocase ascii</code>.</p>
<div class="mynotices note">
<div heading=note><p>By default only the first 100mb of the file are scanned and
scanning stops after one hit is found.</p>
</div>
</div>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>rules</td>
<td>Yara rules in the yara DSL.</td>
<td>string (required)</td>
</tr>
<tr>
<td>files</td>
<td>The list of files to scan.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>Accessor (e.g. NTFS)</td>
<td>string</td>
</tr>
<tr>
<td>context</td>
<td>How many bytes to include around each hit</td>
<td>int</td>
</tr>
<tr>
<td>start</td>
<td>The start offset to scan</td>
<td>uint64</td>
</tr>
<tr>
<td>end</td>
<td>End scanning at this offset (100mb)</td>
<td>uint64</td>
</tr>
<tr>
<td>number</td>
<td>Stop after this many hits (1).</td>
<td>int64</td>
</tr>
<tr>
<td>blocksize</td>
<td>Blocksize for scanning (1mb).</td>
<td>uint64</td>
</tr>
<tr>
<td>key</td>
<td>If set use this key to cache the yara rules.</td>
<td>string</td>
</tr>
</tbody>
</table>
<footer class=footline>
</footer>
</div>
</div>
<div id=navigation>
</div>
</section>
<div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px>
<div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div>
</div>
<script src=/js/clipboard.min.js?1632189728></script>
<script src=/js/perfect-scrollbar.min.js?1632189728></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1632189728></script>
<script src=/js/jquery.sticky.js?1632189728></script>
<script src=/js/featherlight.min.js?1632189728></script>
<script src=/js/highlight.min.js?1632189728></script>
<script>hljs.highlightAll()</script>
<script src=/js/modernizr.custom-3.6.0.js?1632189728></script>
<script src=/js/learn.js?1632189728></script>
<script src=/js/hugo-learn.js?1632189728></script>
</body>
</html>