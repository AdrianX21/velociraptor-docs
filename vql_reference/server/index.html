<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.83.1"><meta name=description content><link rel=icon href=/images/favicon.png type=image/png><title>Server Side Functionality :: Velociraptor - Digging deeper!</title><link href=/css/nucleus.css?1623743079 rel=stylesheet><link href=/css/fontawesome-all.min.css?1623743079 rel=stylesheet><link href=/css/hybrid.css?1623743079 rel=stylesheet><link href=/css/featherlight.min.css?1623743079 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1623743079 rel=stylesheet><link href=/css/auto-complete.css?1623743079 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1623743079 rel=stylesheet><link href=/css/theme.css?1623743079 rel=stylesheet><link href=/css/tabs.css?1623743079 rel=stylesheet><link href=/css/hugo-theme.css?1623743079 rel=stylesheet><link href=/css/theme-mine.css?1623743079 rel=stylesheet><link href=/css/atom-one-light.css?1623743079 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1623743079 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1623743079></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/vql_reference/server/><nav id=sidebar><div id=header-wrapper><div id=header><script>function darkmode(){alert("Switch to dark mode")}</script><div class="btn btn-default ThemeSelector" onclick=darkmode()><i class="fas fa-moon"></i></div><a href=https://docs.velociraptor.app/><img src=https://docs.velociraptor.app//images/logo.svg></a></div></div><div class=highlightable><ul class=topics><li data-nav-id=/overview/ title="Velociraptor Overview" class=dd-item><a href=/overview/>Velociraptor Overview</a><ul><li data-nav-id=/overview/history/ title=History class=dd-item><a href=/overview/history/>History</a></li><li data-nav-id=/overview/deployment/ title="Deployment Overview" class=dd-item><a href=/overview/deployment/>Deployment Overview</a><ul><li data-nav-id=/overview/deployment/self-signed/ title="Self Signed SSL" class=dd-item><a href=/overview/deployment/self-signed/>Self Signed SSL</a></li><li data-nav-id=/overview/deployment/cloud/ title="Cloud Deployment" class=dd-item><a href=/overview/deployment/cloud/>Cloud Deployment</a></li><li data-nav-id=/overview/deployment/clients/ title="Deploying Clients" class=dd-item><a href=/overview/deployment/clients/>Deploying Clients</a></li><li data-nav-id=/overview/deployment/rbac/ title="Users and Roles" class=dd-item><a href=/overview/deployment/rbac/>Users and Roles</a></li><li data-nav-id=/overview/deployment/resources/ title=Performance class=dd-item><a href=/overview/deployment/resources/>Performance</a></li></ul></li></ul></li><li data-nav-id=/gui/ title="The Admin GUI" class=dd-item><a href=/gui/>The Admin GUI</a><ul><li data-nav-id=/gui/clients/ title="Inspecting clients" class=dd-item><a href=/gui/clients/>Inspecting clients</a></li><li data-nav-id=/gui/vfs/ title="The VFS" class=dd-item><a href=/gui/vfs/>The VFS</a></li><li data-nav-id=/gui/artifacts/ title=Artifacts class=dd-item><a href=/gui/artifacts/>Artifacts</a></li><li data-nav-id=/gui/hunting/ title=Hunting class=dd-item><a href=/gui/hunting/>Hunting</a></li></ul></li><li data-nav-id=/vql/ title="VQL Fundamentals" class=dd-item><a href=/vql/>VQL Fundamentals</a><ul><li data-nav-id=/vql/notebooks/ title=Notebooks class=dd-item><a href=/vql/notebooks/>Notebooks</a></li><li data-nav-id=/vql/artifacts/ title=Artifacts class=dd-item><a href=/vql/artifacts/>Artifacts</a></li></ul></li><li data-nav-id=/vql_reference/ title="VQL Reference" class="dd-item
parent"><a href=/vql_reference/>VQL Reference</a><ul><li data-nav-id=/vql_reference/basic/ title="Basic VQL functions and plugins" class=dd-item><a href=/vql_reference/basic/>Basic VQL</a></li><li data-nav-id=/vql_reference/windows/ title="Windows Specific Functionality" class=dd-item><a href=/vql_reference/windows/>Windows</a></li><li data-nav-id=/vql_reference/parsers/ title="Parsers and data extractors" class=dd-item><a href=/vql_reference/parsers/>Parsers</a></li><li data-nav-id=/vql_reference/server/ title="Server Side Functionality" class="dd-item
parent
active"><a href=/vql_reference/server/>Server</a></li><li data-nav-id=/vql_reference/plugin/ title="Client Side Functionality" class=dd-item><a href=/vql_reference/plugin/>Client</a></li><li data-nav-id=/vql_reference/event/ title="Event Plugins" class=dd-item><a href=/vql_reference/event/>Event Plugins</a></li><li data-nav-id=/vql_reference/experimental/ title="Experimental Functionality" class=dd-item><a href=/vql_reference/experimental/>Experimental</a></li></ul></li><li data-nav-id=/training/ title="Velociraptor Training" class=dd-item><a href=/training/>Training</a></li><li data-nav-id=/blog/ title="Velociraptor Blog" class=dd-item><a href=/blog/>Blog</a><ul><li data-nav-id=/blog/2021/ title=2021 class=dd-item><a href=/blog/2021/>2021</a><ul><li data-nav-id=/blog/2021/2021-01-22-concurrent-vql-6d381fdb0b1f/ title="Concurrent VQL" class=dd-item><a href=/blog/2021/2021-01-22-concurrent-vql-6d381fdb0b1f/>Concurrent VQL</a></li><li data-nav-id=/blog/2021/2021-01-19-parsing-binary-files-d31114a41f14/ title="Parsing binary files" class=dd-item><a href=/blog/2021/2021-01-19-parsing-binary-files-d31114a41f14/>Parsing binary files</a></li></ul></li><li data-nav-id=/blog/2020/ title=2020 class=dd-item><a href=/blog/2020/>2020</a><ul><li data-nav-id=/blog/2020/2020-12-26-slack-and-velociraptor-b63803ba4b16/ title="Slack and Velociraptor" class=dd-item><a href=/blog/2020/2020-12-26-slack-and-velociraptor-b63803ba4b16/>Slack and Velociraptor</a></li><li data-nav-id=/blog/2020/2020-12-13-velociraptor-and-osquery-2a4306dd23c/ title="Velociraptor and OSQuery" class=dd-item><a href=/blog/2020/2020-12-13-velociraptor-and-osquery-2a4306dd23c/>Velociraptor and OSQuery</a></li><li data-nav-id=/blog/2020/2020-11-13-the-windows-usn-journal-f0c55c9010e/ title="The Windows USN Journal" class=dd-item><a href=/blog/2020/2020-11-13-the-windows-usn-journal-f0c55c9010e/>The Windows USN Journal</a></li><li data-nav-id=/blog/2020/2020-09-28-velociraptor-network-communications-30568624043a/ title="Velociraptor Communications" class=dd-item><a href=/blog/2020/2020-09-28-velociraptor-network-communications-30568624043a/>Velociraptor Communications</a></li><li data-nav-id=/blog/2020/2020-08-17-velociraptor-sso-authentication-6dd68d46dccf/ title="Velociraptor SSO Authentication" class=dd-item><a href=/blog/2020/2020-08-17-velociraptor-sso-authentication-6dd68d46dccf/>Velociraptor SSO Authentication</a></li><li data-nav-id=/blog/2020/2020-08-16-profiling-the-beast-58913437fd16/ title="Profiling the beast" class=dd-item><a href=/blog/2020/2020-08-16-profiling-the-beast-58913437fd16/>Profiling the beast</a></li><li data-nav-id=/blog/2020/2020-07-14-triage-with-velociraptor-pt-4-cf0e60810d1e/ title="Triage with Velociraptor — Pt 4" class=dd-item><a href=/blog/2020/2020-07-14-triage-with-velociraptor-pt-4-cf0e60810d1e/>Triage with Velociraptor — Pt 4</a></li><li data-nav-id=/blog/2020/2020-07-13-velociraptor-in-the-tool-age-d896dfe71b9/ title="Velociraptor in the tool age" class=dd-item><a href=/blog/2020/2020-07-13-velociraptor-in-the-tool-age-d896dfe71b9/>Velociraptor in the tool age</a></li><li data-nav-id=/blog/2020/2020-06-19-the-velociraptor-query-language-pt-2-fe92bb7aa150/ title="The Velociraptor Query Language Pt 2" class=dd-item><a href=/blog/2020/2020-06-19-the-velociraptor-query-language-pt-2-fe92bb7aa150/>The Velociraptor Query Language Pt 2</a></li><li data-nav-id=/blog/2020/2020-06-14-the-velociraptor-query-language-pt-1-d721bff100bf/ title="The Velociraptor Query Language Pt 1" class=dd-item><a href=/blog/2020/2020-06-14-the-velociraptor-query-language-pt-1-d721bff100bf/>The Velociraptor Query Language Pt 1</a></li><li data-nav-id=/blog/2020/2020-04-16-velociraptor-e48a47e0317d/ title=Velociraptor class=dd-item><a href=/blog/2020/2020-04-16-velociraptor-e48a47e0317d/>Velociraptor</a></li><li data-nav-id=/blog/2020/2020-03-29-velociraptors-acl-model-7f497575daee/ title="Velociraptor’s ACL model" class=dd-item><a href=/blog/2020/2020-03-29-velociraptors-acl-model-7f497575daee/>Velociraptor’s ACL model</a></li><li data-nav-id=/blog/2020/2020-03-28-velociraptor-notebooks-d02e0bd11230/ title="Velociraptor notebooks" class=dd-item><a href=/blog/2020/2020-03-28-velociraptor-notebooks-d02e0bd11230/>Velociraptor notebooks</a></li><li data-nav-id=/blog/2020/2020-03-07-extending-vql-plugins-7fb004cb6ec4/ title="Extending VQL plugins" class=dd-item><a href=/blog/2020/2020-03-07-extending-vql-plugins-7fb004cb6ec4/>Extending VQL plugins</a></li><li data-nav-id=/blog/2020/2020-03-06-velociraptor-post-processing-with-jupyter-notebook-and-pandas-8a344d05ee8c/ title="Velociraptor Post-processing with Jupyter Notebook and Pandas" class=dd-item><a href=/blog/2020/2020-03-06-velociraptor-post-processing-with-jupyter-notebook-and-pandas-8a344d05ee8c/>Velociraptor Post-processing with Jupyter Notebook and Pandas</a></li><li data-nav-id=/blog/2020/2020-01-12_hunting-malware-using-mutants-ea08e86dfc19/ title="Hunting Malware using Mutants" class=dd-item><a href=/blog/2020/2020-01-12_hunting-malware-using-mutants-ea08e86dfc19/>Hunting Malware using Mutants</a></li></ul></li><li data-nav-id=/blog/2019/ title=2019 class=dd-item><a href=/blog/2019/>2019</a><ul><li data-nav-id=/blog/2019/2019-12-31_digging-into-the-system-resource-usage-monitor-srum-afbadb1a375/ title="Digging into the System Resource Usage Monitor (SRUM)" class=dd-item><a href=/blog/2019/2019-12-31_digging-into-the-system-resource-usage-monitor-srum-afbadb1a375/>Digging into the System Resource Usage Monitor (SRUM)</a></li><li data-nav-id=/blog/2019/2019-12-08-velociraptor-to-elasticsearch-3a9fc02c6568/ title="Velociraptor to Elasticsearch" class=dd-item><a href=/blog/2019/2019-12-08-velociraptor-to-elasticsearch-3a9fc02c6568/>Velociraptor to Elasticsearch</a></li><li data-nav-id=/blog/2019/2019-11-15_recovering-deleted-ntfs-files-with-velociraptor-1fcf09855311/ title="Recovering deleted NTFS Files with Velociraptor" class=dd-item><a href=/blog/2019/2019-11-15_recovering-deleted-ntfs-files-with-velociraptor-1fcf09855311/>Recovering deleted NTFS Files with Velociraptor</a></li><li data-nav-id=/blog/2019/2019-11-12_windows-event-logs-d8d8e615c9ca/ title="Windows Event Logs" class=dd-item><a href=/blog/2019/2019-11-12_windows-event-logs-d8d8e615c9ca/>Windows Event Logs</a></li><li data-nav-id=/blog/2019/2019-10-08_triage-with-velociraptor-pt-3-d6f63215f579/ title="Triage with Velociraptor — Pt 3" class=dd-item><a href=/blog/2019/2019-10-08_triage-with-velociraptor-pt-3-d6f63215f579/>Triage with Velociraptor — Pt 3</a></li><li data-nav-id=/blog/2019/2019-10-04_triage-with-velociraptor-pt-2-d0f79066ca0e/ title="Triage with Velociraptor — Pt 2" class=dd-item><a href=/blog/2019/2019-10-04_triage-with-velociraptor-pt-2-d0f79066ca0e/>Triage with Velociraptor — Pt 2</a></li><li data-nav-id=/blog/2019/2019-10-02_triage-with-velociraptor-pt-1-253f57ce96c0/ title="Triage with Velociraptor — Pt 1" class=dd-item><a href=/blog/2019/2019-10-02_triage-with-velociraptor-pt-1-253f57ce96c0/>Triage with Velociraptor — Pt 1</a></li><li data-nav-id=/blog/2019/2019-09-11_velociraptor-s-client-side-buffer-3ce03697a4e6/ title="Velociraptor’s client side buffer" class=dd-item><a href=/blog/2019/2019-09-11_velociraptor-s-client-side-buffer-3ce03697a4e6/>Velociraptor’s client side buffer</a></li><li data-nav-id=/blog/2019/2019-03-02/ title="Agentless hunting with Velociraptor" class=dd-item><a href=/blog/2019/2019-03-02/>Agentless hunting with Velociraptor</a></li></ul></li></ul></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://docs.velociraptor.app/search><i class="fas fa-search"></i> Search</a></li><li><a class=padding href=https://github.com/Velocidex/velociraptor><i class="fab fa-github"></i> Github repo</a></li></ul></section><section id=footer><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a> from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>Server Side Functionality</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#artifact_definitions>artifact_definitions</a></li><li><a href=#artifact_delete>artifact_delete</a></li><li><a href=#artifact_set>artifact_set</a></li><li><a href=#cancel_flow>cancel_flow</a></li><li><a href=#client_delete>client_delete</a></li><li><a href=#client_info>client_info</a></li><li><a href=#client_metadata>client_metadata</a></li><li><a href=#client_set_metadata>client_set_metadata</a></li><li><a href=#clients>clients</a></li><li><a href=#collect_client>collect_client</a></li><li><a href=#compress>compress</a></li><li><a href=#create_flow_download>create_flow_download</a></li><li><a href=#create_hunt_download>create_hunt_download</a></li><li><a href=#elastic_upload>elastic_upload</a></li><li><a href=#enumerate_flow>enumerate_flow</a></li><li><a href=#file_store>file_store</a></li><li><a href=#file_store_delete>file_store_delete</a></li><li><a href=#flow_results>flow_results</a></li><li><a href=#flows>flows</a></li><li><a href=#get_client_monitoring>get_client_monitoring</a></li><li><a href=#get_server_monitoring>get_server_monitoring</a></li><li><a href=#gui_users>gui_users</a></li><li><a href=#hunt>hunt</a></li><li><a href=#hunt_add>hunt_add</a></li><li><a href=#hunt_flows>hunt_flows</a></li><li><a href=#hunt_results>hunt_results</a></li><li><a href=#hunts>hunts</a></li><li><a href=#inventory>inventory</a></li><li><a href=#inventory_add>inventory_add</a></li><li><a href=#inventory_get>inventory_get</a></li><li><a href=#label>label</a></li><li><a href=#mail>mail</a></li><li><a href=#monitoring>monitoring</a></li><li><a href=#notebook_delete>notebook_delete</a></li><li><a href=#parallelize>parallelize</a></li><li><a href=#patch>patch</a></li><li><a href=#rate>rate</a></li><li><a href=#sample>sample</a></li><li><a href=#search>search</a></li><li><a href=#server_metadata>server_metadata</a></li><li><a href=#server_set_metadata>server_set_metadata</a></li><li><a href=#set_client_monitoring>set_client_monitoring</a></li><li><a href=#set_server_monitoring>set_server_monitoring</a></li><li><a href=#source>source</a></li><li><a href=#splunk_upload>splunk_upload</a></li><li><a href=#uploads>uploads</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Server Side Functionality</h1><p>Velociraptor provides complete control of the server within VQL
queries. On the server, the VQL engine contains the following
plugins and functions. You can use this functionality to manage
and automate the server by writing VQL queries.</p><p>To reuse server side artifacts, simply create an artifact with
<code>type: SERVER</code> and launch it from the &ldquo;Server Artifacts&rdquo; screen in
the GUI.</p><h2 id=artifact_definitions>artifact_definitions</h2><p><span class="vql_type pull-right">Plugin</span></p><p>Dump artifact definitions.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>names</td><td>Artifact definitions to dump</td><td>list of string</td></tr><tr><td>deps</td><td>If true includes all dependencies as well.</td><td>bool</td></tr><tr><td>sanitize</td><td>If true we remove extra metadata.</td><td>bool</td></tr></tbody></table><h2 id=artifact_delete>artifact_delete</h2><p><span class="vql_type pull-right">Function</span></p><p>Deletes an artifact from the global repository.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>name</td><td>The Artifact to delete</td><td>string</td></tr></tbody></table><h2 id=artifact_set>artifact_set</h2><p><span class="vql_type pull-right">Function</span></p><p>Sets an artifact into the global repository.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>definition</td><td>Artifact definition in YAML</td><td>string</td></tr><tr><td>prefix</td><td>Required name prefix</td><td>string</td></tr></tbody></table><h2 id=cancel_flow>cancel_flow</h2><p><span class="vql_type pull-right">Function</span></p><p>Cancels the flow.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>client_id</td><td></td><td>string (required)</td></tr><tr><td>flow_id</td><td></td><td>string</td></tr></tbody></table><h2 id=client_delete>client_delete</h2><p><span class="vql_type pull-right">Plugin</span></p><p>Delete all information related to a client.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>client_id</td><td></td><td>string (required)</td></tr><tr><td>really_do_it</td><td></td><td>bool</td></tr></tbody></table><h2 id=client_info>client_info</h2><p><span class="vql_type pull-right">Function</span></p><p>Returns client info (like the fqdn) from the datastore.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>client_id</td><td></td><td>string (required)</td></tr></tbody></table><h2 id=client_metadata>client_metadata</h2><p><span class="vql_type pull-right">Function</span></p><p>Returns client metadata from the datastore. Client metadata is a set of free form key/value data</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>client_id</td><td></td><td>string (required)</td></tr></tbody></table><h2 id=client_set_metadata>client_set_metadata</h2><p><span class="vql_type pull-right">Function</span></p><p>Sets client metadata. Client metadata is a set of free form key/value data</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>client_id</td><td></td><td>string (required)</td></tr></tbody></table><h2 id=clients>clients</h2><p><span class="vql_type pull-right">Plugin</span></p><p>Retrieve the list of clients.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>search</td><td>Client search string. Can have the following prefixes: &lsquo;lable:&rsquo;, &lsquo;host:&rsquo;</td><td>string</td></tr><tr><td>start</td><td>First client to fetch (0)'</td><td>uint64</td></tr><tr><td>count</td><td>Maximum number of clients to fetch (1000)'</td><td>uint64</td></tr><tr><td>client_id</td><td></td><td>string</td></tr></tbody></table><h2 id=collect_client>collect_client</h2><p><span class="vql_type pull-right">Function</span></p><p>Launch an artifact collection against a client. If the client_id
is &ldquo;server&rdquo; then the collection occurs on the server itself. In
that case the caller needs the SERVER_ADMIN permission.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>client_id</td><td>The client id to schedule a collection on</td><td>string (required)</td></tr><tr><td>artifacts</td><td>A list of artifacts to collect</td><td>list of string (required)</td></tr><tr><td>env</td><td>Parameters to apply to the artifact (an alternative to a full spec)</td><td>Any</td></tr><tr><td>spec</td><td>Parameters to apply to the artifacts</td><td>Any</td></tr><tr><td>timeout</td><td>Set query timeout (default 10 min)</td><td>uint64</td></tr><tr><td>ops_per_sec</td><td>Set query ops_per_sec value</td><td>float64</td></tr><tr><td>max_rows</td><td>Max number of rows to fetch</td><td>uint64</td></tr><tr><td>max_bytes</td><td>Max number of bytes to upload</td><td>uint64</td></tr></tbody></table><h2 id=compress>compress</h2><p><span class="vql_type pull-right">Function</span></p><p>Compress a file in the server&rsquo;s FileStore. A compressed
file is archived so it takes less space. It is still possible to see
the file and read it but not to seek within it.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>path</td><td>A VFS path to compress</td><td>list of string (required)</td></tr></tbody></table><h2 id=create_flow_download>create_flow_download</h2><p><span class="vql_type pull-right">Function</span></p><p>Creates a download pack for the flow.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>client_id</td><td>Client ID to export.</td><td>string (required)</td></tr><tr><td>flow_id</td><td>The flow id to export.</td><td>string (required)</td></tr><tr><td>wait</td><td>If set we wait for the download to complete before returning.</td><td>bool</td></tr><tr><td>type</td><td>Type of download to create (e.g. &lsquo;report&rsquo;) default a full zip file.</td><td>string</td></tr><tr><td>template</td><td>Report template to use (defaults to Reporting.Default).</td><td>string</td></tr></tbody></table><h2 id=create_hunt_download>create_hunt_download</h2><p><span class="vql_type pull-right">Function</span></p><p>Creates a download pack for a hunt.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>hunt_id</td><td>Hunt ID to export.</td><td>string (required)</td></tr><tr><td>only_combined</td><td>If set we only export combined results.</td><td>bool</td></tr><tr><td>wait</td><td>If set we wait for the download to complete before returning.</td><td>bool</td></tr><tr><td>format</td><td>Format to export (csv,json) defaults to both.</td><td>string</td></tr><tr><td>base</td><td>Base filename to write to.</td><td>string</td></tr></tbody></table><h2 id=elastic_upload>elastic_upload</h2><p><span class="vql_type pull-right">Plugin</span></p><p>Upload rows to elastic.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>query</td><td>Source for rows to upload.</td><td>StoredQuery (required)</td></tr><tr><td>threads</td><td>How many threads to use.</td><td>int64</td></tr><tr><td>index</td><td>The name of the index to upload to. If not specified ensure a column is named &lsquo;_index&rsquo;.</td><td>string</td></tr><tr><td>type</td><td>The type of the index to upload to.</td><td>string (required)</td></tr><tr><td>chunk_size</td><td>The number of rows to send at the time.</td><td>int64</td></tr><tr><td>addresses</td><td>A list of Elasticsearch nodes to use.</td><td>list of string</td></tr><tr><td>username</td><td>Username for HTTP Basic Authentication.</td><td>string</td></tr><tr><td>password</td><td>Password for HTTP Basic Authentication.</td><td>string</td></tr><tr><td>cloud_id</td><td>Endpoint for the Elastic Service (<a href=https://elastic.co/cloud)>https://elastic.co/cloud)</a>.</td><td>string</td></tr><tr><td>api_key</td><td>Base64-encoded token for authorization; if set, overrides username and password.</td><td>string</td></tr><tr><td>wait_time</td><td>Batch elastic upload this long (2 sec).</td><td>int64</td></tr><tr><td>pipeline</td><td>Pipeline for uploads</td><td>string</td></tr></tbody></table><h2 id=enumerate_flow>enumerate_flow</h2><p><span class="vql_type pull-right">Plugin</span></p><p>Enumerate all the files that make up a flow.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>client_id</td><td></td><td>string (required)</td></tr><tr><td>flow_id</td><td></td><td>string</td></tr></tbody></table><h2 id=file_store>file_store</h2><p><span class="vql_type pull-right">Function</span></p><p>Resolves file store paths into full filesystem paths.</p><p>This function is only available on the server. It can be used to
find the backing file behind a filestore path so it can be passed
on to an external program.</p><p>Velociraptor uses the concept of a Virtual File System to manage the
information about clients etc. The VFS path is a path into the file
store. Of course ultimately (at least in the current implementation)
the file store is storing files on disk, but the disk filename is not
necessarily the same as the VFS path (for example non representable
characters are escaped).</p><p>You can use the <code>file_store()</code> function to return the real file path
on disk. This probably only makes sense for VQL queries running on the
server which can independently open the file.</p><p>In future the file store may be abstracted (e.g. files may not be
locally stored at all) and this function may stop working.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>path</td><td>A VFS path to convert</td><td>list of string (required)</td></tr></tbody></table><h2 id=file_store_delete>file_store_delete</h2><p><span class="vql_type pull-right">Function</span></p><p>Delete file store paths into full filesystem paths.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>path</td><td>A VFS path to remove</td><td>string (required)</td></tr></tbody></table><h2 id=flow_results>flow_results</h2><p><span class="vql_type pull-right">Plugin</span></p><p>Retrieve the results of a flow.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>artifact</td><td>The artifact to retrieve</td><td>string</td></tr><tr><td>source</td><td>An optional source within the artifact.</td><td>string</td></tr><tr><td>flow_id</td><td>The hunt id to read.</td><td>string (required)</td></tr><tr><td>client_id</td><td>The client id to extract</td><td>string (required)</td></tr></tbody></table><h2 id=flows>flows</h2><p><span class="vql_type pull-right">Plugin</span></p><p>Retrieve the flows launched on each client.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>client_id</td><td></td><td>string (required)</td></tr><tr><td>flow_id</td><td></td><td>string</td></tr></tbody></table><h2 id=get_client_monitoring>get_client_monitoring</h2><p><span class="vql_type pull-right">Function</span></p><p>Retrieve the current client monitoring state.</p><h2 id=get_server_monitoring>get_server_monitoring</h2><p><span class="vql_type pull-right">Function</span></p><p>Retrieve the current client monitoring state.</p><h2 id=gui_users>gui_users</h2><p><span class="vql_type pull-right">Plugin</span></p><p>Retrieve the list of users on the server.</p><h2 id=hunt>hunt</h2><p><span class="vql_type pull-right">Function</span></p><p>Launch an artifact collection against a client.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>description</td><td>Description of the hunt</td><td>string (required)</td></tr><tr><td>artifacts</td><td>A list of artifacts to collect</td><td>list of string (required)</td></tr><tr><td>expires</td><td>Number of milliseconds since epoch for expiry</td><td>uint64</td></tr><tr><td>spec</td><td>Parameters to apply to the artifacts</td><td>Any</td></tr><tr><td>timeout</td><td>Set query timeout (default 10 min)</td><td>uint64</td></tr><tr><td>ops_per_sec</td><td>Set query ops_per_sec value</td><td>float64</td></tr><tr><td>max_rows</td><td>Max number of rows to fetch</td><td>uint64</td></tr><tr><td>max_bytes</td><td>Max number of bytes to upload</td><td>uint64</td></tr><tr><td>pause</td><td>If specified the new hunt will be in the paused state</td><td>bool</td></tr></tbody></table><h2 id=hunt_add>hunt_add</h2><p><span class="vql_type pull-right">Function</span></p><p>Assign a client to a hunt.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>ClientId</td><td></td><td>string (required)</td></tr><tr><td>HuntId</td><td></td><td>string (required)</td></tr></tbody></table><h2 id=hunt_flows>hunt_flows</h2><p><span class="vql_type pull-right">Plugin</span></p><p>Retrieve the flows launched by a hunt.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>hunt_id</td><td>The hunt id to inspect.</td><td>string (required)</td></tr><tr><td>start_row</td><td>The first row to show (used for paging).</td><td>int64</td></tr><tr><td>limit</td><td>Number of rows to show (used for paging).</td><td>int64</td></tr></tbody></table><h2 id=hunt_results>hunt_results</h2><p><span class="vql_type pull-right">Plugin</span></p><p>Retrieve the results of a hunt.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>artifact</td><td>The artifact to retrieve</td><td>string</td></tr><tr><td>source</td><td>An optional source within the artifact.</td><td>string</td></tr><tr><td>hunt_id</td><td>The hunt id to read.</td><td>string (required)</td></tr><tr><td>brief</td><td>If set we return less columns.</td><td>bool</td></tr></tbody></table><h2 id=hunts>hunts</h2><p><span class="vql_type pull-right">Plugin</span></p><p>Retrieve the list of hunts.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>hunt_id</td><td>A hunt id to read, if not specified we list all of them.</td><td>string</td></tr></tbody></table><h2 id=inventory>inventory</h2><p><span class="vql_type pull-right">Plugin</span></p><p>Retrieve the tools inventory.</p><h2 id=inventory_add>inventory_add</h2><p><span class="vql_type pull-right">Function</span></p><p>Add tool to ThirdParty inventory.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>tool</td><td></td><td>string (required)</td></tr><tr><td>serve_locally</td><td></td><td>bool</td></tr><tr><td>url</td><td></td><td>string</td></tr><tr><td>hash</td><td></td><td>string</td></tr><tr><td>filename</td><td>The name of the file on the endpoint</td><td>string</td></tr><tr><td>file</td><td>An optional file to upload</td><td>string</td></tr><tr><td>accessor</td><td>The accessor to use to read the file.</td><td>string</td></tr></tbody></table><h2 id=inventory_get>inventory_get</h2><p><span class="vql_type pull-right">Function</span></p><p>Get tool info from inventory service.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>tool</td><td></td><td>string (required)</td></tr></tbody></table><h2 id=label>label</h2><p><span class="vql_type pull-right">Function</span></p><p>Add the labels to the client. If op is &lsquo;remove&rsquo; then remove these labels.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>client_id</td><td>Client ID to label.</td><td>string (required)</td></tr><tr><td>labels</td><td>A list of labels to apply</td><td>list of string (required)</td></tr><tr><td>op</td><td>An operation on the labels (set, check, remove)</td><td>string</td></tr></tbody></table><h2 id=mail>mail</h2><p><span class="vql_type pull-right">Plugin</span></p><p>Send Email to a remote server.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>to</td><td>Receipient of the mail</td><td>list of string (required)</td></tr><tr><td>cc</td><td>A cc for the mail</td><td>list of string</td></tr><tr><td>subject</td><td>The subject.</td><td>string</td></tr><tr><td>body</td><td>The body of the mail.</td><td>string (required)</td></tr><tr><td>period</td><td>How long to wait before sending the next mail - help to throttle mails.</td><td>int64 (required)</td></tr></tbody></table><h2 id=monitoring>monitoring</h2><p><span class="vql_type pull-right">Plugin</span></p><p>Extract monitoring log from a client. If client_id is not specified we watch the global journal which contains event logs from all clients.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>artifact</td><td>The event artifact name to watch</td><td>string (required)</td></tr></tbody></table><h2 id=notebook_delete>notebook_delete</h2><p><span class="vql_type pull-right">Plugin</span></p><p>Delete a notebook with all its cells.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>notebook_id</td><td></td><td>string (required)</td></tr><tr><td>really_do_it</td><td></td><td>bool</td></tr></tbody></table><h2 id=parallelize>parallelize</h2><p><span class="vql_type pull-right">Plugin</span></p><p>Runs query on result batches in parallel.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>query</td><td>The query will be run in parallel over batches.</td><td>StoredQuery (required)</td></tr><tr><td>client_id</td><td>The client id to extract</td><td>string</td></tr><tr><td>flow_id</td><td>A flow ID (client or server artifacts)</td><td>string</td></tr><tr><td>hunt_id</td><td>Retrieve sources from this hunt (combines all results from all clients)</td><td>string</td></tr><tr><td>artifact</td><td>The name of the artifact collection to fetch</td><td>string</td></tr><tr><td>source</td><td>An optional named source within the artifact</td><td>string</td></tr><tr><td>start_time</td><td>Start return events from this date (for event sources)</td><td>int64</td></tr><tr><td>end_time</td><td>Stop end events reach this time (event sources).</td><td>int64</td></tr><tr><td>notebook_id</td><td>The notebook to read from (shoud also include cell id)</td><td>string</td></tr><tr><td>notebook_cell_id</td><td>The notebook cell read from (shoud also include notebook id)</td><td>string</td></tr><tr><td>notebook_cell_table</td><td>A notebook cell can have multiple tables.)</td><td>int64</td></tr><tr><td>workers</td><td>Number of workers to spawn.)</td><td>int64</td></tr><tr><td>batch</td><td>Number of rows in each batch.)</td><td>int64</td></tr></tbody></table><h2 id=patch>patch</h2><p><span class="vql_type pull-right">Function</span></p><p>Patch a JSON object with a json patch or merge.</p><p>The function allows for modifications of objects by way of
applying a json patch. You can read more about JSON patching here
<a href=https://github.com/evanphx/json-patch>https://github.com/evanphx/json-patch</a>.</p><p>I practice you can use this to update server settings - for
example, consider the client event monitoring state.</p><div class=highlight><pre style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>SELECT get_client_monitoring() FROM scope()

 [
  {
   &#34;get_client_monitoring&#34;: {
    &#34;artifacts&#34;: [
     &#34;Generic.Client.Stats&#34;
    ]
   }
  }
 ]
</code></pre></div><p>Suppose we wish to add a new artifact, we can patch it with the json:</p><div class=highlight><pre style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>[{<span style=color:green;font-weight:700>&#34;op&#34;</span>: <span style=color:#ba2121>&#34;add&#34;</span>, <span style=color:green;font-weight:700>&#34;path&#34;</span>: <span style=color:#ba2121>&#34;/artifacts/0&#34;</span>, <span style=color:green;font-weight:700>&#34;value&#34;</span>: <span style=color:#ba2121>&#34;Windows.Events.DNSQueries&#34;</span>}]
</code></pre></div><p>This can then be immediately pushed to <code>set_client_monitoring()</code>
to update the monitoring state.</p><pre><code>SELECT set_client_monitoring(value=patch(
       item=get_client_monitoring(),
       patch=[dict(op=&quot;add&quot;, path=&quot;/artifacts/0&quot;, value=&quot;Windows.Events.DNSQueries&quot;)]))
FROM scope()
</code></pre><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>item</td><td>The item to path</td><td>Any (required)</td></tr><tr><td>patch</td><td>A JSON Patch to apply</td><td>Any</td></tr><tr><td>merge</td><td>A merge-patch to apply</td><td>Any</td></tr></tbody></table><h2 id=rate>rate</h2><p><span class="vql_type pull-right">Function</span></p><p>Calculates the rate (derivative) between two quantities.</p><p>For example if a monitoring plugin returns an absolute value
sampled in time (e.g. bytes transferred sampled every second) then
the rate() plugin can calculate the average bytes/sec.</p><p>This function works by remembering the values of x and y from the
previous row and applying the current rows values.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>x</td><td>The X float</td><td>float64 (required)</td></tr><tr><td>y</td><td>The Y float</td><td>float64 (required)</td></tr></tbody></table><h2 id=sample>sample</h2><p><span class="vql_type pull-right">Plugin</span></p><p>Executes &lsquo;query&rsquo; and samples every n&rsquo;th row.</p><p>This is most useful on the server in order to downsample event
artifact results.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>query</td><td>Source query.</td><td>StoredQuery (required)</td></tr><tr><td>n</td><td>Pick every n row from query.</td><td>int64 (required)</td></tr></tbody></table><h2 id=search>search</h2><p><span class="vql_type pull-right">Plugin</span></p><p>Search the server client&rsquo;s index.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>query</td><td>The query string.</td><td>string</td></tr><tr><td>offset</td><td>Skip this many results.</td><td>uint64</td></tr><tr><td>limit</td><td>Only return limited results</td><td>uint64</td></tr><tr><td>type</td><td>The type of search (e.g. &lsquo;key&rsquo;)</td><td>string</td></tr></tbody></table><h2 id=server_metadata>server_metadata</h2><p><span class="vql_type pull-right">Function</span></p><p>Returns client metadata from the datastore. Client metadata is a set of free form key/value data</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>client_id</td><td></td><td>string (required)</td></tr></tbody></table><h2 id=server_set_metadata>server_set_metadata</h2><p><span class="vql_type pull-right">Function</span></p><p>Sets client metadata. Client metadata is a set of free form key/value data</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>client_id</td><td></td><td>string (required)</td></tr></tbody></table><h2 id=set_client_monitoring>set_client_monitoring</h2><p><span class="vql_type pull-right">Function</span></p><p>Sets the current client monitoring state.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>value</td><td>The Value to set</td><td>Any (required)</td></tr></tbody></table><h2 id=set_server_monitoring>set_server_monitoring</h2><p><span class="vql_type pull-right">Function</span></p><p>Sets the current server monitoring state.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>value</td><td>The Value to set</td><td>Any (required)</td></tr></tbody></table><h2 id=source>source</h2><p><span class="vql_type pull-right">Plugin</span></p><p>Retrieve rows from an artifact&rsquo;s source.</p><p>This plugin is mostly useful in reports. It attempts to do the
right thing automatically by inferring most parameters from its
execution environment.</p><p>For example when called within a CLIENT report context, it will
automatically fill its flow id, client id etc. Typically this
means that you only need to specify the source name (for
multi-source artifacts).</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>client_id</td><td>The client id to extract</td><td>string</td></tr><tr><td>flow_id</td><td>A flow ID (client or server artifacts)</td><td>string</td></tr><tr><td>hunt_id</td><td>Retrieve sources from this hunt (combines all results from all clients)</td><td>string</td></tr><tr><td>artifact</td><td>The name of the artifact collection to fetch</td><td>string</td></tr><tr><td>source</td><td>An optional named source within the artifact</td><td>string</td></tr><tr><td>start_time</td><td>Start return events from this date (for event sources)</td><td>int64</td></tr><tr><td>end_time</td><td>Stop end events reach this time (event sources).</td><td>int64</td></tr><tr><td>notebook_id</td><td>The notebook to read from (shoud also include cell id)</td><td>string</td></tr><tr><td>notebook_cell_id</td><td>The notebook cell read from (shoud also include notebook id)</td><td>string</td></tr><tr><td>notebook_cell_table</td><td>A notebook cell can have multiple tables.)</td><td>int64</td></tr><tr><td>start_row</td><td>Start reading the result set from this row</td><td>int64</td></tr><tr><td>count</td><td>Maximum number of clients to fetch (default unlimited)'</td><td>int64</td></tr></tbody></table><h2 id=splunk_upload>splunk_upload</h2><p><span class="vql_type pull-right">Plugin</span></p><p>Upload rows to splunk.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>query</td><td>Source for rows to upload.</td><td>StoredQuery (required)</td></tr><tr><td>threads</td><td>How many threads to use.</td><td>int64</td></tr><tr><td>url</td><td>The Splunk Event Collector URL.</td><td>string</td></tr><tr><td>token</td><td>Splunk HEC Token.</td><td>string</td></tr><tr><td>index</td><td>The name of the index to upload to.</td><td>string (required)</td></tr><tr><td>source</td><td>The source field for splunk. If not specified this will be &lsquo;velociraptor&rsquo;.</td><td>string</td></tr><tr><td>sourcetype</td><td>The sourcetype field for splunk. If not specified this will &lsquo;vql&rsquo;</td><td>string</td></tr><tr><td>chunk_size</td><td>The number of rows to send at the time.</td><td>int64</td></tr><tr><td>skip_verify</td><td>Skip SSL verification(default: False).</td><td>bool</td></tr><tr><td>wait_time</td><td>Batch splunk upload this long (2 sec).</td><td>int64</td></tr></tbody></table><h2 id=uploads>uploads</h2><p><span class="vql_type pull-right">Plugin</span></p><p>Retrieve information about a flow&rsquo;s uploads.</p><table><thead><tr><th>Arg</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>client_id</td><td>The client id to extract</td><td>string</td></tr><tr><td>flow_id</td><td>A flow ID (client or server artifacts)</td><td>string</td></tr></tbody></table><footer class=footline></footer></div></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1623743079></script><script src=/js/perfect-scrollbar.min.js?1623743079></script><script src=/js/perfect-scrollbar.jquery.min.js?1623743079></script><script src=/js/jquery.sticky.js?1623743079></script><script src=/js/featherlight.min.js?1623743079></script><script src=/js/highlight.pack.js?1623743079></script><script>hljs.initHighlightingOnLoad()</script><script src=/js/modernizr.custom-3.6.0.js?1623743079></script><script src=/js/learn.js?1623743079></script><script src=/js/hugo-learn.js?1623743079></script></body></html>