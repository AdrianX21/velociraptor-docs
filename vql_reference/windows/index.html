<!doctype html><html lang=en class="js csstransforms3d">
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=generator content="Hugo 0.92.0">
<meta name=description content>
<link rel=icon href=/images/favicon.png type=image/png>
<title>Windows Specific :: Velociraptor - Digging deeper!</title>
<link href=/css/nucleus.css?1643161556 rel=stylesheet>
<link href=/css/fontawesome-all.min.css?1643161556 rel=stylesheet>
<link href=/css/featherlight.min.css?1643161556 rel=stylesheet>
<link href=/css/perfect-scrollbar.min.css?1643161556 rel=stylesheet>
<link href=/css/auto-complete.css?1643161556 rel=stylesheet>
<link href=/css/theme.css?1643161556 rel=stylesheet>
<link href=/css/tabs.css?1643161556 rel=stylesheet>
<link href=/css/hugo-theme.css?1643161556 rel=stylesheet>
<link href=/css/theme-mine.css?1643161556 rel=stylesheet>
<link href=/css/dark.css?1643161556 rel=stylesheet><link href=/css/syntax.css?1643161556 rel=stylesheet><link href=/css/light.css?1643161556 rel=stylesheet><link href=/css/hljs.css?1643161556 rel=stylesheet><link href=https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css?1643161556 rel=stylesheet>
<script src=/js/jquery-3.3.1.min.js?1643161556></script>
<style>:root #header+#content>#left>#rlblock_left{display:none!important}</style>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QYH72LMYCS"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-QYH72LMYCS',{anonymize_ip:!1})}</script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','G-QYH72LMYCS','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
<script></script>
</head>
<body data-url=/vql_reference/windows/>
<nav id=sidebar><div id=header-wrapper>
<div id=header>
<script>function darkmode(){$("body").addClass("dark").removeClass("light"),document.cookie="theme=darkmode;path=/"}function lightmode(){$("body").removeClass("dark").addClass("light"),document.cookie="theme=lightmode;path=/"}const regex=new RegExp('theme=darkmode');regex.test(document.cookie)?darkmode():lightmode()</script>
<div class="btn btn-default ThemeSelector darkmode" onclick=darkmode()>
<i class="fas fa-moon"></i>
</div>
<div class="btn btn-default ThemeSelector lightmode" onclick=lightmode()>
<i class="fas fa-sun"></i>
</div>
<a href=https://docs.velociraptor.app/>
<img src=https://docs.velociraptor.app//images/logo.svg>
</a>
</div>
</div>
<div class=highlightable>
<ul class=topics>
<li data-nav-id=https://docs.velociraptor.app/announcements/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/announcements/><i class="fas fa-bullhorn"></i>Announcements</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/announcements/2021-artifact-contest/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/announcements/2021-artifact-contest/>2021 Contest</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/><i class="fas fa-book-reader"></i>Documentation</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/overview/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/overview/>Velociraptor Overview</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/overview/history/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/history/>History</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/overview/support/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/overview/support/>Support Policy</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/>Deployment</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/self-signed/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/self-signed/>Self-Signed SSL</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/>Cloud Deployment</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/cloud/multifrontend/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/cloud/multifrontend/>Multi-Frontend</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/clients/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/clients/>Deploying Clients</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/rbac/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/rbac/>Users and Roles</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/resources/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/resources/>Performance</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/deployment/troubleshooting/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/deployment/troubleshooting/>Troubleshooting</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/gui/>The Admin GUI</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/clients/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/clients/>Inspecting clients</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/vfs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/vfs/>The VFS</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/artifacts/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/artifacts/>Artifacts</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/gui/hunting/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/gui/hunting/>Hunting</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/vql/>VQL Fundamentals</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/notebooks/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/notebooks/>Notebooks</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/artifacts/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/artifacts/>Artifacts</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/vql/events/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/vql/events/>Event Queries</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/forensic/>Forensic Analysis</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/filesystem/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/filesystem/>Searching Filenames</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/searching/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/searching/>Searching Content</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/ntfs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/ntfs/>NTFS Analysis</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/binary/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/binary/>Binary parsing</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/evidence_of_execution/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/evidence_of_execution/>Evidence Of Execution</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/event_logs/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/event_logs/>Event Logs</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/forensic/volatile/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/forensic/volatile/>Volatile State</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/offline_triage/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/offline_triage/>Triage and acquisition</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/client_monitoring/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/client_monitoring/>Client Monitoring</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/extending_vql/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/extending_vql/>Extending VQL</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/server_automation/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/docs/server_automation/>Server Automation</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_api/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_api/>Server API</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/docs/server_automation/server_monitoring/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/docs/server_automation/server_monitoring/>Server Monitoring</a>
</div>
</li>
</ul>
</li>
</ul>
</li><hr>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/ class="dd-item parent haschildren">
<div>
<i class="fa fa-angle-down fa-sm category-icon"></i>
<a href=/vql_reference/><i class="fas fa-book"></i>VQL Reference</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/basic/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/basic/>Basic VQL</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/linux/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/linux/>Linux Specific</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/windows/ class="dd-item parent active">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/windows/>Windows Specific</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/parsers/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/parsers/>Parsers</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/server/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/server/>Server Side</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/plugin/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/plugin/>Client Side</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/event/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/event/>Event Plugins</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/experimental/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/experimental/>Experimental</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/vql_reference/misc/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/vql_reference/misc/>Misc</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/training/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/training/><i class="fas fa-graduation-cap"></i>Training</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/blog/ class="dd-item haschildren">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/blog/><i class="fas fa-newspaper"></i>Blog</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/presentations/ class="dd-item haschildren">
<div><i class="fa fa-angle-right fa-sm category-icon"></i>
<a href=/presentations/><i class="fas fa-chalkboard-teacher"></i>Presentations</a>
</div>
<ul>
<li data-nav-id=https://docs.velociraptor.app/presentations/2021_auscert/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2021_auscert/>Auscert 2021</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/presentations/2021_dfrws_us/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2021_dfrws_us/>DFRWS US 2021 Workshop</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/presentations/2021_osdfc/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2021_osdfc/>OSDFC 2021</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/presentations/2021_blueteam_village/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2021_blueteam_village/>BTV 2021</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/presentations/2022_linuxconf_au/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/presentations/2022_linuxconf_au/>Linux Conf Au 2022</a>
</div>
</li>
</ul>
</li>
<li data-nav-id=https://docs.velociraptor.app/exchange/ class="dd-item haschildren">
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/exchange/><i class="fas fa-code"></i>Artifact Exchange</a>
</div>
</li>
<li data-nav-id=https://docs.velociraptor.app/search/ class=dd-item>
<div>
<i class="fa fa-circleXX fa-sm category-icon"></i>
<a href=/search/><i class="fas fa-search"></i>Search</a>
</div>
</li>
</ul>
<hr>
<section id=shortcuts>
<h3></h3>
<ul>
<li>
<a class=padding href=https://github.com/Velocidex/velociraptor><i class="fab fa-github"></i>Github</a>
</li>
<li>
<a class=padding href=https://docs.velociraptor.app/discord/><i class="fab fa-discord"></i>Discord</a>
</li>
<li>
<a class=padding href=mailto:velociraptor-discuss@googlegroups.com><i class="fas fa-envelope"></i>Mailing List</a>
</li>
</ul>
</section>
<section id=footer>
<div class=footer-copyright>Brought to you by
<img src=/images/Rapid7_logo.svg class=rapid7>
<br> <i class="fas fa-copyright"></i> 2021
</div>
</section>
</div>
</nav>
<script>$("#sidebar i.fa-angle-right").each(function(){$(this).parent().parent().find("ul").hide()})</script>
<section id=body>
<div id=overlay></div>
<div class="padding highlightable">
<div>
<div id=top-bar>
<div id=top-github-link>
<a class=github-link title="Edit this page" href=https://github.com/scudette/velociraptor-docs/edit/master/content/vql_reference/windows/_index.md target=blank>
<i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span>
</a>
</div>
<div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb>
<span id=sidebar-toggle-span>
<a href=# id=sidebar-toggle data-sidebar-toggle>
<i class="fas fa-bars"></i>
</a>
</span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>
Windows Specific
</span>
</div>
<div class=progress>
<div class=wrapper>
<nav id=TableOfContents>
<ul>
<li><a href=#amsi>amsi</a></li>
<li><a href=#appcompatcache>appcompatcache</a></li>
<li><a href=#authenticode>authenticode</a></li>
<li><a href=#certificates>certificates</a></li>
<li><a href=#dns>dns</a></li>
<li><a href=#handles>handles</a></li>
<li><a href=#interfaces>interfaces</a></li>
<li><a href=#lookupsid>lookupSID</a></li>
<li><a href=#modules>modules</a></li>
<li><a href=#netstat>netstat</a></li>
<li><a href=#partitions>partitions</a></li>
<li><a href=#proc_dump>proc_dump</a></li>
<li><a href=#proc_yara>proc_yara</a></li>
<li><a href=#read_reg_key>read_reg_key</a></li>
<li><a href=#srum_lookup_id>srum_lookup_id</a></li>
<li><a href=#token>token</a></li>
<li><a href=#users>users</a></li>
<li><a href=#vad>vad</a></li>
<li><a href=#winobj>winobj</a></li>
<li><a href=#wmi>wmi</a></li>
</ul>
</nav>
</div>
</div>
</div>
</div>
<div id=head-tags>
</div>
<div id=body-inner>
<h1>
Windows Specific
</h1>
<p>Many VQL plugins and functions provide access to the Windows
APIs. The following are only available when running on Windows.</p>
<div class=vql_item></div>
<h2 id=amsi>amsi</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>AMSI is an interface on windows to scan a string for malware. This
function submits the string to the AMSI system and receives a
determination if it is malware.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>string</td>
<td>A string to scan</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=appcompatcache>appcompatcache</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Parses the appcompatcache.</p>
<div class=vql_item></div>
<h2 id=authenticode>authenticode</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>This plugin parses authenticode information from PE files.</p>
<p>On windows, the plugin will also use the windows API to determine
if the binary is trusted by the system.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>accessor</td>
<td>The accessor to use.</td>
<td>string</td>
</tr>
<tr>
<td>filename</td>
<td>The filename to parse.</td>
<td>string (required)</td>
</tr>
<tr>
<td>verbose</td>
<td>Set to receive verbose information about all the certs.</td>
<td>bool</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=certificates>certificates</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Collect certificate from the system trust store.</p>
<p>This plugin uses the Windows APIs to fetch the certificates. You
might also want to look at the <code>Windows.System.RootCAStore</code>
artifact.</p>
<div class=vql_item></div>
<h2 id=dns>dns</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Monitor dns queries.</p>
<p>This plugin opens a raw socket and monitors network traffic for
DNS questions and answers.</p>
<div class="mynotices note">
<div heading=note><p>When Velociraptor attempts to open a raw socket, sometimes Windows
Defender treats that as suspicious behavior and quarantines the
Velociraptor binary. This can be avoided by signing the binary which
signals to Windows Defender that the binary is legitimate.</p>
<p>If you do not intend to build Velociraptor from source, use the
official signed Velociraptor binaries which should not trigger alerts
from Windows Defender.</p>
</div>
</div>
<p>It is generally better to use ETW for DNS monitoring than this
plugin (see Windows.Events.DNSQueries)</p>
<div class=vql_item></div>
<h2 id=handles>handles</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Enumerate process handles.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>pid</td>
<td>The PID to dump out.</td>
<td>int64 (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=interfaces>interfaces</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>List all active network interfaces using the API.</p>
<div class=vql_item></div>
<h2 id=lookupsid>lookupSID</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Get information about the SID.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>sid</td>
<td>A SID to lookup using LookupAccountSid</td>
<td>string (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=modules>modules</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Enumerate Loaded DLLs.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>pid</td>
<td>The PID to dump out.</td>
<td>int64 (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=netstat>netstat</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Collect network information.</p>
<div class=vql_item></div>
<h2 id=partitions>partitions</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>List all partitions</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>all</td>
<td>If specified list all Partitions</td>
<td>bool</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=proc_dump>proc_dump</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Dumps process memory.</p>
<p>Dumps a process into a crashdump. The crashdump file can be opened
with the windows debugger as normal. The plugin returns the filename
of the crash dump which is a temporary file - the file will be removed
when the query completes, so if you want to hold on to it, you should
use the upload() plugin to upload it to the server or otherwise copy
it.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>pid</td>
<td>The PID to dump out.</td>
<td>int64 (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=proc_yara>proc_yara</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Scan processes using yara rules.</p>
<p>This plugin uses yara&rsquo;s own engine to scan process memory for the signatures.</p>
<div class="mynotices note">
<div heading=note><p>Process memory access depends on having the <a href=https://support.microsoft.com/en-au/help/131065/how-to-obtain-a-handle-to-any-process-with-sedebugprivilege>SeDebugPrivilege</a> which depends on how Velociraptor was started. Even when running as System, some processes are not accessible.</p>
</div>
</div>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>rules</td>
<td>Yara rules</td>
<td>string (required)</td>
</tr>
<tr>
<td>pid</td>
<td>The pid to scan</td>
<td>int (required)</td>
</tr>
<tr>
<td>context</td>
<td>Return this many bytes either side of a hit</td>
<td>int</td>
</tr>
<tr>
<td>key</td>
<td>If set use this key to cache the yara rules.</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=read_reg_key>read_reg_key</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>This is a convenience plugin which applies the globs to the registry
accessor to find keys. For each key the plugin then lists all the
values within it, and returns a row which has the value names as
columns, while the cells contain the value&rsquo;s stat info (and data
content available in the <code>Data</code> field).</p>
<p>This makes it easier to access a bunch of related values at once.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>globs</td>
<td>Glob expressions to apply.</td>
<td>list of string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use.</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=srum_lookup_id>srum_lookup_id</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Lookup a SRUM id.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>file</td>
<td></td>
<td>string (required)</td>
</tr>
<tr>
<td>accessor</td>
<td>The accessor to use.</td>
<td>string</td>
</tr>
<tr>
<td>id</td>
<td></td>
<td>int64 (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=token>token</h2>
<p><span class="vql_type pull-right">Function</span></p>
<p>Extract process token.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>pid</td>
<td>The PID to get the token for.</td>
<td>int64 (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=users>users</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Display information about workstation local users. This is obtained through the NetUserEnum() API.</p>
<div class=vql_item></div>
<h2 id=vad>vad</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Enumerate process memory regions.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>pid</td>
<td>The PID to dump out.</td>
<td>int64 (required)</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=winobj>winobj</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Enumerate The Windows Object Manager namespace.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>path</td>
<td>Object namespace path.</td>
<td>string</td>
</tr>
</tbody>
</table>
<div class=vql_item></div>
<h2 id=wmi>wmi</h2>
<p><span class="vql_type pull-right">Plugin</span></p>
<p>Execute simple WMI queries synchronously.</p>
<p>This plugin issues a WMI query and returns its rows directly. The
exact format of the returned row depends on the WMI query issued.</p>
<p>This plugin creates a bridge between WMI and VQL and it is a very
commonly used plugin for inspecting the state of windows systems.</p>
<div class=vqlargs></div>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>The WMI query to issue.</td>
<td>string (required)</td>
</tr>
<tr>
<td>namespace</td>
<td>The WMI namespace to use (ROOT/CIMV2)</td>
<td>string</td>
</tr>
</tbody>
</table>
<footer class=footline>
</footer>
</div>
</div>
<div id=navigation>
</div>
</section>
<div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px>
<div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div>
</div>
<script src=/js/clipboard.min.js?1643161556></script>
<script src=/js/perfect-scrollbar.min.js?1643161556></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1643161556></script>
<script src=/js/jquery.sticky.js?1643161556></script>
<script src=/js/featherlight.min.js?1643161556></script>
<script src=/js/highlight.min.js?1643161556></script>
<script>hljs.highlightAll()</script>
<script src=/js/modernizr.custom-3.6.0.js?1643161556></script>
<script src=/js/learn.js?1643161556></script>
<script src=/js/hugo-learn.js?1643161556></script>
</body>
</html>